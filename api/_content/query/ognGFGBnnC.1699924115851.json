{"_path":"/posts/how-to-fix-php-error-in-wordpress-plugin","_dir":"posts","_draft":false,"_partial":false,"_locale":"","title":"How to fix \"syntax error, unexpected '|'\" error in Symfony Polyfill in Wordpress plugins","description":"I experienced a quite troublesome problem when trying to upload a plugin to the Wordpress repository with SVN. The issue was some files of the Symfony Polyfill libraries. They contain code that is only compatible with PHP 8. The code is not supposed to run on older versions of PHP, but the Wordpress SVN validator will check all uploaded files whether they run or not. Since the Wordpress server doesn't have PHP 8 yet, it will raise an error.","date":"2022-03-04 08:00:00 +0000","categories":["wordpress","development","php","svn"],"layout":"post","body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"I experienced a quite troublesome problem when trying to upload a plugin to the Wordpress repository with SVN. The issue was some files of the Symfony Polyfill libraries. They contain code that is only compatible with PHP 8. The code is not supposed to run on older versions of PHP, but the Wordpress SVN validator will check all uploaded files whether they run or not. Since the Wordpress server doesn't have PHP 8 yet, it will raise an error."}]},{"type":"element","tag":"pre","props":{"code":"Committing transaction...\nsvn: E165001: Commit blocked by pre-commit hook (exit code 1) with output:\n\n***********************************\nPHP error in: simple-social-media-preview/tags/1.0.0/vendor/psr/log/src/LoggerInterface.php:\n\nParse error: syntax error, unexpected '|', expecting variable (T_VARIABLE) in Standard input code on line 30\nErrors parsing Standard input code\n***********************************\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"Committing transaction...\nsvn: E165001: Commit blocked by pre-commit hook (exit code 1) with output:\n\n***********************************\nPHP error in: simple-social-media-preview/tags/1.0.0/vendor/psr/log/src/LoggerInterface.php:\n\nParse error: syntax error, unexpected '|', expecting variable (T_VARIABLE) in Standard input code on line 30\nErrors parsing Standard input code\n***********************************\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"I debugged alot and in the end I found no other solution than to delete the files that caused the problem, and prevent them from being loaded at all."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This can be done with a quite simple bash script."}]},{"type":"element","tag":"pre","props":{"code":"# remove_bootstrap80.sh\n# !/bin/bash\n\nfind ./vendor/symfony/polyfill -name \"*.php\" -type f | xargs sed -i -e \"/return require __DIR__\\.'\\/bootstrap80\\.php';/d\"\nfind ./vendor/symfony/polyfill -name \"bootstrap80.php\" -delete\n","language":"bash","meta":"","className":"language-bash shiki shiki-themes github-light github-dark","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A737D;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"# remove_bootstrap80.sh\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A737D;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"# !/bin/bash\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"find"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":" ./vendor/symfony/polyfill"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":" -name"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":" \"*.php\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":" -type"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":" f"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D73A49;--shiki-dark:#F97583"},"children":[{"type":"text","value":" |"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" xargs"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":" sed"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":" -i"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":" -e"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":" \"/return require __DIR__\\.'\\/bootstrap80\\.php';/d\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"find"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":" ./vendor/symfony/polyfill"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":" -name"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":" \"bootstrap80.php\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#005CC5;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":" -delete\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This will first remove the line that loads "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"bootstrap80.php"}]},{"type":"text","value":" in all files, then delete all the "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"bootstrap80.php"}]},{"type":"text","value":" files.\nDoing this before uploading your plugin to the Wordpress SVN repository will make the problem to go away."}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":"html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[]}},"_type":"markdown","_id":"content:posts:how-to-fix-php-error-in-wordpress-plugin:index.md","_source":"content","_file":"posts/how-to-fix-php-error-in-wordpress-plugin/index.md","_extension":"md","sitemap":{"loc":"/posts/how-to-fix-php-error-in-wordpress-plugin","images":[]}}