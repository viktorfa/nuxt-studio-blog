<!DOCTYPE html>
<html  lang="en">
<head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Serverless Strapi Tutorial</title>
<meta name="twitter:card" content="summary_large_image">
<meta name="description" content="Amazing insights">
<meta property="og:description" content="Amazing insights">
<meta property="og:image" content="/social-card-preview.png">
<meta property="og:image:width" content="400">
<meta property="og:image:height" content="300">
<meta property="og:image:alt" content="An image showcasing my project.">
<meta property="og:title" content="Serverless Strapi Tutorial">
<link rel="preload" as="fetch" crossorigin="anonymous" href="/posts/serverless-strapi-tutorial/_payload.json">
<link rel="stylesheet" href="/_nuxt/entry.97ab6348.css">
<link rel="stylesheet" href="/_nuxt/DocumentDrivenNotFound.17085fcb.css">
<link rel="stylesheet" href="/_nuxt/ProseH2.b565e694.css">
<link rel="stylesheet" href="/_nuxt/ProseP.2188f7db.css">
<link rel="stylesheet" href="/_nuxt/ProseA.f70b28a1.css">
<link rel="stylesheet" href="/_nuxt/ProseH3.9316dd33.css">
<link rel="stylesheet" href="/_nuxt/ProseEm.e73a4b12.css">
<link rel="stylesheet" href="/_nuxt/ProseUl.dbdeb511.css">
<link rel="stylesheet" href="/_nuxt/ProseLi.fd79bc46.css">
<link rel="stylesheet" href="/_nuxt/ProseStrong.a06f6381.css">
<link rel="stylesheet" href="/_nuxt/ProsePre.e63e49c6.css">
<link rel="stylesheet" href="/_nuxt/ProseCode.91016173.css">
<link rel="stylesheet" href="/_nuxt/ProseCodeInline.46b97b4c.css">
<link rel="stylesheet" href="/_nuxt/ProseImg.4753ea4a.css">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/entry.62dc2328.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/NuxtImg.6de55a98.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/document-driven.43fd56a5.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DocumentDrivenEmpty.5ecb93ab.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/ContentRenderer.0ca18651.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/ContentRendererMarkdown.vue.488f9c10.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DocumentDrivenNotFound.9dcee303.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/ssr.aa76f02f.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/page.10088194.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/ContentRendererMarkdown.c4163eaf.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseH2.203f4cc2.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseP.c9fbb7f1.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseA.b4523295.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseH3.0d9e0bac.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseEm.de9b7a1b.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseUl.04617425.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseLi.a4de4a86.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseStrong.ddad0b1c.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProsePre.149059c2.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseCode.b0afc5cd.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseCodeInline.86c62bbb.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseImg.c53b783c.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/GistIsland.5dc22129.js">
<link rel="prefetch" as="style" href="/_nuxt/article.f53cb360.css">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/article.6a7a7ba7.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/date.824a539b.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/default.4751ed77.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/client-db.17ef76c9.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/debug.25eda2a0.js">
<link rel="prefetch" as="style" href="/_nuxt/useStudio.54e83257.css">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/useStudio.8381510e.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/setup.75a1a77c.js">
<link rel="prefetch" as="style" href="/_nuxt/error-404.7910d5ca.css">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/error-404.e225b14d.js">
<link rel="prefetch" as="style" href="/_nuxt/error-500.1db01289.css">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/error-500.a10778fd.js">
<script type="module" src="/_nuxt/entry.62dc2328.js" crossorigin></script><style id="pinceau-runtime-hydratable">@media{.phy[--]{--puid:612Glt-v;}.pv-uygyEf{max-width:var(--elements-container-maxWidth);padding-left:var(--elements-container-padding-mobile);padding-right:var(--elements-container-padding-mobile);}@media (min-width: 475px){.pv-uygyEf{padding-left:var(--elements-container-padding-xs);padding-right:var(--elements-container-padding-xs);}}@media (min-width: 640px){.pv-uygyEf{padding-left:var(--elements-container-padding-sm);padding-right:var(--elements-container-padding-sm);}}@media (min-width: 768px){.pv-uygyEf{padding-left:var(--elements-container-padding-md);padding-right:var(--elements-container-padding-md);}}} </style><style id="pinceau-theme">@media { :root {--pinceau-mq: initial; --alpine-readableLine: 68ch;--alpine-backdrop-backgroundColor: #f4f4f5b3;--prose-code-inline-padding: 0.2rem 0.375rem 0.2rem 0.375rem;--prose-code-block-backdropFilter: contrast(1);--prose-code-block-border-style: solid;--prose-code-block-border-width: 1px;--prose-tbody-tr-borderBottom-style: dashed;--prose-tbody-tr-borderBottom-width: 1px;--prose-th-textAlign: inherit;--prose-thead-borderBottom-style: solid;--prose-thead-borderBottom-width: 1px;--prose-thead-border-style: solid;--prose-thead-border-width: 0px;--prose-table-textAlign: start;--prose-hr-width: 1px;--prose-hr-style: solid;--prose-li-listStylePosition: outside;--prose-ol-li-markerColor: currentColor;--prose-ol-paddingInlineStart: 21px;--prose-ol-listStyleType: decimal;--prose-ul-li-markerColor: currentColor;--prose-ul-paddingInlineStart: 21px;--prose-ul-listStyleType: disc;--prose-blockquote-border-style: solid;--prose-blockquote-border-width: 4px;--prose-blockquote-quotes: '201C' '201D' '2018' '2019';--prose-blockquote-paddingInlineStart: 24px;--prose-a-code-color-hover: currentColor;--prose-a-code-color-static: currentColor;--prose-a-hasCode-borderBottom: none;--prose-a-border-distance: 2px;--prose-a-border-color-hover: currentColor;--prose-a-border-color-static: currentColor;--prose-a-border-style-hover: solid;--prose-a-border-style-static: dashed;--prose-a-border-width: 1px;--prose-a-color-static: inherit;--prose-a-textDecoration: none;--prose-h6-margin: 3rem 0 2rem;--prose-h5-margin: 3rem 0 2rem;--prose-h4-margin: 3rem 0 2rem;--prose-h3-margin: 3rem 0 2rem;--prose-h2-margin: 3rem 0 2rem;--prose-h1-margin: 0 0 2rem;--prose-p-fontSize: 18px;--typography-lead-loose: 2;--typography-lead-relaxed: 1.625;--typography-lead-normal: 1.5;--typography-lead-snug: 1.375;--typography-lead-tight: 1.25;--typography-lead-none: 1;--typography-lead-10: 2.5rem;--typography-lead-9: 2.25rem;--typography-lead-8: 2rem;--typography-lead-7: 1.75rem;--typography-lead-6: 1.5rem;--typography-lead-5: 1.25rem;--typography-lead-4: 1rem;--typography-lead-3: .75rem;--typography-lead-2: .5rem;--typography-lead-1: .025rem;--typography-fontWeight-black: 900;--typography-fontWeight-extrabold: 800;--typography-fontWeight-bold: 700;--typography-fontWeight-semibold: 600;--typography-fontWeight-medium: 500;--typography-fontWeight-normal: 400;--typography-fontWeight-light: 300;--typography-fontWeight-extralight: 200;--typography-fontWeight-thin: 100;--typography-fontSize-9xl: 128px;--typography-fontSize-8xl: 96px;--typography-fontSize-7xl: 72px;--typography-fontSize-6xl: 60px;--typography-fontSize-5xl: 48px;--typography-fontSize-4xl: 36px;--typography-fontSize-3xl: 30px;--typography-fontSize-2xl: 24px;--typography-fontSize-xl: 20px;--typography-fontSize-lg: 18px;--typography-fontSize-base: 16px;--typography-fontSize-sm: 14px;--typography-fontSize-xs: 12px;--typography-letterSpacing-wide: 0.025em;--typography-letterSpacing-tight: -0.025em;--typography-verticalMargin-base: 24px;--typography-verticalMargin-sm: 16px;--elements-border-secondary-hover: [object Object];--elements-backdrop-background: #fffc;--elements-backdrop-filter: saturate(200%) blur(20px);--elements-container-maxWidth: 64rem;--lead-loose: 2;--lead-relaxed: 1.625;--lead-normal: 1.5;--lead-snug: 1.375;--lead-tight: 1.25;--lead-none: 1;--lead-10: 2.5rem;--lead-9: 2.25rem;--lead-8: 2rem;--lead-7: 1.75rem;--lead-6: 1.5rem;--lead-5: 1.25rem;--lead-4: 1rem;--lead-3: .75rem;--lead-2: .5rem;--lead-1: .025rem;--letterSpacing-widest: 0.1em;--letterSpacing-wider: 0.05em;--letterSpacing-wide: 0.025em;--letterSpacing-normal: 0em;--letterSpacing-tight: -0.025em;--letterSpacing-tighter: -0.05em;--fontSize-9xl: 8rem;--fontSize-8xl: 6rem;--fontSize-7xl: 4.5rem;--fontSize-6xl: 3.75rem;--fontSize-5xl: 3rem;--fontSize-4xl: 2.25rem;--fontSize-3xl: 1.875rem;--fontSize-2xl: 1.5rem;--fontSize-xl: 1.25rem;--fontSize-lg: 1.125rem;--fontSize-base: 1rem;--fontSize-sm: 0.875rem;--fontSize-xs: 0.75rem;--fontWeight-black: 900;--fontWeight-extrabold: 800;--fontWeight-bold: 700;--fontWeight-semibold: 600;--fontWeight-medium: 500;--fontWeight-normal: 400;--fontWeight-light: 300;--fontWeight-extralight: 200;--fontWeight-thin: 100;--font-mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, Liberation Mono, Courier New, monospace;--font-serif: ui-serif, Georgia, Cambria, Times New Roman, Times, serif;--font-sans: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica Neue, Arial, Noto Sans, sans-serif, Apple Color Emoji, Segoe UI Emoji, Segoe UI Symbol, Noto Color Emoji;--opacity-total: 1;--opacity-high: 0.8;--opacity-medium: 0.5;--opacity-soft: 0.3;--opacity-light: 0.15;--opacity-bright: 0.1;--opacity-noOpacity: 0;--borderWidth-lg: 3px;--borderWidth-md: 2px;--borderWidth-sm: 1px;--borderWidth-noBorder: 0;--space-rem-875: 0.875rem;--space-rem-625: 0.625rem;--space-rem-375: 0.375rem;--space-rem-125: 0.125rem;--space-px: 1px;--space-128: 32rem;--space-96: 24rem;--space-80: 20rem;--space-72: 18rem;--space-64: 16rem;--space-60: 15rem;--space-56: 14rem;--space-52: 13rem;--space-48: 12rem;--space-44: 11rem;--space-40: 10rem;--space-36: 9rem;--space-32: 8rem;--space-28: 7rem;--space-24: 6rem;--space-20: 5rem;--space-16: 4rem;--space-14: 3.5rem;--space-12: 3rem;--space-11: 2.75rem;--space-10: 2.5rem;--space-9: 2.25rem;--space-8: 2rem;--space-7: 1.75rem;--space-6: 1.5rem;--space-5: 1.25rem;--space-4: 1rem;--space-3: 0.75rem;--space-2: 0.5rem;--space-1: 0.25rem;--space-0: 0px;--size-full: 100%;--size-7xl: 80rem;--size-6xl: 72rem;--size-5xl: 64rem;--size-4xl: 56rem;--size-3xl: 48rem;--size-2xl: 42rem;--size-xl: 36rem;--size-lg: 32rem;--size-md: 28rem;--size-sm: 24rem;--size-xs: 20rem;--size-200: 200px;--size-104: 104px;--size-80: 80px;--size-64: 64px;--size-56: 56px;--size-48: 48px;--size-40: 40px;--size-32: 32px;--size-24: 24px;--size-20: 20px;--size-16: 16px;--size-12: 12px;--size-8: 8px;--size-6: 6px;--size-4: 4px;--size-2: 2px;--size-0: 0px;--radii-full: 9999px;--radii-3xl: 1.75rem;--radii-2xl: 1.5rem;--radii-xl: 1rem;--radii-lg: 0.75rem;--radii-md: 0.5rem;--radii-sm: 0.375rem;--radii-xs: 0.25rem;--radii-2xs: 0.125rem;--radii-none: 0px;--shadow-none: 0px 0px 0px 0px transparent;--shadow-lg: 0px 10px 15px -3px #000000, 0px 4px 6px -4px #000000;--shadow-md: 0px 4px 6px -1px #000000, 0px 2px 4px -2px #000000;--shadow-sm: 0px 1px 3px 0px #000000, 0px 1px 2px -1px #000000;--shadow-xs: 0px 1px 2px 0px #000000;--height-screen: 100vh;--width-screen: 100vw;--color-primary-900: #002e38;--color-primary-800: #005c70;--color-primary-700: #008aa9;--color-primary-600: #00b9e1;--color-primary-500: #1ad6ff;--color-primary-400: #40ddff;--color-primary-300: #66e4ff;--color-primary-200: #8deaff;--color-primary-100: #b3f1ff;--color-primary-50: #d9f8ff;--color-ruby-900: #380011;--color-ruby-800: #700021;--color-ruby-700: #a90032;--color-ruby-600: #e10043;--color-ruby-500: #ff1a5e;--color-ruby-400: #ff4079;--color-ruby-300: #ff6694;--color-ruby-200: #ff8dae;--color-ruby-100: #ffb3c9;--color-ruby-50: #ffd9e4;--color-pink-900: #380025;--color-pink-800: #70004b;--color-pink-700: #a90070;--color-pink-600: #e10095;--color-pink-500: #ff1ab2;--color-pink-400: #ff40bf;--color-pink-300: #ff66cc;--color-pink-200: #ff8dd8;--color-pink-100: #ffb3e5;--color-pink-50: #ffd9f2;--color-purple-900: #190038;--color-purple-800: #330070;--color-purple-700: #4c00a9;--color-purple-600: #6500e1;--color-purple-500: #811aff;--color-purple-400: #9640ff;--color-purple-300: #ab66ff;--color-purple-200: #c08dff;--color-purple-100: #d5b3ff;--color-purple-50: #ead9ff;--color-royalblue-900: #0b0531;--color-royalblue-800: #160a62;--color-royalblue-700: #211093;--color-royalblue-600: #2c15c4;--color-royalblue-500: #4127e8;--color-royalblue-400: #614bec;--color-royalblue-300: #806ff0;--color-royalblue-200: #a093f3;--color-royalblue-100: #c0b7f7;--color-royalblue-50: #dfdbfb;--color-indigoblue-900: #001238;--color-indigoblue-800: #002370;--color-indigoblue-700: #0035a9;--color-indigoblue-600: #0047e1;--color-indigoblue-500: #1a62ff;--color-indigoblue-400: #407cff;--color-indigoblue-300: #6696ff;--color-indigoblue-200: #8db0ff;--color-indigoblue-100: #b3cbff;--color-indigoblue-50: #d9e5ff;--color-blue-900: #002438;--color-blue-800: #004870;--color-blue-700: #006ca9;--color-blue-600: #0090e1;--color-blue-500: #1aadff;--color-blue-400: #40bbff;--color-blue-300: #66c8ff;--color-blue-200: #8dd6ff;--color-blue-100: #b3e4ff;--color-blue-50: #d9f1ff;--color-lightblue-900: #002e38;--color-lightblue-800: #005c70;--color-lightblue-700: #008aa9;--color-lightblue-600: #00b9e1;--color-lightblue-500: #1ad6ff;--color-lightblue-400: #40ddff;--color-lightblue-300: #66e4ff;--color-lightblue-200: #8deaff;--color-lightblue-100: #b3f1ff;--color-lightblue-50: #d9f8ff;--color-teal-900: #062a28;--color-teal-800: #0b544f;--color-teal-700: #117d77;--color-teal-600: #16a79e;--color-teal-500: #1cd1c6;--color-teal-400: #36e4da;--color-teal-300: #5fe9e1;--color-teal-200: #87efe9;--color-teal-100: #aff4f0;--color-teal-50: #d7faf8;--color-pear-900: #2a2b09;--color-pear-800: #545512;--color-pear-700: #7e801b;--color-pear-600: #a8aa24;--color-pear-500: #d0d32f;--color-pear-400: #d8da52;--color-pear-300: #e0e274;--color-pear-200: #e8e997;--color-pear-100: #eff0ba;--color-pear-50: #f7f8dc;--color-red-900: #380300;--color-red-800: #700700;--color-red-700: #a90a00;--color-red-600: #e10e00;--color-red-500: #ff281a;--color-red-400: #ff4c40;--color-red-300: #ff7066;--color-red-200: #ff948d;--color-red-100: #ffb7b3;--color-red-50: #ffdbd9;--color-orange-900: #381800;--color-orange-800: #702f00;--color-orange-700: #a94700;--color-orange-600: #e15e00;--color-orange-500: #ff7a1a;--color-orange-400: #ff9040;--color-orange-300: #ffa666;--color-orange-200: #ffbd8d;--color-orange-100: #ffd3b3;--color-orange-50: #ffe9d9;--color-yellow-900: #362b03;--color-yellow-800: #6d5605;--color-yellow-700: #a38108;--color-yellow-600: #daac0a;--color-yellow-500: #f5c828;--color-yellow-400: #f7d14c;--color-yellow-300: #f8da70;--color-yellow-200: #fae393;--color-yellow-100: #fcedb7;--color-yellow-50: #fdf6db;--color-green-900: #003f25;--color-green-800: #005e38;--color-green-700: #007e4a;--color-green-600: #009d5d;--color-green-500: #00bd6f;--color-green-400: #00dc82;--color-green-300: #30ffaa;--color-green-200: #83ffcc;--color-green-100: #acffdd;--color-green-50: #d6ffee;--color-gray-900: #18181B;--color-gray-800: #27272A;--color-gray-700: #3f3f46;--color-gray-600: #52525B;--color-gray-500: #71717A;--color-gray-400: #a1a1aa;--color-gray-300: #D4d4d8;--color-gray-200: #e4e4e7;--color-gray-100: #f4f4f5;--color-gray-50: #fafafa;--color-black: #0c0c0d;--color-white: #FFFFFF;--media-portrait: only screen and (orientation: portrait);--media-landscape: only screen and (orientation: landscape);--media-rm: (prefers-reduced-motion: reduce);--media-2xl: (min-width: 1536px);--media-xl: (min-width: 1280px);--media-lg: (min-width: 1024px);--media-md: (min-width: 768px);--media-sm: (min-width: 640px);--media-xs: (min-width: 475px);--alpine-body-color: var(--color-gray-800);--alpine-body-backgroundColor: var(--color-white);--prose-code-inline-fontWeight: var(--typography-fontWeight-normal);--prose-code-inline-fontSize: var(--typography-fontSize-sm);--prose-code-inline-borderRadius: var(--radii-xs);--prose-code-block-pre-padding: var(--typography-verticalMargin-sm);--prose-code-block-margin: var(--typography-verticalMargin-base) 0;--prose-code-block-fontSize: var(--typography-fontSize-sm);--prose-tbody-code-inline-fontSize: var(--typography-fontSize-sm);--prose-tbody-td-padding: var(--typography-verticalMargin-sm);--prose-th-fontWeight: var(--typography-fontWeight-semibold);--prose-th-padding: 0 var(--typography-verticalMargin-sm) var(--typography-verticalMargin-sm) var(--typography-verticalMargin-sm);--prose-table-lineHeight: var(--typography-lead-6);--prose-table-fontSize: var(--typography-fontSize-sm);--prose-table-margin: var(--typography-verticalMargin-base) 0;--prose-hr-margin: var(--typography-verticalMargin-base) 0;--prose-li-margin: var(--typography-verticalMargin-sm) 0;--prose-ol-margin: var(--typography-verticalMargin-base) 0;--prose-ul-margin: var(--typography-verticalMargin-base) 0;--prose-blockquote-margin: var(--typography-verticalMargin-base) 0;--prose-a-code-border-style: var(--prose-a-border-style-static);--prose-a-code-border-width: var(--prose-a-border-width);--prose-a-fontWeight: var(--typography-fontWeight-medium);--prose-img-margin: var(--typography-verticalMargin-base) 0;--prose-strong-fontWeight: var(--typography-fontWeight-semibold);--prose-h6-iconSize: var(--typography-fontSize-base);--prose-h6-fontWeight: var(--typography-fontWeight-semibold);--prose-h6-lineHeight: var(--typography-lead-normal);--prose-h6-fontSize: var(--typography-fontSize-lg);--prose-h5-iconSize: var(--typography-fontSize-lg);--prose-h5-fontWeight: var(--typography-fontWeight-semibold);--prose-h5-lineHeight: var(--typography-lead-snug);--prose-h5-fontSize: var(--typography-fontSize-xl);--prose-h4-iconSize: var(--typography-fontSize-lg);--prose-h4-letterSpacing: var(--typography-letterSpacing-tight);--prose-h4-fontWeight: var(--typography-fontWeight-semibold);--prose-h4-lineHeight: var(--typography-lead-snug);--prose-h4-fontSize: var(--typography-fontSize-2xl);--prose-h3-iconSize: var(--typography-fontSize-xl);--prose-h3-letterSpacing: var(--typography-letterSpacing-tight);--prose-h3-fontWeight: var(--typography-fontWeight-semibold);--prose-h3-lineHeight: var(--typography-lead-snug);--prose-h3-fontSize: var(--typography-fontSize-3xl);--prose-h2-iconSize: var(--typography-fontSize-2xl);--prose-h2-letterSpacing: var(--typography-letterSpacing-tight);--prose-h2-fontWeight: var(--typography-fontWeight-semibold);--prose-h2-lineHeight: var(--typography-lead-tight);--prose-h2-fontSize: var(--typography-fontSize-4xl);--prose-h1-iconSize: var(--typography-fontSize-3xl);--prose-h1-letterSpacing: var(--typography-letterSpacing-tight);--prose-h1-fontWeight: var(--typography-fontWeight-bold);--prose-h1-lineHeight: var(--typography-lead-tight);--prose-h1-fontSize: var(--typography-fontSize-5xl);--prose-p-br-margin: var(--typography-verticalMargin-base) 0 0 0;--prose-p-margin: var(--typography-verticalMargin-base) 0;--prose-p-lineHeight: var(--typography-lead-normal);--typography-color-primary-900: var(--color-primary-900);--typography-color-primary-800: var(--color-primary-800);--typography-color-primary-700: var(--color-primary-700);--typography-color-primary-600: var(--color-primary-600);--typography-color-primary-500: var(--color-primary-500);--typography-color-primary-400: var(--color-primary-400);--typography-color-primary-300: var(--color-primary-300);--typography-color-primary-200: var(--color-primary-200);--typography-color-primary-100: var(--color-primary-100);--typography-color-primary-50: var(--color-primary-50);--typography-font-code: var(--font-mono);--typography-font-body: var(--font-sans);--typography-font-display: var(--font-sans);--typography-body-backgroundColor: var(--color-white);--typography-body-color: var(--color-black);--elements-state-danger-borderColor-secondary: var(--color-red-200);--elements-state-danger-borderColor-primary: var(--color-red-100);--elements-state-danger-backgroundColor-secondary: var(--color-red-100);--elements-state-danger-backgroundColor-primary: var(--color-red-50);--elements-state-danger-color-secondary: var(--color-red-600);--elements-state-danger-color-primary: var(--color-red-500);--elements-state-warning-borderColor-secondary: var(--color-yellow-200);--elements-state-warning-borderColor-primary: var(--color-yellow-100);--elements-state-warning-backgroundColor-secondary: var(--color-yellow-100);--elements-state-warning-backgroundColor-primary: var(--color-yellow-50);--elements-state-warning-color-secondary: var(--color-yellow-700);--elements-state-warning-color-primary: var(--color-yellow-600);--elements-state-success-borderColor-secondary: var(--color-green-200);--elements-state-success-borderColor-primary: var(--color-green-100);--elements-state-success-backgroundColor-secondary: var(--color-green-100);--elements-state-success-backgroundColor-primary: var(--color-green-50);--elements-state-success-color-secondary: var(--color-green-600);--elements-state-success-color-primary: var(--color-green-500);--elements-state-info-borderColor-secondary: var(--color-blue-200);--elements-state-info-borderColor-primary: var(--color-blue-100);--elements-state-info-backgroundColor-secondary: var(--color-blue-100);--elements-state-info-backgroundColor-primary: var(--color-blue-50);--elements-state-info-color-secondary: var(--color-blue-600);--elements-state-info-color-primary: var(--color-blue-500);--elements-state-primary-borderColor-secondary: var(--color-primary-200);--elements-state-primary-borderColor-primary: var(--color-primary-100);--elements-state-primary-backgroundColor-secondary: var(--color-primary-100);--elements-state-primary-backgroundColor-primary: var(--color-primary-50);--elements-state-primary-color-secondary: var(--color-primary-700);--elements-state-primary-color-primary: var(--color-primary-600);--elements-surface-secondary-backgroundColor: var(--color-gray-200);--elements-surface-primary-backgroundColor: var(--color-gray-100);--elements-surface-background-base: var(--color-gray-100);--elements-border-secondary-static: var(--color-gray-200);--elements-border-primary-hover: var(--color-gray-200);--elements-border-primary-static: var(--color-gray-100);--elements-container-padding-md: var(--space-16);--elements-container-padding-sm: var(--space-12);--elements-container-padding-xs: var(--space-8);--elements-container-padding-mobile: var(--space-6);--elements-text-secondary-color-hover: var(--color-gray-700);--elements-text-secondary-color-static: var(--color-gray-500);--elements-text-primary-color-static: var(--color-gray-900);--text-6xl-lineHeight: var(--lead-none);--text-6xl-fontSize: var(--fontSize-6xl);--text-5xl-lineHeight: var(--lead-none);--text-5xl-fontSize: var(--fontSize-5xl);--text-4xl-lineHeight: var(--lead-10);--text-4xl-fontSize: var(--fontSize-4xl);--text-3xl-lineHeight: var(--lead-9);--text-3xl-fontSize: var(--fontSize-3xl);--text-2xl-lineHeight: var(--lead-8);--text-2xl-fontSize: var(--fontSize-2xl);--text-xl-lineHeight: var(--lead-7);--text-xl-fontSize: var(--fontSize-xl);--text-lg-lineHeight: var(--lead-7);--text-lg-fontSize: var(--fontSize-lg);--text-base-lineHeight: var(--lead-6);--text-base-fontSize: var(--fontSize-base);--text-sm-lineHeight: var(--lead-5);--text-sm-fontSize: var(--fontSize-sm);--text-xs-lineHeight: var(--lead-4);--text-xs-fontSize: var(--fontSize-xs);--shadow-2xl: 0px 25px 50px -12px var(--color-gray-900);--shadow-xl: 0px 20px 25px -5px var(--color-gray-400), 0px 8px 10px -6px #000000;--color-secondary-900: var(--color-gray-900);--color-secondary-800: var(--color-gray-800);--color-secondary-700: var(--color-gray-700);--color-secondary-600: var(--color-gray-600);--color-secondary-500: var(--color-gray-500);--color-secondary-400: var(--color-gray-400);--color-secondary-300: var(--color-gray-300);--color-secondary-200: var(--color-gray-200);--color-secondary-100: var(--color-gray-100);--color-secondary-50: var(--color-gray-50);--prose-a-code-background-hover: var(--typography-color-primary-50);--prose-a-code-border-color-hover: var(--typography-color-primary-500);--prose-a-color-hover: var(--typography-color-primary-500);--typography-color-secondary-900: var(--color-secondary-900);--typography-color-secondary-800: var(--color-secondary-800);--typography-color-secondary-700: var(--color-secondary-700);--typography-color-secondary-600: var(--color-secondary-600);--typography-color-secondary-500: var(--color-secondary-500);--typography-color-secondary-400: var(--color-secondary-400);--typography-color-secondary-300: var(--color-secondary-300);--typography-color-secondary-200: var(--color-secondary-200);--typography-color-secondary-100: var(--color-secondary-100);--typography-color-secondary-50: var(--color-secondary-50);--prose-code-inline-backgroundColor: var(--typography-color-secondary-100);--prose-code-inline-color: var(--typography-color-secondary-700);--prose-code-block-backgroundColor: var(--typography-color-secondary-100);--prose-code-block-color: var(--typography-color-secondary-700);--prose-code-block-border-color: var(--typography-color-secondary-200);--prose-tbody-tr-borderBottom-color: var(--typography-color-secondary-200);--prose-th-color: var(--typography-color-secondary-600);--prose-thead-borderBottom-color: var(--typography-color-secondary-200);--prose-thead-border-color: var(--typography-color-secondary-300);--prose-hr-color: var(--typography-color-secondary-200);--prose-blockquote-border-color: var(--typography-color-secondary-200);--prose-blockquote-color: var(--typography-color-secondary-500);--prose-a-code-border-color-static: var(--typography-color-secondary-400); } }@media { :root.dark {--pinceau-mq: dark; --alpine-backdrop-backgroundColor: #18181bb3;--prose-code-block-backdropFilter: contrast(1);--prose-ol-li-markerColor: currentColor;--prose-ul-li-markerColor: currentColor;--prose-a-code-color-hover: currentColor;--prose-a-code-color-static: currentColor;--prose-a-border-color-hover: currentColor;--prose-a-border-color-static: currentColor;--prose-a-color-static: inherit;--elements-backdrop-background: #0c0d0ccc;--alpine-body-color: var(--color-gray-200);--alpine-body-backgroundColor: var(--color-black);--typography-body-backgroundColor: var(--color-black);--typography-body-color: var(--color-white);--elements-state-danger-borderColor-secondary: var(--color-red-700);--elements-state-danger-borderColor-primary: var(--color-red-800);--elements-state-danger-backgroundColor-secondary: var(--color-red-800);--elements-state-danger-backgroundColor-primary: var(--color-red-900);--elements-state-danger-color-secondary: var(--color-red-200);--elements-state-danger-color-primary: var(--color-red-300);--elements-state-warning-borderColor-secondary: var(--color-yellow-700);--elements-state-warning-borderColor-primary: var(--color-yellow-800);--elements-state-warning-backgroundColor-secondary: var(--color-yellow-800);--elements-state-warning-backgroundColor-primary: var(--color-yellow-900);--elements-state-warning-color-secondary: var(--color-yellow-200);--elements-state-warning-color-primary: var(--color-yellow-400);--elements-state-success-borderColor-secondary: var(--color-green-700);--elements-state-success-borderColor-primary: var(--color-green-800);--elements-state-success-backgroundColor-secondary: var(--color-green-800);--elements-state-success-backgroundColor-primary: var(--color-green-900);--elements-state-success-color-secondary: var(--color-green-200);--elements-state-success-color-primary: var(--color-green-400);--elements-state-info-borderColor-secondary: var(--color-blue-700);--elements-state-info-borderColor-primary: var(--color-blue-800);--elements-state-info-backgroundColor-secondary: var(--color-blue-800);--elements-state-info-backgroundColor-primary: var(--color-blue-900);--elements-state-info-color-secondary: var(--color-blue-200);--elements-state-info-color-primary: var(--color-blue-400);--elements-state-primary-borderColor-secondary: var(--color-primary-700);--elements-state-primary-borderColor-primary: var(--color-primary-800);--elements-state-primary-backgroundColor-secondary: var(--color-primary-800);--elements-state-primary-backgroundColor-primary: var(--color-primary-900);--elements-state-primary-color-secondary: var(--color-primary-200);--elements-state-primary-color-primary: var(--color-primary-400);--elements-surface-secondary-backgroundColor: var(--color-gray-800);--elements-surface-primary-backgroundColor: var(--color-gray-900);--elements-surface-background-base: var(--color-gray-900);--elements-border-secondary-static: var(--color-gray-800);--elements-border-primary-hover: var(--color-gray-800);--elements-border-primary-static: var(--color-gray-900);--elements-text-secondary-color-hover: var(--color-gray-200);--elements-text-secondary-color-static: var(--color-gray-400);--elements-text-primary-color-static: var(--color-gray-50);--prose-a-code-background-hover: var(--typography-color-primary-900);--prose-a-code-border-color-hover: var(--typography-color-primary-600);--prose-a-color-hover: var(--typography-color-primary-400);--prose-code-inline-backgroundColor: var(--typography-color-secondary-800);--prose-code-inline-color: var(--typography-color-secondary-200);--prose-code-block-backgroundColor: var(--typography-color-secondary-900);--prose-code-block-color: var(--typography-color-secondary-200);--prose-code-block-border-color: var(--typography-color-secondary-800);--prose-tbody-tr-borderBottom-color: var(--typography-color-secondary-800);--prose-th-color: var(--typography-color-secondary-400);--prose-thead-borderBottom-color: var(--typography-color-secondary-800);--prose-thead-border-color: var(--typography-color-secondary-600);--prose-hr-color: var(--typography-color-secondary-800);--prose-blockquote-border-color: var(--typography-color-secondary-700);--prose-blockquote-color: var(--typography-color-secondary-400);--prose-a-code-border-color-static: var(--typography-color-secondary-600); } }</style><script>"use strict";(()=>{const a=window,e=document.documentElement,m=["dark","light"],c=window.localStorage.getItem("nuxt-color-mode")||"system";let n=c==="system"?f():c;const l=e.getAttribute("data-color-mode-forced");l&&(n=l),i(n),a["__NUXT_COLOR_MODE__"]={preference:c,value:n,getColorScheme:f,addColorScheme:i,removeColorScheme:d};function i(o){const t=""+o+"",s="";e.classList?e.classList.add(t):e.className+=" "+t,s&&e.setAttribute("data-"+s,o)}function d(o){const t=""+o+"",s="";e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp(t,"g"),""),s&&e.removeAttribute("data-"+s)}function r(o){return a.matchMedia("(prefers-color-scheme"+o+")")}function f(){if(a.matchMedia&&r("").media!=="not all"){for(const o of m)if(r(":"+o).matches)return o}return"light"}})();
</script></head>
<body ><div id="__nuxt"><div class="container pv-uygyEf pc-612Glt app-layout" data-v-a9d5dfed data-v-77841c0a><!--[--><div class="nuxt-progress" style="width:0%;height:3px;opacity:0;background-size:Infinity% auto;" data-v-a9d5dfed></div><header class="right" data-v-a9d5dfed data-v-0528598b><div class="menu" data-v-0528598b><button aria-label="Navigation Menu" data-v-0528598b><svg width="24" height="24" viewBox="0 0 68 68" fill="currentColor" xmlns="http://www.w3.org/2000/svg" data-v-0528598b><path d="M8 34C8 32.1362 8 31.2044 8.30448 30.4693C8.71046 29.4892 9.48915 28.7105 10.4693 28.3045C11.2044 28 12.1362 28 14 28C15.8638 28 16.7956 28 17.5307 28.3045C18.5108 28.7105 19.2895 29.4892 19.6955 30.4693C20 31.2044 20 32.1362 20 34C20 35.8638 20 36.7956 19.6955 37.5307C19.2895 38.5108 18.5108 39.2895 17.5307 39.6955C16.7956 40 15.8638 40 14 40C12.1362 40 11.2044 40 10.4693 39.6955C9.48915 39.2895 8.71046 38.5108 8.30448 37.5307C8 36.7956 8 35.8638 8 34Z" data-v-0528598b></path><path d="M28 34C28 32.1362 28 31.2044 28.3045 30.4693C28.7105 29.4892 29.4892 28.7105 30.4693 28.3045C31.2044 28 32.1362 28 34 28C35.8638 28 36.7956 28 37.5307 28.3045C38.5108 28.7105 39.2895 29.4892 39.6955 30.4693C40 31.2044 40 32.1362 40 34C40 35.8638 40 36.7956 39.6955 37.5307C39.2895 38.5108 38.5108 39.2895 37.5307 39.6955C36.7956 40 35.8638 40 34 40C32.1362 40 31.2044 40 30.4693 39.6955C29.4892 39.2895 28.7105 38.5108 28.3045 37.5307C28 36.7956 28 35.8638 28 34Z" data-v-0528598b></path><path d="M48 34C48 32.1362 48 31.2044 48.3045 30.4693C48.7105 29.4892 49.4892 28.7105 50.4693 28.3045C51.2044 28 52.1362 28 54 28C55.8638 28 56.7956 28 57.5307 28.3045C58.5108 28.7105 59.2895 29.4892 59.6955 30.4693C60 31.2044 60 32.1362 60 34C60 35.8638 60 36.7956 59.6955 37.5307C59.2895 38.5108 58.5108 39.2895 57.5307 39.6955C56.7956 40 55.8638 40 54 40C52.1362 40 51.2044 40 50.4693 39.6955C49.4892 39.2895 48.7105 38.5108 48.3045 37.5307C48 36.7956 48 35.8638 48 34Z" data-v-0528598b></path></svg></button></div><div class="overlay" data-v-0528598b><nav data-v-0528598b data-v-f1645879><ul data-v-f1645879><!--[--><li data-v-f1645879><a href="/" class="" data-v-f1645879><span class="underline-fx" data-v-f1645879></span> Home</a></li><li data-v-f1645879><a href="/contact" class="" data-v-f1645879><span class="underline-fx" data-v-f1645879></span> Contact</a></li><li data-v-f1645879><a href="/posts" class="" data-v-f1645879><span class="underline-fx" data-v-f1645879></span> Archive</a></li><!--]--></ul></nav></div><div class="logo" data-v-0528598b><a href="/" class="" data-v-0528598b><img src="/logo-dark.svg" class="dark-img" alt="alpine" width="89" height="31" data-v-0528598b><img src="/logo.svg" class="light-img" alt="alpine" width="89" height="31" data-v-0528598b></a></div><div class="main-nav" data-v-0528598b><nav data-v-0528598b data-v-f1645879><ul data-v-f1645879><!--[--><li data-v-f1645879><a href="/" class="" data-v-f1645879><span class="underline-fx" data-v-f1645879></span> Home</a></li><li data-v-f1645879><a href="/contact" class="" data-v-f1645879><span class="underline-fx" data-v-f1645879></span> Contact</a></li><li data-v-f1645879><a href="/posts" class="" data-v-f1645879><span class="underline-fx" data-v-f1645879></span> Archive</a></li><!--]--></ul></nav></div></header><!--[--><div class="document-driven-page"><main><!--[--><div><h2 id="motivation" data-v-6d609909><a aria-current="page" href="/posts/serverless-strapi-tutorial/#motivation" class="router-link-active router-link-exact-active" data-v-6d609909><!--[-->Motivation<!--]--><!----></a></h2><p data-v-f4c85dbd><!--[-->The JAM Stack and Serverless are two trends in web development that have a lot going on right now. One of the most common thing to do for a web developer is to create a website with a CMS. Static sites in themselves follow the serverless paradigm of infinite scalability, pay-per-use, and no-touch operations. But we lack an all-round CMS with the same properties.<!--]--></p><p data-v-f4c85dbd><!--[-->Wordpress can be used as a headless CMS for modern front-ends, but the old giant is still not ready for more than a few use cases. There are managed CMS-es such as <a href="https://www.contentful.com/" rel="nofollow" data-v-d83694f9><!--[-->Contentful<!--]--></a> and <a href="https://www.cosmicjs.com/" rel="nofollow" data-v-d83694f9><!--[-->Cosmic<!--]--></a>. These are good products, but are expensive for many users. Furthermore, they are not open source which entails some drawbacks such as not being very flexible.<!--]--></p><p data-v-f4c85dbd><!--[-->Strapi is a leading open source headless CMS. While it&#39;s relatively new, it is popular, which means they really fill a need in the market. I have many complaints about Strapi, but they are, as far as I see it now, the best option for a general open source CMS.<!--]--></p><p data-v-f4c85dbd><!--[-->One drawback even with Strapi is that you need to host it yourself. While it&#39;s easy to spin up a server with a database, you have to be worried about scaling it. Even for hobby projects which will probably never have to scale, I feel uncomfortable knowing I might have to get my hands dirty with scaling a database and all that.<!--]--></p><p data-v-f4c85dbd><!--[-->Strapi is not made to be serverless. It is, however, possible to shoehorn a Strapi application onto AWS Lambda with the Serverless framework. Since AWS also has a MySQL compatible serverless database in Aurora, we might be able to create an infinitely scalable Strapi that requires very little ops, and costs nothing when not used.<!--]--></p><h3 id="what-is-serverless" data-v-4af47174><a aria-current="page" href="/posts/serverless-strapi-tutorial/#what-is-serverless" class="router-link-active router-link-exact-active" data-v-4af47174><!--[-->What is serverless?<!--]--><!----></a></h3><p data-v-f4c85dbd><!--[--><em data-v-4353b993><!--[-->It has little to do with servers.<!--]--></em><!--]--></p><ul data-v-b9ad2675><!--[--><li data-v-3181147b><!--[--><strong data-v-c6a59043><!--[-->Infinitely scalable<!--]--></strong>
The infrastructure can handle spikes and sudden growth is use without problem.<!--]--></li><li data-v-3181147b><!--[--><strong data-v-c6a59043><!--[-->No touch operations<!--]--></strong>
Not only is it scalable. Scaling does not require any effort. You don&#39;t manually add or remove instances. You don&#39;t write scripts to automatically do that stuff. It&#39;s taken care of in the infrastructure. You don&#39;t shut things down at night or in weekends to save money because you don&#39;t need to. You don&#39;t worry about scaling because you know it does so by itself.<!--]--></li><li data-v-3181147b><!--[--><strong data-v-c6a59043><!--[-->Pay-per-use<!--]--></strong>
You only pay when things are being done. Costs are predictable and follow a smooth, linear curve. No execution means zero cost.<!--]--></li><!--]--></ul><h2 id="set-up-strapi" data-v-6d609909><a aria-current="page" href="/posts/serverless-strapi-tutorial/#set-up-strapi" class="router-link-active router-link-exact-active" data-v-6d609909><!--[-->Set Up Strapi<!--]--><!----></a></h2><p data-v-f4c85dbd><!--[-->We start by setting up Strapi locally. We roughly follow the <a href="https://strapi.io/documentation/v3.x/installation/cli.html" rel="nofollow" data-v-d83694f9><!--[-->official quick start guide<!--]--></a> for Strapi 3.1.<!--]--></p><div class="highlight-bash prose-code" meta data-v-ef0b30fc><!----><!--[--><pre class="language-bash shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0">yarn</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> create</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> strapi-app</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> sls-strapi</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF"> --quickstart
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-ef0b30fc data-v-2c5d870f><span class="sr-only" data-v-2c5d870f>Copy to clipboard</span><span class="icon-wrapper" data-v-2c5d870f><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-2c5d870f style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-5f091540><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8Zm-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-f4c85dbd><!--[-->This will create a basic Strapi app with the file based database SQLite in the <code class="" data-v-69006e27><!--[-->sls-strapi<!--]--></code> folder. If successful, Strapi will run on <code class="" data-v-69006e27><!--[-->http://localhost:1337<!--]--></code>.<!--]--></p><p data-v-f4c85dbd><!--[--><img style="aspect-ratio:952/563;" src="/posts/serverless-strapi-tutorial/Untitled.png" alt="/posts/serverless-strapi-tutorial/Untitled.png" data-v-80d56572><!--]--></p><p data-v-f4c85dbd><!--[--><img style="aspect-ratio:480/694;" src="/posts/serverless-strapi-tutorial/Untitled_1.png" alt="Untitled 1.png" data-v-80d56572><!--]--></p><p data-v-f4c85dbd><!--[-->While we won&#39;t use this instance of Strapi with the SQLite database, you should make at least one content type in Strapi either through the content type builder or by adding a content type in the <code class="" data-v-69006e27><!--[-->api/<!--]--></code> folder. I will create a content type called <strong data-v-c6a59043><!--[-->page<!--]--></strong> with a single field called <strong data-v-c6a59043><!--[-->title<!--]--></strong>. Make the content type and wait for the server to restart.<!--]--></p><p data-v-f4c85dbd><!--[--><img style="aspect-ratio:924/327;" src="/posts/serverless-strapi-tutorial/Untitled_2.png" alt="Untitled 2.png" data-v-80d56572><!--]--></p><p data-v-f4c85dbd><!--[-->Add a single item to the collection, then test that it works by getting <code class="" data-v-69006e27><!--[-->http://localhost:1337/pages<!--]--></code>. You will get a <code class="" data-v-69006e27><!--[-->403 FORBIDDEN<!--]--></code> message, as we need to allow unauthenticated users read access to the collection.<!--]--></p><p data-v-f4c85dbd><!--[--><img style="aspect-ratio:1197/742;" src="/posts/serverless-strapi-tutorial/Untitled_3.png" alt="Untitled 3.png" data-v-80d56572><!--]--></p><p data-v-f4c85dbd><!--[-->Go to Roles &amp; Permissions, edit the Public group and add permissions to read. <code class="" data-v-69006e27><!--[-->http://localhost:1337/pages<!--]--></code> should now respond with your single page item.<!--]--></p><p data-v-f4c85dbd><!--[-->We will come back to configuring Strapi for our serverless needs later.<!--]--></p><h2 id="set-up-serverless" data-v-6d609909><a aria-current="page" href="/posts/serverless-strapi-tutorial/#set-up-serverless" class="router-link-active router-link-exact-active" data-v-6d609909><!--[-->Set up Serverless<!--]--><!----></a></h2><p data-v-f4c85dbd><!--[-->We will add some Serverless config in the same folder as our Strapi app. If you&#39;re not familiar with Serverless, you should perhaps try to deploy a simple Express app on Amazon Web Services (AWS) first, just to get some idea of how it works. To get started, check out the official <a href="https://www.serverless.com/framework/docs/providers/aws/guide/quick-start/" rel="nofollow" data-v-d83694f9><!--[-->AWS quick start guide<!--]--></a>.<!--]--></p><p data-v-f4c85dbd><!--[-->We install some packages and create a <code class="" data-v-69006e27><!--[-->serverless.yml<!--]--></code> config and a <code class="" data-v-69006e27><!--[-->app.js<!--]--></code> file to get started.<!--]--></p><div class="highlight-bash prose-code" meta data-v-ef0b30fc><!----><!--[--><pre class="language-bash shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0">yarn</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> add</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF"> -D</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> serverless-offline
</span></span><span class="line" line="2"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0">yarn</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> add</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> serverless-http
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-ef0b30fc data-v-2c5d870f><span class="sr-only" data-v-2c5d870f>Copy to clipboard</span><span class="icon-wrapper" data-v-2c5d870f><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-2c5d870f style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-5f091540><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8Zm-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-f4c85dbd><!--[--><code class="" data-v-69006e27><!--[-->serverless-http<!--]--></code> is an amazing plugin that makes it trivial to run any Node server as a Lambda function. Koa, which Strapi uses, is also supported.<!--]--></p><p data-v-f4c85dbd><!--[--><code class="" data-v-69006e27><!--[-->serverless-offline<!--]--></code> is a well-made plugin that lets you run Serverless apps locally. It works well with <code class="" data-v-69006e27><!--[-->serverless-http<!--]--></code> and even simulates API Gateway, which is a layer in the AWS cloud all http requests go through.<!--]--></p><p data-v-f4c85dbd><!--[--><strong data-v-c6a59043><!--[-->TIP<!--]--></strong>
Use a profile in your Serverless config with AWS credentials.<!--]--></p><!--[--><!--[--><div nuxt-ssr-component-uid="f212b3bf-936a-4bd2-b8c2-bc6bb1eb1061"><div><div id="gist104844340" class="gist">
    <div class="gist-file" translate="no">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-serverless-yml" class="file my-2">
    
    <div itemprop="text" class="Box-body p-0 blob-wrapper data type-yaml  ">

        
<div class="js-check-bidi js-blob-code-container blob-code-content">

  <template class="js-file-alert-template">
  <div data-view-component="true" class="flash flash-warn flash-full d-flex flex-items-center">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
    <span>
      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
      <a class="Link--inTextBlock" href="https://github.co/hiddenchars" target="_blank">Learn more about bidirectional Unicode characters</a>
    </span>


  <div data-view-component="true" class="flash-action">        <a href="#" data-view-component="true" class="btn-sm btn">    Show hidden characters
</a>
</div>
</div></template>
<template class="js-line-alert-template">
  <span aria-label="This line has hidden Unicode characters" data-view-component="true" class="line-alert tooltipped tooltipped-e">
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
</span></template>

  <table data-hpc class="highlight tab-size js-file-line-container js-code-nav-container js-tagsearch-file" data-tab-size="8" data-paste-markdown-skip data-tagsearch-lang="YAML" data-tagsearch-path="serverless.yml">
        <tr>
          <td id="file-serverless-yml-L1" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1"></td>
          <td id="file-serverless-yml-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-ent">service</span>: <span class="pl-s">sls-strapi</span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L2" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2"></td>
          <td id="file-serverless-yml-LC2" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L3" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3"></td>
          <td id="file-serverless-yml-LC3" class="blob-code blob-code-inner js-file-line"><span class="pl-ent">provider</span>:</td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L4" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4"></td>
          <td id="file-serverless-yml-LC4" class="blob-code blob-code-inner js-file-line">  <span class="pl-ent">name</span>: <span class="pl-s">aws</span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L5" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="5"></td>
          <td id="file-serverless-yml-LC5" class="blob-code blob-code-inner js-file-line">  <span class="pl-ent">runtime</span>: <span class="pl-s">nodejs12.x</span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L6" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="6"></td>
          <td id="file-serverless-yml-LC6" class="blob-code blob-code-inner js-file-line">  <span class="pl-ent">profile</span>: <span class="pl-s">&lt;your-aws-profile&gt;</span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L7" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="7"></td>
          <td id="file-serverless-yml-LC7" class="blob-code blob-code-inner js-file-line">  <span class="pl-ent">logRetentionInDays</span>: <span class="pl-s">${self:custom.vars.logRetentionInDays, 1}</span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L8" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="8"></td>
          <td id="file-serverless-yml-LC8" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L9" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="9"></td>
          <td id="file-serverless-yml-LC9" class="blob-code blob-code-inner js-file-line">  <span class="pl-ent">environment</span>:</td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L10" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="10"></td>
          <td id="file-serverless-yml-LC10" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">ADMIN_JWT_SECRET</span>: <span class="pl-s"><span class="pl-pds">&quot;</span>Just using dummy<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L11" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="11"></td>
          <td id="file-serverless-yml-LC11" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L12" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="12"></td>
          <td id="file-serverless-yml-LC12" class="blob-code blob-code-inner js-file-line"><span class="pl-ent">package</span>:</td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L13" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="13"></td>
          <td id="file-serverless-yml-LC13" class="blob-code blob-code-inner js-file-line">  <span class="pl-ent">exclude</span>:</td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L14" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="14"></td>
          <td id="file-serverless-yml-LC14" class="blob-code blob-code-inner js-file-line">    - <span class="pl-s">./**</span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L15" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="15"></td>
          <td id="file-serverless-yml-LC15" class="blob-code blob-code-inner js-file-line">  <span class="pl-ent">include</span>:</td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L16" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="16"></td>
          <td id="file-serverless-yml-LC16" class="blob-code blob-code-inner js-file-line">    - <span class="pl-s">node_modules/**</span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L17" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="17"></td>
          <td id="file-serverless-yml-LC17" class="blob-code blob-code-inner js-file-line">    - <span class="pl-s">api/**</span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L18" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="18"></td>
          <td id="file-serverless-yml-LC18" class="blob-code blob-code-inner js-file-line">    - <span class="pl-s">config/**</span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L19" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="19"></td>
          <td id="file-serverless-yml-LC19" class="blob-code blob-code-inner js-file-line">    - <span class="pl-s">extensions/**</span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L20" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="20"></td>
          <td id="file-serverless-yml-LC20" class="blob-code blob-code-inner js-file-line">    - <span class="pl-s">plugins/**</span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L21" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="21"></td>
          <td id="file-serverless-yml-LC21" class="blob-code blob-code-inner js-file-line">    - <span class="pl-s">package.json</span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L22" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="22"></td>
          <td id="file-serverless-yml-LC22" class="blob-code blob-code-inner js-file-line">    - <span class="pl-s">app.js</span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L23" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="23"></td>
          <td id="file-serverless-yml-LC23" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L24" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="24"></td>
          <td id="file-serverless-yml-LC24" class="blob-code blob-code-inner js-file-line"><span class="pl-ent">functions</span>:</td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L25" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="25"></td>
          <td id="file-serverless-yml-LC25" class="blob-code blob-code-inner js-file-line">  <span class="pl-ent">api</span>:</td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L26" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="26"></td>
          <td id="file-serverless-yml-LC26" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">handler</span>: <span class="pl-s">app.handler</span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L27" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="27"></td>
          <td id="file-serverless-yml-LC27" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">memorySize</span>: <span class="pl-c1">1024</span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L28" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="28"></td>
          <td id="file-serverless-yml-LC28" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">timeout</span>: <span class="pl-c1">24</span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L29" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="29"></td>
          <td id="file-serverless-yml-LC29" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">events</span>:</td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L30" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="30"></td>
          <td id="file-serverless-yml-LC30" class="blob-code blob-code-inner js-file-line">      - <span class="pl-ent">http</span>:</td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L31" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="31"></td>
          <td id="file-serverless-yml-LC31" class="blob-code blob-code-inner js-file-line">          <span class="pl-ent">path</span>: <span class="pl-s">/</span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L32" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="32"></td>
          <td id="file-serverless-yml-LC32" class="blob-code blob-code-inner js-file-line">          <span class="pl-ent">method</span>: <span class="pl-s">ANY</span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L33" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="33"></td>
          <td id="file-serverless-yml-LC33" class="blob-code blob-code-inner js-file-line">          <span class="pl-ent">cors</span>: <span class="pl-c1">true</span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L34" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="34"></td>
          <td id="file-serverless-yml-LC34" class="blob-code blob-code-inner js-file-line">      - <span class="pl-ent">http</span>:</td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L35" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="35"></td>
          <td id="file-serverless-yml-LC35" class="blob-code blob-code-inner js-file-line">          <span class="pl-ent">path</span>: <span class="pl-s">/{any+}</span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L36" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="36"></td>
          <td id="file-serverless-yml-LC36" class="blob-code blob-code-inner js-file-line">          <span class="pl-ent">method</span>: <span class="pl-s">ANY</span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L37" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="37"></td>
          <td id="file-serverless-yml-LC37" class="blob-code blob-code-inner js-file-line">          <span class="pl-ent">cors</span>: <span class="pl-c1">true</span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L38" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="38"></td>
          <td id="file-serverless-yml-LC38" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L39" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="39"></td>
          <td id="file-serverless-yml-LC39" class="blob-code blob-code-inner js-file-line"><span class="pl-ent">plugins</span>:</td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L40" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="40"></td>
          <td id="file-serverless-yml-LC40" class="blob-code blob-code-inner js-file-line">  - <span class="pl-s">serverless-offline</span></td>
        </tr>
  </table>
</div>


    </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/viktorfa/909da389bfccd7255b147a63487ff7fd/raw/2286e6079c53a31bb6eb83b4cc500994d6f3b772/serverless.yml" style="float:right" class="Link--inTextBlock">view raw</a>
        <a href="https://gist.github.com/viktorfa/909da389bfccd7255b147a63487ff7fd#file-serverless-yml" class="Link--inTextBlock">
          serverless.yml
        </a>
        hosted with &#10084; by <a class="Link--inTextBlock" href="https://github.com">GitHub</a>
      </div>
    </div>
</div>
</div><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-232d920b3dfe.css" type="text/css"></div><!--]--><!--]--><!--[--><!--[--><div nuxt-ssr-component-uid="cd618a6d-04db-4dff-acdd-143060736d0f"><div><div id="gist104844386" class="gist">
    <div class="gist-file" translate="no">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-app-js" class="file my-2">
    
    <div itemprop="text" class="Box-body p-0 blob-wrapper data type-javascript  ">

        
<div class="js-check-bidi js-blob-code-container blob-code-content">

  <template class="js-file-alert-template">
  <div data-view-component="true" class="flash flash-warn flash-full d-flex flex-items-center">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
    <span>
      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
      <a class="Link--inTextBlock" href="https://github.co/hiddenchars" target="_blank">Learn more about bidirectional Unicode characters</a>
    </span>


  <div data-view-component="true" class="flash-action">        <a href="#" data-view-component="true" class="btn-sm btn">    Show hidden characters
</a>
</div>
</div></template>
<template class="js-line-alert-template">
  <span aria-label="This line has hidden Unicode characters" data-view-component="true" class="line-alert tooltipped tooltipped-e">
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
</span></template>

  <table data-hpc class="highlight tab-size js-file-line-container js-code-nav-container js-tagsearch-file" data-tab-size="8" data-paste-markdown-skip data-tagsearch-lang="JavaScript" data-tagsearch-path="app.js">
        <tr>
          <td id="file-app-js-L1" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1"></td>
          <td id="file-app-js-LC1" class="blob-code blob-code-inner js-file-line"><span class=pl-k>const</span> <span class=pl-s1>startStrapi</span> <span class=pl-c1>=</span> <span class=pl-en>require</span><span class=pl-kos>(</span><span class=pl-s>&quot;strapi/lib/Strapi&quot;</span><span class=pl-kos>)</span><span class=pl-kos>;</span></td>
        </tr>
        <tr>
          <td id="file-app-js-L2" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2"></td>
          <td id="file-app-js-LC2" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="file-app-js-L3" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3"></td>
          <td id="file-app-js-LC3" class="blob-code blob-code-inner js-file-line"><span class=pl-k>const</span> <span class=pl-s1>serverless</span> <span class=pl-c1>=</span> <span class=pl-en>require</span><span class=pl-kos>(</span><span class=pl-s>&quot;serverless-http&quot;</span><span class=pl-kos>)</span><span class=pl-kos>;</span></td>
        </tr>
        <tr>
          <td id="file-app-js-L4" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4"></td>
          <td id="file-app-js-LC4" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="file-app-js-L5" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="5"></td>
          <td id="file-app-js-LC5" class="blob-code blob-code-inner js-file-line"><span class=pl-smi>module</span><span class=pl-kos>.</span><span class=pl-c1>exports</span><span class=pl-kos>.</span><span class=pl-en>handler</span> <span class=pl-c1>=</span> <span class=pl-k>async</span> <span class=pl-kos>(</span><span class=pl-s1>event</span><span class=pl-kos>,</span> <span class=pl-s1>context</span><span class=pl-kos>)</span> <span class=pl-c1>=&gt;</span> <span class=pl-kos>{</span></td>
        </tr>
        <tr>
          <td id="file-app-js-L6" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="6"></td>
          <td id="file-app-js-LC6" class="blob-code blob-code-inner js-file-line">  <span class=pl-k>if</span> <span class=pl-kos>(</span><span class=pl-c1>!</span><span class=pl-s1>global</span><span class=pl-kos>.</span><span class=pl-c1>strapi</span><span class=pl-kos>)</span> <span class=pl-kos>{</span></td>
        </tr>
        <tr>
          <td id="file-app-js-L7" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="7"></td>
          <td id="file-app-js-LC7" class="blob-code blob-code-inner js-file-line">    <span class=pl-smi>console</span><span class=pl-kos>.</span><span class=pl-en>log</span><span class=pl-kos>(</span><span class=pl-s>&quot;Cold starting Strapi&quot;</span><span class=pl-kos>)</span><span class=pl-kos>;</span></td>
        </tr>
        <tr>
          <td id="file-app-js-L8" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="8"></td>
          <td id="file-app-js-LC8" class="blob-code blob-code-inner js-file-line">    <span class=pl-k>await</span> <span class=pl-s1>startStrapi</span><span class=pl-kos>(</span><span class=pl-kos>{</span> <span class=pl-c1>dir</span>: <span class=pl-s1>__dirname</span> <span class=pl-kos>}</span><span class=pl-kos>)</span><span class=pl-kos>.</span><span class=pl-en>start</span><span class=pl-kos>(</span><span class=pl-kos>)</span><span class=pl-kos>;</span></td>
        </tr>
        <tr>
          <td id="file-app-js-L9" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="9"></td>
          <td id="file-app-js-LC9" class="blob-code blob-code-inner js-file-line">  <span class=pl-kos>}</span></td>
        </tr>
        <tr>
          <td id="file-app-js-L10" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="10"></td>
          <td id="file-app-js-LC10" class="blob-code blob-code-inner js-file-line">  <span class=pl-k>const</span> <span class=pl-s1>handler</span> <span class=pl-c1>=</span> <span class=pl-s1>serverless</span><span class=pl-kos>(</span><span class=pl-s1>global</span><span class=pl-kos>.</span><span class=pl-c1>strapi</span><span class=pl-kos>.</span><span class=pl-c1>app</span><span class=pl-kos>)</span><span class=pl-kos>;</span></td>
        </tr>
        <tr>
          <td id="file-app-js-L11" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="11"></td>
          <td id="file-app-js-LC11" class="blob-code blob-code-inner js-file-line">  <span class=pl-k>return</span> <span class=pl-s1>handler</span><span class=pl-kos>(</span><span class=pl-s1>event</span><span class=pl-kos>,</span> <span class=pl-s1>context</span><span class=pl-kos>)</span><span class=pl-kos>;</span></td>
        </tr>
        <tr>
          <td id="file-app-js-L12" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="12"></td>
          <td id="file-app-js-LC12" class="blob-code blob-code-inner js-file-line"><span class=pl-kos>}</span><span class=pl-kos>;</span></td>
        </tr>
  </table>
</div>


    </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/viktorfa/8186fa9becd42baf5e83868a93de9297/raw/c90e988a41c2f27c2836738e4d6d623b95d060d2/app.js" style="float:right" class="Link--inTextBlock">view raw</a>
        <a href="https://gist.github.com/viktorfa/8186fa9becd42baf5e83868a93de9297#file-app-js" class="Link--inTextBlock">
          app.js
        </a>
        hosted with &#10084; by <a class="Link--inTextBlock" href="https://github.com">GitHub</a>
      </div>
    </div>
</div>
</div><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-232d920b3dfe.css" type="text/css"></div><!--]--><!--]--><p data-v-f4c85dbd><!--[-->You should now have <code class="" data-v-69006e27><!--[-->app.js<!--]--></code> and <code class="" data-v-69006e27><!--[-->serverless.yml<!--]--></code> in your root directory.<!--]--></p><p data-v-f4c85dbd><!--[-->Before we try it, update the database config in <code class="" data-v-69006e27><!--[-->config/database.js<!--]--></code>, so that the storage path for SQLite in the cloud is in the writeable <code class="" data-v-69006e27><!--[-->/tmp<!--]--></code> directory.<!--]--></p><!--[--><!--[--><div nuxt-ssr-component-uid="fafeda45-2b34-4863-960f-b6883ddcea31"><div><div id="gist104894058" class="gist">
    <div class="gist-file" translate="no">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-database-js" class="file my-2">
    
    <div itemprop="text" class="Box-body p-0 blob-wrapper data type-javascript  ">

        
<div class="js-check-bidi js-blob-code-container blob-code-content">

  <template class="js-file-alert-template">
  <div data-view-component="true" class="flash flash-warn flash-full d-flex flex-items-center">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
    <span>
      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
      <a class="Link--inTextBlock" href="https://github.co/hiddenchars" target="_blank">Learn more about bidirectional Unicode characters</a>
    </span>


  <div data-view-component="true" class="flash-action">        <a href="#" data-view-component="true" class="btn-sm btn">    Show hidden characters
</a>
</div>
</div></template>
<template class="js-line-alert-template">
  <span aria-label="This line has hidden Unicode characters" data-view-component="true" class="line-alert tooltipped tooltipped-e">
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
</span></template>

  <table data-hpc class="highlight tab-size js-file-line-container js-code-nav-container js-tagsearch-file" data-tab-size="8" data-paste-markdown-skip data-tagsearch-lang="JavaScript" data-tagsearch-path="database.js">
        <tr>
          <td id="file-database-js-L1" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1"></td>
          <td id="file-database-js-LC1" class="blob-code blob-code-inner js-file-line"><span class=pl-c>// config/database.js</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L2" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2"></td>
          <td id="file-database-js-LC2" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="file-database-js-L3" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3"></td>
          <td id="file-database-js-LC3" class="blob-code blob-code-inner js-file-line"><span class=pl-k>const</span> <span class=pl-en>getDatabaseConfig</span> <span class=pl-c1>=</span> <span class=pl-kos>(</span><span class=pl-kos>{</span> env <span class=pl-kos>}</span><span class=pl-kos>)</span> <span class=pl-c1>=&gt;</span> <span class=pl-kos>{</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L4" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4"></td>
          <td id="file-database-js-LC4" class="blob-code blob-code-inner js-file-line">  <span class=pl-k>if</span> <span class=pl-kos>(</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L5" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="5"></td>
          <td id="file-database-js-LC5" class="blob-code blob-code-inner js-file-line">    <span class=pl-en>env</span><span class=pl-kos>(</span><span class=pl-s>&quot;IS_OFFLINE&quot;</span><span class=pl-kos>,</span> <span class=pl-c1>null</span><span class=pl-kos>)</span> <span class=pl-c1>===</span> <span class=pl-s>&quot;true&quot;</span> <span class=pl-c1>||</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L6" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="6"></td>
          <td id="file-database-js-LC6" class="blob-code blob-code-inner js-file-line">    <span class=pl-en>env</span><span class=pl-kos>(</span><span class=pl-s>&quot;LAMBDA_RUNTIME_DIR&quot;</span><span class=pl-kos>,</span> <span class=pl-c1>null</span><span class=pl-kos>)</span> <span class=pl-c1>===</span> <span class=pl-c1>null</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L7" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="7"></td>
          <td id="file-database-js-LC7" class="blob-code blob-code-inner js-file-line">  <span class=pl-kos>)</span> <span class=pl-kos>{</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L8" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="8"></td>
          <td id="file-database-js-LC8" class="blob-code blob-code-inner js-file-line">    <span class=pl-c>// In local simulated Lambda or normal Strapi</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L9" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="9"></td>
          <td id="file-database-js-LC9" class="blob-code blob-code-inner js-file-line">    <span class=pl-k>return</span> <span class=pl-kos>{</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L10" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="10"></td>
          <td id="file-database-js-LC10" class="blob-code blob-code-inner js-file-line">      <span class=pl-c1>connector</span>: <span class=pl-s>&quot;bookshelf&quot;</span><span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L11" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="11"></td>
          <td id="file-database-js-LC11" class="blob-code blob-code-inner js-file-line">      <span class=pl-c1>settings</span>: <span class=pl-kos>{</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L12" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="12"></td>
          <td id="file-database-js-LC12" class="blob-code blob-code-inner js-file-line">        <span class=pl-c1>client</span>: <span class=pl-s>&quot;sqlite&quot;</span><span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L13" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="13"></td>
          <td id="file-database-js-LC13" class="blob-code blob-code-inner js-file-line">        <span class=pl-c1>filename</span>: <span class=pl-en>env</span><span class=pl-kos>(</span><span class=pl-s>&quot;DATABASE_FILENAME&quot;</span><span class=pl-kos>,</span> <span class=pl-s>&quot;.tmp/data.db&quot;</span><span class=pl-kos>)</span><span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L14" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="14"></td>
          <td id="file-database-js-LC14" class="blob-code blob-code-inner js-file-line">      <span class=pl-kos>}</span><span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L15" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="15"></td>
          <td id="file-database-js-LC15" class="blob-code blob-code-inner js-file-line">      <span class=pl-c1>options</span>: <span class=pl-kos>{</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L16" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="16"></td>
          <td id="file-database-js-LC16" class="blob-code blob-code-inner js-file-line">        <span class=pl-c1>useNullAsDefault</span>: <span class=pl-c1>true</span><span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L17" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="17"></td>
          <td id="file-database-js-LC17" class="blob-code blob-code-inner js-file-line">      <span class=pl-kos>}</span><span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L18" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="18"></td>
          <td id="file-database-js-LC18" class="blob-code blob-code-inner js-file-line">    <span class=pl-kos>}</span><span class=pl-kos>;</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L19" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="19"></td>
          <td id="file-database-js-LC19" class="blob-code blob-code-inner js-file-line">  <span class=pl-kos>}</span> <span class=pl-k>else</span> <span class=pl-kos>{</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L20" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="20"></td>
          <td id="file-database-js-LC20" class="blob-code blob-code-inner js-file-line">    <span class=pl-c>// In Lambda on AWS</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L21" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="21"></td>
          <td id="file-database-js-LC21" class="blob-code blob-code-inner js-file-line">    <span class=pl-k>return</span> <span class=pl-kos>{</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L22" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="22"></td>
          <td id="file-database-js-LC22" class="blob-code blob-code-inner js-file-line">      <span class=pl-c1>connector</span>: <span class=pl-s>&quot;bookshelf&quot;</span><span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L23" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="23"></td>
          <td id="file-database-js-LC23" class="blob-code blob-code-inner js-file-line">      <span class=pl-c1>settings</span>: <span class=pl-kos>{</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L24" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="24"></td>
          <td id="file-database-js-LC24" class="blob-code blob-code-inner js-file-line">        <span class=pl-c1>client</span>: <span class=pl-s>&quot;sqlite&quot;</span><span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L25" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="25"></td>
          <td id="file-database-js-LC25" class="blob-code blob-code-inner js-file-line">        <span class=pl-c1>filename</span>: <span class=pl-en>env</span><span class=pl-kos>(</span><span class=pl-s>&quot;DATABASE_FILENAME&quot;</span><span class=pl-kos>,</span> <span class=pl-s>&quot;/tmp/data.db&quot;</span><span class=pl-kos>)</span><span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L26" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="26"></td>
          <td id="file-database-js-LC26" class="blob-code blob-code-inner js-file-line">      <span class=pl-kos>}</span><span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L27" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="27"></td>
          <td id="file-database-js-LC27" class="blob-code blob-code-inner js-file-line">      <span class=pl-c1>options</span>: <span class=pl-kos>{</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L28" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="28"></td>
          <td id="file-database-js-LC28" class="blob-code blob-code-inner js-file-line">        <span class=pl-c1>useNullAsDefault</span>: <span class=pl-c1>true</span><span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L29" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="29"></td>
          <td id="file-database-js-LC29" class="blob-code blob-code-inner js-file-line">      <span class=pl-kos>}</span><span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L30" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="30"></td>
          <td id="file-database-js-LC30" class="blob-code blob-code-inner js-file-line">    <span class=pl-kos>}</span><span class=pl-kos>;</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L31" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="31"></td>
          <td id="file-database-js-LC31" class="blob-code blob-code-inner js-file-line">  <span class=pl-kos>}</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L32" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="32"></td>
          <td id="file-database-js-LC32" class="blob-code blob-code-inner js-file-line"><span class=pl-kos>}</span><span class=pl-kos>;</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L33" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="33"></td>
          <td id="file-database-js-LC33" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="file-database-js-L34" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="34"></td>
          <td id="file-database-js-LC34" class="blob-code blob-code-inner js-file-line"><span class=pl-smi>module</span><span class=pl-kos>.</span><span class=pl-en>exports</span> <span class=pl-c1>=</span> <span class=pl-kos>(</span><span class=pl-kos>{</span> env <span class=pl-kos>}</span><span class=pl-kos>)</span> <span class=pl-c1>=&gt;</span> <span class=pl-kos>(</span><span class=pl-kos>{</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L35" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="35"></td>
          <td id="file-database-js-LC35" class="blob-code blob-code-inner js-file-line">  <span class=pl-c1>defaultConnection</span>: <span class=pl-s>&quot;default&quot;</span><span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L36" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="36"></td>
          <td id="file-database-js-LC36" class="blob-code blob-code-inner js-file-line">  <span class=pl-c1>connections</span>: <span class=pl-kos>{</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L37" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="37"></td>
          <td id="file-database-js-LC37" class="blob-code blob-code-inner js-file-line">    <span class=pl-c1>default</span>: <span class=pl-en>getDatabaseConfig</span><span class=pl-kos>(</span><span class=pl-kos>{</span> env <span class=pl-kos>}</span><span class=pl-kos>)</span><span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L38" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="38"></td>
          <td id="file-database-js-LC38" class="blob-code blob-code-inner js-file-line">  <span class=pl-kos>}</span><span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L39" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="39"></td>
          <td id="file-database-js-LC39" class="blob-code blob-code-inner js-file-line"><span class=pl-kos>}</span><span class=pl-kos>)</span><span class=pl-kos>;</span></td>
        </tr>
  </table>
</div>


    </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/viktorfa/da283a1381aaa6db8e7e89570ec5b08f/raw/59cc1ee26e8685341d5567c64e22df5f87b4e90a/database.js" style="float:right" class="Link--inTextBlock">view raw</a>
        <a href="https://gist.github.com/viktorfa/da283a1381aaa6db8e7e89570ec5b08f#file-database-js" class="Link--inTextBlock">
          database.js
        </a>
        hosted with &#10084; by <a class="Link--inTextBlock" href="https://github.com">GitHub</a>
      </div>
    </div>
</div>
</div><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-232d920b3dfe.css" type="text/css"></div><!--]--><!--]--><p data-v-f4c85dbd><!--[-->It should now be possible to run Strapi as a Serverless app. Test it locally by executing<!--]--></p><div class="highlight-bash prose-code" meta data-v-ef0b30fc><!----><!--[--><pre class="language-bash shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0">sls</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> offline
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-ef0b30fc data-v-2c5d870f><span class="sr-only" data-v-2c5d870f>Copy to clipboard</span><span class="icon-wrapper" data-v-2c5d870f><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-2c5d870f style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-5f091540><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8Zm-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-f4c85dbd><!--[-->This will start the serverless-offline server, but Strapi won&#39;t start until you visit an endpoint. Go to <code class="" data-v-69006e27><!--[-->http://localhost:3000/dev/pages<!--]--></code>. If you get a <code class="" data-v-69006e27><!--[-->200 OK<!--]--></code> with the one page you created before, everything works as it should. The first response might be a bit slow, as the Strapi server takes some time to boot, but subsequent requests will be fast.<!--]--></p><p data-v-f4c85dbd><!--[-->Serverless will add a <code class="" data-v-69006e27><!--[-->/dev<!--]--></code> prefix to your URL path, and we need to configure Strapi to work around this later. This is a feature of API Gateway, and not easy to get around without using a custom domain.<!--]--></p><p data-v-f4c85dbd><!--[--><img style="aspect-ratio:630/610;" src="/posts/serverless-strapi-tutorial/Untitled_4.png" alt="Untitled 4.png" data-v-80d56572><!--]--></p><p data-v-f4c85dbd><!--[-->Now that we have it working locally, maybe we should try to deploy it to the cloud just to see that everything works as it should there too. Let Serverless deploy it with:<!--]--></p><div class="highlight-bash prose-code" meta data-v-ef0b30fc><!----><!--[--><pre class="language-bash shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0">sls</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> deploy</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF"> --verbose
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-ef0b30fc data-v-2c5d870f><span class="sr-only" data-v-2c5d870f>Copy to clipboard</span><span class="icon-wrapper" data-v-2c5d870f><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-2c5d870f style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-5f091540><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8Zm-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-f4c85dbd><!--[--><img style="aspect-ratio:955/612;" src="/posts/serverless-strapi-tutorial/Untitled_5.png" alt="Untitled 5.png" data-v-80d56572><!--]--></p><p data-v-f4c85dbd><!--[-->That did not work. The size of our application is way too large for Lambda. This is a common problem when attempting to run applications that are not at all designed for Lambda, in Lambda.<!--]--></p><p data-v-f4c85dbd><!--[-->Fortunately, it is quite easy to divide the Strapi monolith into a frontend and backend. Our plan is to host the frontend as a static website (which can practically be hosted anywhere), and the backend as a Serverless app in AWS Lambda.<!--]--></p><h3 id="trimming-strapi" data-v-4af47174><a aria-current="page" href="/posts/serverless-strapi-tutorial/#trimming-strapi" class="router-link-active router-link-exact-active" data-v-4af47174><!--[-->Trimming Strapi<!--]--><!----></a></h3><p data-v-f4c85dbd><!--[-->First, let&#39;s follow the <a href="https://strapi.io/documentation/v3.x/admin-panel/deploy.html#deploy-the-administration-panel-on-another-server-aws-s3-azure-etc-than-the-api" rel="nofollow" data-v-d83694f9><!--[-->official guide<!--]--></a> for running the admin part of Strapi separately, with some (maybe dirty) tricks to make it work well with our <code class="" data-v-69006e27><!--[-->/dev<!--]--></code> path prefix.<!--]--></p><p data-v-f4c85dbd><!--[-->Edit the config of <code class="" data-v-69006e27><!--[-->config/server.js<!--]--></code> to disable the admin panel, and take care of the path prefix.<!--]--></p><!--[--><!--[--><div nuxt-ssr-component-uid="cea71ed0-8795-491e-8024-6a44140cdf1d"><div><div id="gist104845329" class="gist">
    <div class="gist-file" translate="no">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-server-js" class="file my-2">
    
    <div itemprop="text" class="Box-body p-0 blob-wrapper data type-javascript  ">

        
<div class="js-check-bidi js-blob-code-container blob-code-content">

  <template class="js-file-alert-template">
  <div data-view-component="true" class="flash flash-warn flash-full d-flex flex-items-center">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
    <span>
      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
      <a class="Link--inTextBlock" href="https://github.co/hiddenchars" target="_blank">Learn more about bidirectional Unicode characters</a>
    </span>


  <div data-view-component="true" class="flash-action">        <a href="#" data-view-component="true" class="btn-sm btn">    Show hidden characters
</a>
</div>
</div></template>
<template class="js-line-alert-template">
  <span aria-label="This line has hidden Unicode characters" data-view-component="true" class="line-alert tooltipped tooltipped-e">
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
</span></template>

  <table data-hpc class="highlight tab-size js-file-line-container js-code-nav-container js-tagsearch-file" data-tab-size="8" data-paste-markdown-skip data-tagsearch-lang="JavaScript" data-tagsearch-path="server.js">
        <tr>
          <td id="file-server-js-L1" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1"></td>
          <td id="file-server-js-LC1" class="blob-code blob-code-inner js-file-line"><span class=pl-c>// config/server.js</span></td>
        </tr>
        <tr>
          <td id="file-server-js-L2" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2"></td>
          <td id="file-server-js-LC2" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="file-server-js-L3" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3"></td>
          <td id="file-server-js-LC3" class="blob-code blob-code-inner js-file-line"><span class=pl-c>// This config is used both in `strapi build` and `strapi start`.</span></td>
        </tr>
        <tr>
          <td id="file-server-js-L4" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4"></td>
          <td id="file-server-js-LC4" class="blob-code blob-code-inner js-file-line"><span class=pl-c>// So if we have a path prefix to the api, such as /dev or /v1,</span></td>
        </tr>
        <tr>
          <td id="file-server-js-L5" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="5"></td>
          <td id="file-server-js-LC5" class="blob-code blob-code-inner js-file-line"><span class=pl-c>// we need to use env variables to configure, as Strapi doesn&#39;t</span></td>
        </tr>
        <tr>
          <td id="file-server-js-L6" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="6"></td>
          <td id="file-server-js-LC6" class="blob-code blob-code-inner js-file-line"><span class=pl-c>// support path prefixes automagically.</span></td>
        </tr>
        <tr>
          <td id="file-server-js-L7" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="7"></td>
          <td id="file-server-js-LC7" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="file-server-js-L8" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="8"></td>
          <td id="file-server-js-LC8" class="blob-code blob-code-inner js-file-line"><span class=pl-smi>module</span><span class=pl-kos>.</span><span class=pl-en>exports</span> <span class=pl-c1>=</span> <span class=pl-kos>(</span><span class=pl-kos>{</span> env <span class=pl-kos>}</span><span class=pl-kos>)</span> <span class=pl-c1>=&gt;</span> <span class=pl-kos>{</span></td>
        </tr>
        <tr>
          <td id="file-server-js-L9" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="9"></td>
          <td id="file-server-js-LC9" class="blob-code blob-code-inner js-file-line">  <span class=pl-k>let</span> <span class=pl-s1>url</span> <span class=pl-c1>=</span> <span class=pl-s>&quot;&lt;Insert Lambda endpoint url here after deploy.&gt;&quot;</span><span class=pl-kos>;</span></td>
        </tr>
        <tr>
          <td id="file-server-js-L10" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="10"></td>
          <td id="file-server-js-LC10" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="file-server-js-L11" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="11"></td>
          <td id="file-server-js-LC11" class="blob-code blob-code-inner js-file-line">  <span class=pl-c>// Check if running in serverless-offline</span></td>
        </tr>
        <tr>
          <td id="file-server-js-L12" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="12"></td>
          <td id="file-server-js-LC12" class="blob-code blob-code-inner js-file-line">  <span class=pl-k>if</span> <span class=pl-kos>(</span><span class=pl-en>env</span><span class=pl-kos>(</span><span class=pl-s>&quot;IS_OFFLINE&quot;</span><span class=pl-kos>,</span> <span class=pl-c1>null</span><span class=pl-kos>)</span> <span class=pl-c1>===</span> <span class=pl-s>&quot;true&quot;</span><span class=pl-kos>)</span> <span class=pl-kos>{</span></td>
        </tr>
        <tr>
          <td id="file-server-js-L13" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="13"></td>
          <td id="file-server-js-LC13" class="blob-code blob-code-inner js-file-line">    <span class=pl-s1>url</span> <span class=pl-c1>=</span> <span class=pl-s>&quot;http://localhost:3000/dev&quot;</span><span class=pl-kos>;</span></td>
        </tr>
        <tr>
          <td id="file-server-js-L14" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="14"></td>
          <td id="file-server-js-LC14" class="blob-code blob-code-inner js-file-line">  <span class=pl-kos>}</span></td>
        </tr>
        <tr>
          <td id="file-server-js-L15" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="15"></td>
          <td id="file-server-js-LC15" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="file-server-js-L16" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="16"></td>
          <td id="file-server-js-LC16" class="blob-code blob-code-inner js-file-line">  <span class=pl-k>return</span> <span class=pl-kos>{</span></td>
        </tr>
        <tr>
          <td id="file-server-js-L17" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="17"></td>
          <td id="file-server-js-LC17" class="blob-code blob-code-inner js-file-line">    <span class=pl-c1>host</span>: <span class=pl-en>env</span><span class=pl-kos>(</span><span class=pl-s>&quot;HOST&quot;</span><span class=pl-kos>,</span> <span class=pl-s>&quot;0.0.0.0&quot;</span><span class=pl-kos>)</span><span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-server-js-L18" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="18"></td>
          <td id="file-server-js-LC18" class="blob-code blob-code-inner js-file-line">    <span class=pl-c1>port</span>: <span class=pl-s1>env</span><span class=pl-kos>.</span><span class=pl-en>int</span><span class=pl-kos>(</span><span class=pl-s>&quot;PORT&quot;</span><span class=pl-kos>,</span> <span class=pl-c1>1337</span><span class=pl-kos>)</span><span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-server-js-L19" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="19"></td>
          <td id="file-server-js-LC19" class="blob-code blob-code-inner js-file-line">    url<span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-server-js-L20" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="20"></td>
          <td id="file-server-js-LC20" class="blob-code blob-code-inner js-file-line">    <span class=pl-c1>admin</span>: <span class=pl-kos>{</span></td>
        </tr>
        <tr>
          <td id="file-server-js-L21" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="21"></td>
          <td id="file-server-js-LC21" class="blob-code blob-code-inner js-file-line">      <span class=pl-c1>serveAdminPanel</span>: <span class=pl-c1>false</span><span class=pl-kos>,</span> <span class=pl-c>// No admin panel</span></td>
        </tr>
        <tr>
          <td id="file-server-js-L22" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="22"></td>
          <td id="file-server-js-LC22" class="blob-code blob-code-inner js-file-line">      <span class=pl-c1>autoOpen</span>: <span class=pl-c1>false</span><span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-server-js-L23" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="23"></td>
          <td id="file-server-js-LC23" class="blob-code blob-code-inner js-file-line">      <span class=pl-c1>url</span>: <span class=pl-s>&quot;/&quot;</span><span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-server-js-L24" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="24"></td>
          <td id="file-server-js-LC24" class="blob-code blob-code-inner js-file-line">      <span class=pl-c1>auth</span>: <span class=pl-kos>{</span></td>
        </tr>
        <tr>
          <td id="file-server-js-L25" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="25"></td>
          <td id="file-server-js-LC25" class="blob-code blob-code-inner js-file-line">        <span class=pl-c1>secret</span>: <span class=pl-en>env</span><span class=pl-kos>(</span><span class=pl-s>&quot;ADMIN_JWT_SECRET&quot;</span><span class=pl-kos>,</span> <span class=pl-s>&quot;Insert random string as env variable in production&quot;</span><span class=pl-kos>)</span><span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-server-js-L26" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="26"></td>
          <td id="file-server-js-LC26" class="blob-code blob-code-inner js-file-line">      <span class=pl-kos>}</span><span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-server-js-L27" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="27"></td>
          <td id="file-server-js-LC27" class="blob-code blob-code-inner js-file-line">    <span class=pl-kos>}</span><span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-server-js-L28" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="28"></td>
          <td id="file-server-js-LC28" class="blob-code blob-code-inner js-file-line">  <span class=pl-kos>}</span><span class=pl-kos>;</span></td>
        </tr>
        <tr>
          <td id="file-server-js-L29" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="29"></td>
          <td id="file-server-js-LC29" class="blob-code blob-code-inner js-file-line"><span class=pl-kos>}</span><span class=pl-kos>;</span></td>
        </tr>
  </table>
</div>


    </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/viktorfa/23847bd9f9926872f860455329b0153e/raw/b2beb36b1f6f409143dc51079ebcf39a59d07587/server.js" style="float:right" class="Link--inTextBlock">view raw</a>
        <a href="https://gist.github.com/viktorfa/23847bd9f9926872f860455329b0153e#file-server-js" class="Link--inTextBlock">
          server.js
        </a>
        hosted with &#10084; by <a class="Link--inTextBlock" href="https://github.com">GitHub</a>
      </div>
    </div>
</div>
</div><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-232d920b3dfe.css" type="text/css"></div><!--]--><!--]--><p data-v-f4c85dbd><!--[-->We will also edit the build command in <code class="" data-v-69006e27><!--[-->package.json<!--]--></code> to run a bash script after the normal build.<!--]--></p><div class="highlight-json prose-code" meta data-v-ef0b30fc><!----><!--[--><pre class="language-json shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#6A737D;--shiki-dark:#6A737D">// package.json
</span></span><span class="line" line="2"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">{
</span></span><span class="line" line="3"><span style="--shiki-default:#B31D28;--shiki-dark:#FDAEB7;--shiki-default-font-style:italic;--shiki-dark-font-style:italic">    ...
</span></span><span class="line" line="4"><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF">    &quot;build&quot;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF">&quot;strapi build &amp;&amp; ./scripts/post-build.sh&quot;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">,
</span></span><span class="line" line="5"><span style="--shiki-default:#B31D28;--shiki-dark:#FDAEB7;--shiki-default-font-style:italic;--shiki-dark-font-style:italic">    ...
</span></span><span class="line" line="6"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">}
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-ef0b30fc data-v-2c5d870f><span class="sr-only" data-v-2c5d870f>Copy to clipboard</span><span class="icon-wrapper" data-v-2c5d870f><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-2c5d870f style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-5f091540><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8Zm-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-f4c85dbd><!--[-->Create a script called <a href="http://post-build.sh" rel="nofollow" data-v-d83694f9><!--[--><code class="" data-v-69006e27><!--[-->post-build.sh<!--]--></code><!--]--></a> in a new folder called <code class="" data-v-69006e27><!--[-->scripts/<!--]--></code>. Make it executable with:<!--]--></p><div class="highlight-bash prose-code" meta data-v-ef0b30fc><!----><!--[--><pre class="language-bash shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0">chmod</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> +x</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> scripts/post-build.sh
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-ef0b30fc data-v-2c5d870f><span class="sr-only" data-v-2c5d870f>Copy to clipboard</span><span class="icon-wrapper" data-v-2c5d870f><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-2c5d870f style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-5f091540><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8Zm-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><!--[--><!--[--><div nuxt-ssr-component-uid="cc3a80cc-46e1-46b5-bb23-d35f7a2761fd"><div><div id="gist104845785" class="gist">
    <div class="gist-file" translate="no">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-post-build-sh" class="file my-2">
    
    <div itemprop="text" class="Box-body p-0 blob-wrapper data type-shell  ">

        
<div class="js-check-bidi js-blob-code-container blob-code-content">

  <template class="js-file-alert-template">
  <div data-view-component="true" class="flash flash-warn flash-full d-flex flex-items-center">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
    <span>
      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
      <a class="Link--inTextBlock" href="https://github.co/hiddenchars" target="_blank">Learn more about bidirectional Unicode characters</a>
    </span>


  <div data-view-component="true" class="flash-action">        <a href="#" data-view-component="true" class="btn-sm btn">    Show hidden characters
</a>
</div>
</div></template>
<template class="js-line-alert-template">
  <span aria-label="This line has hidden Unicode characters" data-view-component="true" class="line-alert tooltipped tooltipped-e">
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
</span></template>

  <table data-hpc class="highlight tab-size js-file-line-container js-code-nav-container js-tagsearch-file" data-tab-size="8" data-paste-markdown-skip data-tagsearch-lang="Shell" data-tagsearch-path="post-build.sh">
        <tr>
          <td id="file-post-build-sh-L1" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1"></td>
          <td id="file-post-build-sh-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#</span> scripts/post-build.sh</span></td>
        </tr>
        <tr>
          <td id="file-post-build-sh-L2" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2"></td>
          <td id="file-post-build-sh-LC2" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="file-post-build-sh-L3" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3"></td>
          <td id="file-post-build-sh-LC3" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#!</span>/bin/bash</span></td>
        </tr>
        <tr>
          <td id="file-post-build-sh-L4" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4"></td>
          <td id="file-post-build-sh-LC4" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="file-post-build-sh-L5" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="5"></td>
          <td id="file-post-build-sh-LC5" class="blob-code blob-code-inner js-file-line"><span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">&quot;</span>post-build.sh  moving assets of frontend build to dev/ folder.<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="file-post-build-sh-L6" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="6"></td>
          <td id="file-post-build-sh-LC6" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="file-post-build-sh-L7" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="7"></td>
          <td id="file-post-build-sh-LC7" class="blob-code blob-code-inner js-file-line">mkdir <span class="pl-smi">$PWD</span>/build/dev</td>
        </tr>
        <tr>
          <td id="file-post-build-sh-L8" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="8"></td>
          <td id="file-post-build-sh-LC8" class="blob-code blob-code-inner js-file-line">find <span class="pl-smi">$PWD</span>/build/ -type f -print0 <span class="pl-k">|</span> xargs -0 mv -t <span class="pl-smi">$PWD</span>/build/dev</td>
        </tr>
        <tr>
          <td id="file-post-build-sh-L9" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="9"></td>
          <td id="file-post-build-sh-LC9" class="blob-code blob-code-inner js-file-line">mv <span class="pl-smi">$PWD</span>/build/dev/index.html <span class="pl-smi">$PWD</span>/build</td>
        </tr>
  </table>
</div>


    </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/viktorfa/4d0d3e1d9f6f317d7037bcead27f28c0/raw/10804ea8db409c90ad6259ac804d3b8720a24d22/post-build.sh" style="float:right" class="Link--inTextBlock">view raw</a>
        <a href="https://gist.github.com/viktorfa/4d0d3e1d9f6f317d7037bcead27f28c0#file-post-build-sh" class="Link--inTextBlock">
          post-build.sh
        </a>
        hosted with &#10084; by <a class="Link--inTextBlock" href="https://github.com">GitHub</a>
      </div>
    </div>
</div>
</div><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-232d920b3dfe.css" type="text/css"></div><!--]--><!--]--><p data-v-f4c85dbd><!--[-->The script simply moves the bundle files in <code class="" data-v-69006e27><!--[-->build/<!--]--></code> to a sub folder called <code class="" data-v-69006e27><!--[-->/dev<!--]--></code> which fixes the issue with our path prefixes.<!--]--></p><p data-v-f4c85dbd><!--[-->Build the admin panel with:<!--]--></p><div class="highlight-bash prose-code" meta data-v-ef0b30fc><!----><!--[--><pre class="language-bash shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">IS_OFFLINE</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF">true</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0"> yarn</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> build
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-ef0b30fc data-v-2c5d870f><span class="sr-only" data-v-2c5d870f>Copy to clipboard</span><span class="icon-wrapper" data-v-2c5d870f><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-2c5d870f style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-5f091540><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8Zm-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-f4c85dbd><!--[--><img style="aspect-ratio:468/171;" src="/posts/serverless-strapi-tutorial/Untitled_6.png" alt="Untitled 6.png" data-v-80d56572><!--]--></p><p data-v-f4c85dbd><!--[-->Verify that the current setup works by starting the serverless-offline app with <code class="" data-v-69006e27><!--[-->sls offline<!--]--></code>, and then serve the frontend as a separate static site.<!--]--></p><p data-v-f4c85dbd><!--[-->You can serve the frontend with<!--]--></p><div class="highlight-bash prose-code" meta data-v-ef0b30fc><!----><!--[--><pre class="language-bash shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0">npm</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> i</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF"> -g</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> serve
</span></span><span class="line" line="2"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0">serve</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> build/
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-ef0b30fc data-v-2c5d870f><span class="sr-only" data-v-2c5d870f>Copy to clipboard</span><span class="icon-wrapper" data-v-2c5d870f><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-2c5d870f style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-5f091540><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8Zm-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-f4c85dbd><!--[--><img style="aspect-ratio:947/335;" src="/posts/serverless-strapi-tutorial/Untitled_7.png" alt="Untitled 7.png" data-v-80d56572><!--]--></p><p data-v-f4c85dbd><!--[-->Go to <code class="" data-v-69006e27><!--[-->http://localhost:5000<!--]--></code> and check that Strapi still works. Remember to run sls offline in the background.<!--]--></p><p data-v-f4c85dbd><!--[-->It may be boring to move slowly and double check everything. One thing I&#39;ve learnt using Serverless and AWS Lambda is that you will spend hours debugging the most trivial things and cryptic error messages if you don&#39;t double check and isolate everything at every step.<!--]--></p><p data-v-f4c85dbd><!--[-->If you can still use the Strapi admin, everything is going well.<!--]--></p><p data-v-f4c85dbd><!--[-->The size of our code is still not small enough to be used in Lambda, so we need to trim more. Let&#39;s explore <code class="" data-v-69006e27><!--[-->node_modules<!--]--></code>.<!--]--></p><p data-v-f4c85dbd><!--[--><img style="aspect-ratio:956/645;" src="/posts/serverless-strapi-tutorial/Untitled_8.png" alt="Untitled 8.png" data-v-80d56572><!--]--></p><p data-v-f4c85dbd><!--[-->We see <code class="" data-v-69006e27><!--[-->node_modules<!--]--></code> is a whopping 561 MB. We also see a lot of fat packages that are definitely only for frontend use, such as those containing &quot;react&quot;, &quot;fortawesome&quot;, or &quot;bootstrap&quot;. We also see that some locale-data, which is just translations, use most space of all.<!--]--></p><p data-v-f4c85dbd><!--[-->It would be great if Strapi automagically removed all frontend stuff from <code class="" data-v-69006e27><!--[-->node_modules<!--]--></code> when we run the backend on a separate server, but I don&#39;t know of any such functionality. We will therefore manually delete some excessive packages with some simple commands we put in a bash script aptly called <a href="http://trim-node-modules.sh/" rel="nofollow" data-v-d83694f9><!--[--><code class="" data-v-69006e27><!--[-->trim-node-modules.sh<!--]--></code><!--]--></a>.<!--]--></p><!--[--><!--[--><div nuxt-ssr-component-uid="b9d94888-2bc5-4ebe-95f7-98f89f37a078"><div><div id="gist104845941" class="gist">
    <div class="gist-file" translate="no">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-trim-node-modules-sh" class="file my-2">
    
    <div itemprop="text" class="Box-body p-0 blob-wrapper data type-shell  ">

        
<div class="js-check-bidi js-blob-code-container blob-code-content">

  <template class="js-file-alert-template">
  <div data-view-component="true" class="flash flash-warn flash-full d-flex flex-items-center">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
    <span>
      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
      <a class="Link--inTextBlock" href="https://github.co/hiddenchars" target="_blank">Learn more about bidirectional Unicode characters</a>
    </span>


  <div data-view-component="true" class="flash-action">        <a href="#" data-view-component="true" class="btn-sm btn">    Show hidden characters
</a>
</div>
</div></template>
<template class="js-line-alert-template">
  <span aria-label="This line has hidden Unicode characters" data-view-component="true" class="line-alert tooltipped tooltipped-e">
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
</span></template>

  <table data-hpc class="highlight tab-size js-file-line-container js-code-nav-container js-tagsearch-file" data-tab-size="8" data-paste-markdown-skip data-tagsearch-lang="Shell" data-tagsearch-path="trim-node-modules.sh">
        <tr>
          <td id="file-trim-node-modules-sh-L1" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1"></td>
          <td id="file-trim-node-modules-sh-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#</span> scripts/trim-node-modules.sh</span></td>
        </tr>
        <tr>
          <td id="file-trim-node-modules-sh-L2" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2"></td>
          <td id="file-trim-node-modules-sh-LC2" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="file-trim-node-modules-sh-L3" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3"></td>
          <td id="file-trim-node-modules-sh-LC3" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#!</span>/bin/bash</span></td>
        </tr>
        <tr>
          <td id="file-trim-node-modules-sh-L4" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4"></td>
          <td id="file-trim-node-modules-sh-LC4" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="file-trim-node-modules-sh-L5" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="5"></td>
          <td id="file-trim-node-modules-sh-LC5" class="blob-code blob-code-inner js-file-line"><span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">&quot;</span>trim-node-modules.sh<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="file-trim-node-modules-sh-L6" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="6"></td>
          <td id="file-trim-node-modules-sh-LC6" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="file-trim-node-modules-sh-L7" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="7"></td>
          <td id="file-trim-node-modules-sh-LC7" class="blob-code blob-code-inner js-file-line">du -hs node_modules/</td>
        </tr>
        <tr>
          <td id="file-trim-node-modules-sh-L8" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="8"></td>
          <td id="file-trim-node-modules-sh-LC8" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="file-trim-node-modules-sh-L9" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="9"></td>
          <td id="file-trim-node-modules-sh-LC9" class="blob-code blob-code-inner js-file-line">node-prune <span class="pl-c"><span class="pl-c">#</span> https://github.com/tj/node-prune</span></td>
        </tr>
        <tr>
          <td id="file-trim-node-modules-sh-L10" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="10"></td>
          <td id="file-trim-node-modules-sh-LC10" class="blob-code blob-code-inner js-file-line">find <span class="pl-smi">$PWD</span>/node_modules -maxdepth 1 -type d -name <span class="pl-s"><span class="pl-pds">&quot;</span>*react*<span class="pl-pds">&quot;</span></span> -exec rm -rf {} +</td>
        </tr>
        <tr>
          <td id="file-trim-node-modules-sh-L11" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="11"></td>
          <td id="file-trim-node-modules-sh-LC11" class="blob-code blob-code-inner js-file-line">find <span class="pl-smi">$PWD</span>/node_modules -type d -name <span class="pl-s"><span class="pl-pds">&quot;</span>locale-data<span class="pl-pds">&quot;</span></span> -exec rm -rf {} +</td>
        </tr>
        <tr>
          <td id="file-trim-node-modules-sh-L12" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="12"></td>
          <td id="file-trim-node-modules-sh-LC12" class="blob-code blob-code-inner js-file-line">find <span class="pl-smi">$PWD</span>/node_modules -type d -name <span class="pl-s"><span class="pl-pds">&quot;</span>*webpack*<span class="pl-pds">&quot;</span></span> -exec rm -rf {} +</td>
        </tr>
        <tr>
          <td id="file-trim-node-modules-sh-L13" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="13"></td>
          <td id="file-trim-node-modules-sh-LC13" class="blob-code blob-code-inner js-file-line">find <span class="pl-smi">$PWD</span>/node_modules -type d -name <span class="pl-s"><span class="pl-pds">&quot;</span>*proptypes*<span class="pl-pds">&quot;</span></span> -exec rm -rf {} +</td>
        </tr>
        <tr>
          <td id="file-trim-node-modules-sh-L14" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="14"></td>
          <td id="file-trim-node-modules-sh-LC14" class="blob-code blob-code-inner js-file-line">find <span class="pl-smi">$PWD</span>/node_modules -type d -name <span class="pl-s"><span class="pl-pds">&quot;</span>*jquery*<span class="pl-pds">&quot;</span></span> -exec rm -rf {} +</td>
        </tr>
        <tr>
          <td id="file-trim-node-modules-sh-L15" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="15"></td>
          <td id="file-trim-node-modules-sh-LC15" class="blob-code blob-code-inner js-file-line">find <span class="pl-smi">$PWD</span>/node_modules -type d -name <span class="pl-s"><span class="pl-pds">&quot;</span>*bootstrap*<span class="pl-pds">&quot;</span></span> -exec rm -rf {} +</td>
        </tr>
        <tr>
          <td id="file-trim-node-modules-sh-L16" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="16"></td>
          <td id="file-trim-node-modules-sh-LC16" class="blob-code blob-code-inner js-file-line">find <span class="pl-smi">$PWD</span>/node_modules -type f -name <span class="pl-s"><span class="pl-pds">&quot;</span>*.css<span class="pl-pds">&quot;</span></span> -exec rm -rf {} +</td>
        </tr>
        <tr>
          <td id="file-trim-node-modules-sh-L17" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="17"></td>
          <td id="file-trim-node-modules-sh-LC17" class="blob-code blob-code-inner js-file-line">find <span class="pl-smi">$PWD</span>/node_modules -type f -name <span class="pl-s"><span class="pl-pds">&quot;</span>*.jsx<span class="pl-pds">&quot;</span></span> -exec rm -rf {} +</td>
        </tr>
        <tr>
          <td id="file-trim-node-modules-sh-L18" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="18"></td>
          <td id="file-trim-node-modules-sh-LC18" class="blob-code blob-code-inner js-file-line">rm -rf <span class="pl-smi">$PWD</span>/node_modules/font-awesome/ <span class="pl-smi">$PWD</span>/node_modules/styled-components/ <span class="pl-smi">$PWD</span>/node_modules/rxjs/ <span class="pl-smi">$PWD</span>/node_modules/@formatjs/ <span class="pl-smi">$PWD</span>/node_modules/codemirror/ <span class="pl-smi">$PWD</span>/node_modules/core-js/ <span class="pl-smi">$PWD</span>/node_modules/draft-js/ <span class="pl-smi">$PWD</span>/node_modules/popper.js/</td>
        </tr>
        <tr>
          <td id="file-trim-node-modules-sh-L19" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="19"></td>
          <td id="file-trim-node-modules-sh-LC19" class="blob-code blob-code-inner js-file-line">rm -rf <span class="pl-smi">$PWD</span>/node_modules/@sentry/ <span class="pl-smi">$PWD</span>/node_modules/bootstrap/ <span class="pl-smi">$PWD</span>/node_modules/@buffetjs/ <span class="pl-smi">$PWD</span>/node_modules/highlight.js/ <span class="pl-smi">$PWD</span>/node_modules/@fortawesome/</td>
        </tr>
        <tr>
          <td id="file-trim-node-modules-sh-L20" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="20"></td>
          <td id="file-trim-node-modules-sh-LC20" class="blob-code blob-code-inner js-file-line">rm -rf <span class="pl-smi">$PWD</span>/node_modules/aws-sdk</td>
        </tr>
        <tr>
          <td id="file-trim-node-modules-sh-L21" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="21"></td>
          <td id="file-trim-node-modules-sh-LC21" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="file-trim-node-modules-sh-L22" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="22"></td>
          <td id="file-trim-node-modules-sh-LC22" class="blob-code blob-code-inner js-file-line">du -hs node_modules/</td>
        </tr>
  </table>
</div>


    </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/viktorfa/972a4ea019fdd1f0861059a9299df544/raw/34a87ed44d73dd9a703ff438871138565e849588/trim-node-modules.sh" style="float:right" class="Link--inTextBlock">view raw</a>
        <a href="https://gist.github.com/viktorfa/972a4ea019fdd1f0861059a9299df544#file-trim-node-modules-sh" class="Link--inTextBlock">
          trim-node-modules.sh
        </a>
        hosted with &#10084; by <a class="Link--inTextBlock" href="https://github.com">GitHub</a>
      </div>
    </div>
</div>
</div><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-232d920b3dfe.css" type="text/css"></div><!--]--><!--]--><p data-v-f4c85dbd><!--[-->Install a neat tool called <em data-v-4353b993><!--[-->node-prune<!--]--></em> first, which automatically removes files that are certainly unnecessary, such as Readmes etc. Get it done with:<!--]--></p><div class="highlight-bash prose-code" meta data-v-ef0b30fc><!----><!--[--><pre class="language-bash shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0">npm</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> i</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF"> -g</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> node-prune
</span></span><span class="line" line="2"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0">chmod</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> +x</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> scripts/trim-node-modules.sh
</span></span><span class="line" line="3"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0">./scripts/trim-node-modules.sh
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-ef0b30fc data-v-2c5d870f><span class="sr-only" data-v-2c5d870f>Copy to clipboard</span><span class="icon-wrapper" data-v-2c5d870f><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-2c5d870f style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-5f091540><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8Zm-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-f4c85dbd><!--[-->That should reduce the size of <code class="" data-v-69006e27><!--[-->node_modules<!--]--></code> to around 287MB without losing anything we need for the backend.<!--]--></p><p data-v-f4c85dbd><!--[-->Finish this step by successfully deploying with:<!--]--></p><div class="highlight-bash prose-code" meta data-v-ef0b30fc><!----><!--[--><pre class="language-bash shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0">sls</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> deploy</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF"> --verbose
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-ef0b30fc data-v-2c5d870f><span class="sr-only" data-v-2c5d870f>Copy to clipboard</span><span class="icon-wrapper" data-v-2c5d870f><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-2c5d870f style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-5f091540><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8Zm-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-f4c85dbd><!--[--><img style="aspect-ratio:621/500;" src="/posts/serverless-strapi-tutorial/Untitled_9.png" alt="Untitled 9.png" data-v-80d56572><!--]--></p><p data-v-f4c85dbd><!--[-->Stack update finished... <!--]--></p><p data-v-f4c85dbd><!--[-->That&#39;s what we want to see. The backend is now available online, and you can check it by visiting the generated endpoint (<a href="https://7s7w7gyekl.execute-api.us-east-1.amazonaws.com/dev/" rel="nofollow" data-v-d83694f9><!--[-->https://7s7w7gyekl.execute-api.us-east-1.amazonaws.com/dev/<!--]--></a> for me).<!--]--></p><p data-v-f4c85dbd><!--[--><img style="aspect-ratio:1097/500;" src="/posts/serverless-strapi-tutorial/Untitled_10.png" alt="Untitled 10.png" data-v-80d56572><!--]--></p><p data-v-f4c85dbd><!--[-->Our database is not at all suitable for Lambda, as it&#39;s an SQLite db where the data is stored in the local filesystem which can reset between Lambda invocations. However, it should work for demonstration purposes.<!--]--></p><p data-v-f4c85dbd><!--[-->Check your logs with:<!--]--></p><div class="highlight-bash prose-code" meta data-v-ef0b30fc><!----><!--[--><pre class="language-bash shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0">sls</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> logs</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF"> --function</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> api</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF"> --tail
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-ef0b30fc data-v-2c5d870f><span class="sr-only" data-v-2c5d870f>Copy to clipboard</span><span class="icon-wrapper" data-v-2c5d870f><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-2c5d870f style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-5f091540><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8Zm-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-f4c85dbd><!--[--><img style="aspect-ratio:951/854;" src="/posts/serverless-strapi-tutorial/Untitled_11.png" alt="Untitled 11.png" data-v-80d56572><!--]--></p><p data-v-f4c85dbd><!--[-->Update <code class="" data-v-69006e27><!--[-->config/server.js<!--]--></code> with the newly generated endpoint.<!--]--></p><div class="highlight-jsx prose-code" meta data-v-ef0b30fc><!----><!--[--><pre class="language-jsx shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#6A737D;--shiki-dark:#6A737D">// config/server.js
</span></span><span class="line" line="2"><span emptylineplaceholder="true">
</span></span><span class="line" line="3"><span style="--shiki-default:#6A737D;--shiki-dark:#6A737D">// ...
</span></span><span class="line" line="4"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">let</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8"> url </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> &quot;https://7s7w7gyekl.execute-api.us-east-1.amazonaws.com&quot;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">;
</span></span><span class="line" line="5"><span style="--shiki-default:#6A737D;--shiki-dark:#6A737D">// ...
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-ef0b30fc data-v-2c5d870f><span class="sr-only" data-v-2c5d870f>Copy to clipboard</span><span class="icon-wrapper" data-v-2c5d870f><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-2c5d870f style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-5f091540><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8Zm-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-f4c85dbd><!--[-->Let&#39;s build the frontend again with the new endpoint in the config. Don&#39;t forget to delete the old build folder and reinstall the frontend packages we deleted previously.<!--]--></p><div class="highlight-bash prose-code" meta data-v-ef0b30fc><!----><!--[--><pre class="language-bash shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0">rm</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF"> -rf</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> build/
</span></span><span class="line" line="2"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0">yarn
</span></span><span class="line" line="3"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0">yarn</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> build
</span></span><span class="line" line="4"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0">serve</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> build/
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-ef0b30fc data-v-2c5d870f><span class="sr-only" data-v-2c5d870f>Copy to clipboard</span><span class="icon-wrapper" data-v-2c5d870f><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-2c5d870f style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-5f091540><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8Zm-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-f4c85dbd><!--[-->Visit <code class="" data-v-69006e27><!--[-->http://localhost:5000<!--]--></code> and make sure Strapi is working as before.<!--]--></p><h2 id="make-a-serverless-database-and-file-storage" data-v-6d609909><a aria-current="page" href="/posts/serverless-strapi-tutorial/#make-a-serverless-database-and-file-storage" class="router-link-active router-link-exact-active" data-v-6d609909><!--[-->Make a serverless database and file storage<!--]--><!----></a></h2><p data-v-f4c85dbd><!--[-->So far we have divided Strapi into two components: 1) a static website frontend and 2) a backend running on Lambda accessible through API Gateway. We will add two additional components. The backend also needs 3) a database and 4) a static file storage for images and other files we upload.<!--]--></p><p data-v-f4c85dbd><!--[-->All the components should have the serverless properties. Scalable, pay-per-use, and no touch ops. For static file storage, we will use Amazon S3 file storage, which is not only highly appropriate for the task, but Strapi also comes with a plugin for S3.<!--]--></p><p data-v-f4c85dbd><!--[-->The database is more tricky. It&#39;s possible to create a DynamoDB connector to Strapi, but that would limit the index flexibility of Strapi, and remove full text search. Let&#39;s consider the options.<!--]--></p><p data-v-f4c85dbd><!--[--><a href="https://www.notion.so/6fefceebc6414fec8b6939e7030d409d" rel="nofollow" data-v-d83694f9><!--[-->Databases for Strapi Serverless<!--]--></a><!--]--></p><p data-v-f4c85dbd><!--[-->DynamoDB does not work with Strapi without a connector we would have to create ourselves.<!--]--></p><p data-v-f4c85dbd><!--[-->Aurora is a managed relational database offered by Amazon. It is compatible with PostgreSQL or MySQL. It has a &quot;serverless&quot; configuration setting which enables sleep when inactive and auto scaling. The AWS managed databases like Aurora are only available within a Virtual Private Cloud (VPC). Having our Lambda function in the same VPC means it loses internet access without further configuration and costs, so we won&#39;t use that option in this tutorial.<!--]--></p><p data-v-f4c85dbd><!--[-->We can use an external database such as Mongo hosted with <a href="https://www.mongodb.com/cloud/atlas" rel="nofollow" data-v-d83694f9><!--[-->Mongo Atlas<!--]--></a>. It is not serverless, but it is managed and possible to scale by just upgrading a subscription. You can also host your own SQL or Mongo instance either in the Amazon cloud or somewhere else.<!--]--></p><p data-v-f4c85dbd><!--[-->We don&#39;t have a perfect database option for all uses cases. If you use Strapi as a CMS or static sites, the database performance is not a priority at all, so we choose something that is easy to set up and has a free offering. This tutorial will show how to use Mongo Atlas.<!--]--></p><h3 id="set-up-mongo" data-v-4af47174><a aria-current="page" href="/posts/serverless-strapi-tutorial/#set-up-mongo" class="router-link-active router-link-exact-active" data-v-4af47174><!--[-->Set up Mongo<!--]--><!----></a></h3><p data-v-f4c85dbd><!--[-->Just <a href="https://www.mongodb.com/cloud/atlas/register" rel="nofollow" data-v-d83694f9><!--[-->create an account<!--]--></a> and set up a free Mongo cluster in Atlas for the purpose of this tutorial. You must create a database user with a username and password, then get the connection URI and insert it as an environment variable to our Lambda function.<!--]--></p><p data-v-f4c85dbd><!--[--><img style="aspect-ratio:923/262;" src="/posts/serverless-strapi-tutorial/Untitled_12.png" alt="Untitled 12.png" data-v-80d56572><!--]--></p><p data-v-f4c85dbd><!--[-->Get the connection URI string in Cluster &gt; Connect &gt; Connect your application.<!--]--></p><p data-v-f4c85dbd><!--[--><img style="aspect-ratio:887/666;" src="/posts/serverless-strapi-tutorial/Untitled_13.png" alt="Untitled 13.png" data-v-80d56572><!--]--></p><p data-v-f4c85dbd><!--[-->Add the connection URI as an environment variable.<!--]--></p><div class="highlight-bash prose-code" meta data-v-ef0b30fc><!----><!--[--><pre class="language-bash shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#6A737D;--shiki-dark:#6A737D"># serverless.yml
</span></span><span class="line" line="2"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0">provider:
</span></span><span class="line" line="3"><span style="--shiki-default:#6A737D;--shiki-dark:#6A737D">    # ...
</span></span><span class="line" line="4"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0">    environment:
</span></span><span class="line" line="5"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0">        MONGODB_URI</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> &quot;mongodb+srv://strapiowner:PASSWORD@cluster0.weldo.mongodb.net/strapi?retryWrites=true&amp;w=majority&quot;
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-ef0b30fc data-v-2c5d870f><span class="sr-only" data-v-2c5d870f>Copy to clipboard</span><span class="icon-wrapper" data-v-2c5d870f><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-2c5d870f style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-5f091540><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8Zm-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-f4c85dbd><!--[-->We then edit <code class="" data-v-69006e27><!--[-->config/database.js<!--]--></code> to tell Strapi to use the Mongo database.<!--]--></p><!--[--><!--[--><div nuxt-ssr-component-uid="b4fc5286-cb84-4e35-85da-396d57067c7f"><div><div id="gist104880968" class="gist">
    <div class="gist-file" translate="no">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-database-js" class="file my-2">
    
    <div itemprop="text" class="Box-body p-0 blob-wrapper data type-javascript  ">

        
<div class="js-check-bidi js-blob-code-container blob-code-content">

  <template class="js-file-alert-template">
  <div data-view-component="true" class="flash flash-warn flash-full d-flex flex-items-center">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
    <span>
      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
      <a class="Link--inTextBlock" href="https://github.co/hiddenchars" target="_blank">Learn more about bidirectional Unicode characters</a>
    </span>


  <div data-view-component="true" class="flash-action">        <a href="#" data-view-component="true" class="btn-sm btn">    Show hidden characters
</a>
</div>
</div></template>
<template class="js-line-alert-template">
  <span aria-label="This line has hidden Unicode characters" data-view-component="true" class="line-alert tooltipped tooltipped-e">
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
</span></template>

  <table data-hpc class="highlight tab-size js-file-line-container js-code-nav-container js-tagsearch-file" data-tab-size="8" data-paste-markdown-skip data-tagsearch-lang="JavaScript" data-tagsearch-path="database.js">
        <tr>
          <td id="file-database-js-L1" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1"></td>
          <td id="file-database-js-LC1" class="blob-code blob-code-inner js-file-line"><span class=pl-c>// config/database.js</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L2" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2"></td>
          <td id="file-database-js-LC2" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="file-database-js-L3" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3"></td>
          <td id="file-database-js-LC3" class="blob-code blob-code-inner js-file-line"><span class=pl-k>const</span> <span class=pl-en>getDatabaseConfig</span> <span class=pl-c1>=</span> <span class=pl-kos>(</span><span class=pl-kos>{</span> env <span class=pl-kos>}</span><span class=pl-kos>)</span> <span class=pl-c1>=&gt;</span> <span class=pl-kos>{</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L4" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4"></td>
          <td id="file-database-js-LC4" class="blob-code blob-code-inner js-file-line">  <span class=pl-k>if</span> <span class=pl-kos>(</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L5" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="5"></td>
          <td id="file-database-js-LC5" class="blob-code blob-code-inner js-file-line">    <span class=pl-en>env</span><span class=pl-kos>(</span><span class=pl-s>&quot;IS_OFFLINE&quot;</span><span class=pl-kos>,</span> <span class=pl-c1>null</span><span class=pl-kos>)</span> <span class=pl-c1>===</span> <span class=pl-s>&quot;true&quot;</span> <span class=pl-c1>||</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L6" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="6"></td>
          <td id="file-database-js-LC6" class="blob-code blob-code-inner js-file-line">    <span class=pl-en>env</span><span class=pl-kos>(</span><span class=pl-s>&quot;LAMBDA_RUNTIME_DIR&quot;</span><span class=pl-kos>,</span> <span class=pl-c1>null</span><span class=pl-kos>)</span> <span class=pl-c1>===</span> <span class=pl-c1>null</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L7" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="7"></td>
          <td id="file-database-js-LC7" class="blob-code blob-code-inner js-file-line">  <span class=pl-kos>)</span> <span class=pl-kos>{</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L8" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="8"></td>
          <td id="file-database-js-LC8" class="blob-code blob-code-inner js-file-line">    <span class=pl-c>// In local simulated Lambda or normal Strapi</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L9" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="9"></td>
          <td id="file-database-js-LC9" class="blob-code blob-code-inner js-file-line">    <span class=pl-k>return</span> <span class=pl-kos>{</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L10" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="10"></td>
          <td id="file-database-js-LC10" class="blob-code blob-code-inner js-file-line">      <span class=pl-c1>connector</span>: <span class=pl-s>&quot;mongoose&quot;</span><span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L11" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="11"></td>
          <td id="file-database-js-LC11" class="blob-code blob-code-inner js-file-line">      <span class=pl-c1>settings</span>: <span class=pl-kos>{</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L12" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="12"></td>
          <td id="file-database-js-LC12" class="blob-code blob-code-inner js-file-line">        <span class=pl-c1>uri</span>: <span class=pl-en>env</span><span class=pl-kos>(</span><span class=pl-s>&quot;MONGODB_URI&quot;</span><span class=pl-kos>)</span><span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L13" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="13"></td>
          <td id="file-database-js-LC13" class="blob-code blob-code-inner js-file-line">      <span class=pl-kos>}</span><span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L14" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="14"></td>
          <td id="file-database-js-LC14" class="blob-code blob-code-inner js-file-line">      <span class=pl-c1>options</span>: <span class=pl-kos>{</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L15" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="15"></td>
          <td id="file-database-js-LC15" class="blob-code blob-code-inner js-file-line">        <span class=pl-c1>ssl</span>: <span class=pl-c1>true</span><span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L16" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="16"></td>
          <td id="file-database-js-LC16" class="blob-code blob-code-inner js-file-line">      <span class=pl-kos>}</span><span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L17" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="17"></td>
          <td id="file-database-js-LC17" class="blob-code blob-code-inner js-file-line">    <span class=pl-kos>}</span><span class=pl-kos>;</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L18" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="18"></td>
          <td id="file-database-js-LC18" class="blob-code blob-code-inner js-file-line">  <span class=pl-kos>}</span> <span class=pl-k>else</span> <span class=pl-kos>{</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L19" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="19"></td>
          <td id="file-database-js-LC19" class="blob-code blob-code-inner js-file-line">    <span class=pl-c>// In Lambda on AWS</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L20" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="20"></td>
          <td id="file-database-js-LC20" class="blob-code blob-code-inner js-file-line">    <span class=pl-k>return</span> <span class=pl-kos>{</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L21" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="21"></td>
          <td id="file-database-js-LC21" class="blob-code blob-code-inner js-file-line">      <span class=pl-c1>connector</span>: <span class=pl-s>&quot;mongoose&quot;</span><span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L22" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="22"></td>
          <td id="file-database-js-LC22" class="blob-code blob-code-inner js-file-line">      <span class=pl-c1>settings</span>: <span class=pl-kos>{</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L23" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="23"></td>
          <td id="file-database-js-LC23" class="blob-code blob-code-inner js-file-line">        <span class=pl-c1>uri</span>: <span class=pl-en>env</span><span class=pl-kos>(</span><span class=pl-s>&quot;MONGODB_URI&quot;</span><span class=pl-kos>)</span><span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L24" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="24"></td>
          <td id="file-database-js-LC24" class="blob-code blob-code-inner js-file-line">      <span class=pl-kos>}</span><span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L25" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="25"></td>
          <td id="file-database-js-LC25" class="blob-code blob-code-inner js-file-line">      <span class=pl-c1>options</span>: <span class=pl-kos>{</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L26" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="26"></td>
          <td id="file-database-js-LC26" class="blob-code blob-code-inner js-file-line">        <span class=pl-c1>ssl</span>: <span class=pl-c1>true</span><span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L27" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="27"></td>
          <td id="file-database-js-LC27" class="blob-code blob-code-inner js-file-line">      <span class=pl-kos>}</span><span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L28" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="28"></td>
          <td id="file-database-js-LC28" class="blob-code blob-code-inner js-file-line">    <span class=pl-kos>}</span><span class=pl-kos>;</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L29" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="29"></td>
          <td id="file-database-js-LC29" class="blob-code blob-code-inner js-file-line">  <span class=pl-kos>}</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L30" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="30"></td>
          <td id="file-database-js-LC30" class="blob-code blob-code-inner js-file-line"><span class=pl-kos>}</span><span class=pl-kos>;</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L31" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="31"></td>
          <td id="file-database-js-LC31" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="file-database-js-L32" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="32"></td>
          <td id="file-database-js-LC32" class="blob-code blob-code-inner js-file-line"><span class=pl-smi>module</span><span class=pl-kos>.</span><span class=pl-en>exports</span> <span class=pl-c1>=</span> <span class=pl-kos>(</span><span class=pl-kos>{</span> env <span class=pl-kos>}</span><span class=pl-kos>)</span> <span class=pl-c1>=&gt;</span> <span class=pl-kos>(</span><span class=pl-kos>{</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L33" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="33"></td>
          <td id="file-database-js-LC33" class="blob-code blob-code-inner js-file-line">  <span class=pl-c1>defaultConnection</span>: <span class=pl-s>&quot;default&quot;</span><span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L34" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="34"></td>
          <td id="file-database-js-LC34" class="blob-code blob-code-inner js-file-line">  <span class=pl-c1>connections</span>: <span class=pl-kos>{</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L35" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="35"></td>
          <td id="file-database-js-LC35" class="blob-code blob-code-inner js-file-line">    <span class=pl-c1>default</span>: <span class=pl-en>getDatabaseConfig</span><span class=pl-kos>(</span><span class=pl-kos>{</span> env <span class=pl-kos>}</span><span class=pl-kos>)</span><span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L36" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="36"></td>
          <td id="file-database-js-LC36" class="blob-code blob-code-inner js-file-line">  <span class=pl-kos>}</span><span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-database-js-L37" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="37"></td>
          <td id="file-database-js-LC37" class="blob-code blob-code-inner js-file-line"><span class=pl-kos>}</span><span class=pl-kos>)</span><span class=pl-kos>;</span></td>
        </tr>
  </table>
</div>


    </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/viktorfa/3975ee2e67f38e885d02b4e2c4c1097e/raw/98edba4145d6a7c5d7b649f6e9f2587f5998cfc6/database.js" style="float:right" class="Link--inTextBlock">view raw</a>
        <a href="https://gist.github.com/viktorfa/3975ee2e67f38e885d02b4e2c4c1097e#file-database-js" class="Link--inTextBlock">
          database.js
        </a>
        hosted with &#10084; by <a class="Link--inTextBlock" href="https://github.com">GitHub</a>
      </div>
    </div>
</div>
</div><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-232d920b3dfe.css" type="text/css"></div><!--]--><!--]--><p data-v-f4c85dbd><!--[-->Lastly, install the Strapi connector for Mongo:<!--]--></p><div class="highlight-bash prose-code" meta data-v-ef0b30fc><!----><!--[--><pre class="language-bash shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0">yarn</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> add</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> strapi-connector-mongoose
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-ef0b30fc data-v-2c5d870f><span class="sr-only" data-v-2c5d870f>Copy to clipboard</span><span class="icon-wrapper" data-v-2c5d870f><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-2c5d870f style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-5f091540><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8Zm-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-f4c85dbd><!--[-->You can now start Strapi with  <code class="" data-v-69006e27><!--[-->sls offline<!--]--></code> and check that it works locally by visiting <code class="" data-v-69006e27><!--[-->http://localhost:3000/dev<!--]--></code>. While it should work i the cloud as well, it&#39;s good to double check by deploying with:<!--]--></p><div class="highlight-bash prose-code" meta data-v-ef0b30fc><!----><!--[--><pre class="language-bash shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0">yarn</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8"> &amp;&amp; </span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0">./scripts/trim-node-modules.sh
</span></span><span class="line" line="2"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0">sls</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> deploy</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF"> --verbose
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-ef0b30fc data-v-2c5d870f><span class="sr-only" data-v-2c5d870f>Copy to clipboard</span><span class="icon-wrapper" data-v-2c5d870f><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-2c5d870f style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-5f091540><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8Zm-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><h3 id="cloudformation-of-s3" data-v-4af47174><a aria-current="page" href="/posts/serverless-strapi-tutorial/#cloudformation-of-s3" class="router-link-active router-link-exact-active" data-v-4af47174><!--[-->Cloudformation of S3<!--]--><!----></a></h3><p data-v-f4c85dbd><!--[-->We create a simple S3 bucket in our Cloudformation templates. An advantage of the Serverless framework is the <em data-v-4353b993><!--[-->infrastructure as code<!--]--></em> comes included to a large degree, so managing resources like S3 buckets is controlled and checked in your Git repo.<!--]--></p><p data-v-f4c85dbd><!--[-->We edit the <code class="" data-v-69006e27><!--[-->provider<!--]--></code>, <code class="" data-v-69006e27><!--[-->custom<!--]--></code>, <code class="" data-v-69006e27><!--[-->plugins<!--]--></code>, and <code class="" data-v-69006e27><!--[-->resources<!--]--></code> sections of our <code class="" data-v-69006e27><!--[-->serverless.yml<!--]--></code> config.<!--]--></p><!--[--><!--[--><div nuxt-ssr-component-uid="a4ef49fe-ebd4-4bc2-9953-42e5966ecd2e"><div><div id="gist104880748" class="gist">
    <div class="gist-file" translate="no">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-serverless-yml" class="file my-2">
    
    <div itemprop="text" class="Box-body p-0 blob-wrapper data type-yaml  ">

        
<div class="js-check-bidi js-blob-code-container blob-code-content">

  <template class="js-file-alert-template">
  <div data-view-component="true" class="flash flash-warn flash-full d-flex flex-items-center">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
    <span>
      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
      <a class="Link--inTextBlock" href="https://github.co/hiddenchars" target="_blank">Learn more about bidirectional Unicode characters</a>
    </span>


  <div data-view-component="true" class="flash-action">        <a href="#" data-view-component="true" class="btn-sm btn">    Show hidden characters
</a>
</div>
</div></template>
<template class="js-line-alert-template">
  <span aria-label="This line has hidden Unicode characters" data-view-component="true" class="line-alert tooltipped tooltipped-e">
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
</span></template>

  <table data-hpc class="highlight tab-size js-file-line-container js-code-nav-container js-tagsearch-file" data-tab-size="8" data-paste-markdown-skip data-tagsearch-lang="YAML" data-tagsearch-path="serverless.yml">
        <tr>
          <td id="file-serverless-yml-L1" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1"></td>
          <td id="file-serverless-yml-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-ent">service</span>: <span class="pl-s">sls-strapi</span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L2" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2"></td>
          <td id="file-serverless-yml-LC2" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L3" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3"></td>
          <td id="file-serverless-yml-LC3" class="blob-code blob-code-inner js-file-line"><span class="pl-ent">provider</span>:</td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L4" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4"></td>
          <td id="file-serverless-yml-LC4" class="blob-code blob-code-inner js-file-line">  <span class="pl-ent">name</span>: <span class="pl-s">aws</span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L5" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="5"></td>
          <td id="file-serverless-yml-LC5" class="blob-code blob-code-inner js-file-line">  <span class="pl-ent">runtime</span>: <span class="pl-s">nodejs12.x</span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L6" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="6"></td>
          <td id="file-serverless-yml-LC6" class="blob-code blob-code-inner js-file-line">  <span class="pl-ent">profile</span>: <span class="pl-s">&lt;your-aws-profile&gt;</span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L7" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="7"></td>
          <td id="file-serverless-yml-LC7" class="blob-code blob-code-inner js-file-line">  <span class="pl-ent">logRetentionInDays</span>: <span class="pl-s">${self:custom.vars.logRetentionInDays, 1}</span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L8" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="8"></td>
          <td id="file-serverless-yml-LC8" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L9" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="9"></td>
          <td id="file-serverless-yml-LC9" class="blob-code blob-code-inner js-file-line">  <span class="pl-ent">environment</span>:</td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L10" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="10"></td>
          <td id="file-serverless-yml-LC10" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">ADMIN_JWT_SECRET</span>: <span class="pl-s"><span class="pl-pds">&quot;</span>Just using dummy<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L11" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="11"></td>
          <td id="file-serverless-yml-LC11" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">API_SERVICE_HOST</span>: <span class="pl-s"><span class="pl-pds">&quot;</span>https://l4rjveb7rk.execute-api.us-east-1.amazonaws.com/dev<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L12" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="12"></td>
          <td id="file-serverless-yml-LC12" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">BUCKET_NAME</span>: <span class="pl-s">!Ref S3StaticBucket</span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L13" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="13"></td>
          <td id="file-serverless-yml-LC13" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">#</span> URL from a free Mongo Atlas cluster.</span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L14" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="14"></td>
          <td id="file-serverless-yml-LC14" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">MONGODB_URI</span>: <span class="pl-s"><span class="pl-pds">&quot;</span>mongodb+srv://strapiowner:PASSWORD@cluster0.weldo.mongodb.net/strapi?retryWrites=true&amp;w=majority<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L15" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="15"></td>
          <td id="file-serverless-yml-LC15" class="blob-code blob-code-inner js-file-line">  </td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L16" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="16"></td>
          <td id="file-serverless-yml-LC16" class="blob-code blob-code-inner js-file-line">  <span class="pl-ent">iamRoleStatements</span>:</td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L17" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="17"></td>
          <td id="file-serverless-yml-LC17" class="blob-code blob-code-inner js-file-line">    - <span class="pl-ent">Effect</span>: <span class="pl-s">Allow</span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L18" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="18"></td>
          <td id="file-serverless-yml-LC18" class="blob-code blob-code-inner js-file-line">      <span class="pl-ent">Action</span>: </td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L19" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="19"></td>
          <td id="file-serverless-yml-LC19" class="blob-code blob-code-inner js-file-line">        - <span class="pl-s"><span class="pl-pds">&quot;</span>s3:*<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L20" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="20"></td>
          <td id="file-serverless-yml-LC20" class="blob-code blob-code-inner js-file-line">      <span class="pl-ent">Resource</span>: </td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L21" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="21"></td>
          <td id="file-serverless-yml-LC21" class="blob-code blob-code-inner js-file-line">        - <span class="pl-k">!Sub</span> </td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L22" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="22"></td>
          <td id="file-serverless-yml-LC22" class="blob-code blob-code-inner js-file-line">          - <span class="pl-s"><span class="pl-pds">&quot;</span>#{BucketArn}/*<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L23" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="23"></td>
          <td id="file-serverless-yml-LC23" class="blob-code blob-code-inner js-file-line">          - <span class="pl-ent">BucketArn</span>: <span class="pl-s">!GetAtt S3StaticBucket.Arn</span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L24" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="24"></td>
          <td id="file-serverless-yml-LC24" class="blob-code blob-code-inner js-file-line">        - <span class="pl-k">!GetAtt</span> <span class="pl-s">S3StaticBucket.Arn</span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L25" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="25"></td>
          <td id="file-serverless-yml-LC25" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L26" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="26"></td>
          <td id="file-serverless-yml-LC26" class="blob-code blob-code-inner js-file-line"><span class="pl-ent">resources</span>:</td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L27" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="27"></td>
          <td id="file-serverless-yml-LC27" class="blob-code blob-code-inner js-file-line">  <span class="pl-ent">Resources</span>:  </td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L28" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="28"></td>
          <td id="file-serverless-yml-LC28" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">S3StaticBucket</span>:</td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L29" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="29"></td>
          <td id="file-serverless-yml-LC29" class="blob-code blob-code-inner js-file-line">      <span class="pl-ent">Type</span>: <span class="pl-s">AWS::S3::Bucket</span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L30" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="30"></td>
          <td id="file-serverless-yml-LC30" class="blob-code blob-code-inner js-file-line">      </td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L31" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="31"></td>
          <td id="file-serverless-yml-LC31" class="blob-code blob-code-inner js-file-line"><span class="pl-ent">custom</span>:</td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L32" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="32"></td>
          <td id="file-serverless-yml-LC32" class="blob-code blob-code-inner js-file-line">  <span class="pl-ent">apigwBinary</span>:</td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L33" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="33"></td>
          <td id="file-serverless-yml-LC33" class="blob-code blob-code-inner js-file-line">    <span class="pl-ent">types</span>:</td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L34" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="34"></td>
          <td id="file-serverless-yml-LC34" class="blob-code blob-code-inner js-file-line">      - <span class="pl-s"><span class="pl-pds">&quot;</span>multipart/form-data<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L35" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="35"></td>
          <td id="file-serverless-yml-LC35" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L36" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="36"></td>
          <td id="file-serverless-yml-LC36" class="blob-code blob-code-inner js-file-line"><span class="pl-ent">plugins</span>:</td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L37" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="37"></td>
          <td id="file-serverless-yml-LC37" class="blob-code blob-code-inner js-file-line">  - <span class="pl-s">serverless-offline</span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L38" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="38"></td>
          <td id="file-serverless-yml-LC38" class="blob-code blob-code-inner js-file-line">  - <span class="pl-s">serverless-cloudformation-sub-variables</span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L39" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="39"></td>
          <td id="file-serverless-yml-LC39" class="blob-code blob-code-inner js-file-line">  - <span class="pl-s">serverless-apigw-binary</span></td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L40" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="40"></td>
          <td id="file-serverless-yml-LC40" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="file-serverless-yml-L41" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="41"></td>
          <td id="file-serverless-yml-LC41" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#</span> ...</span></td>
        </tr>
  </table>
</div>


    </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/viktorfa/76e6ee19dd53e3f1a03db360eabb5263/raw/dcd2b5138579d10d86169b6acc62558f0c6246bb/serverless.yml" style="float:right" class="Link--inTextBlock">view raw</a>
        <a href="https://gist.github.com/viktorfa/76e6ee19dd53e3f1a03db360eabb5263#file-serverless-yml" class="Link--inTextBlock">
          serverless.yml
        </a>
        hosted with &#10084; by <a class="Link--inTextBlock" href="https://github.com">GitHub</a>
      </div>
    </div>
</div>
</div><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-232d920b3dfe.css" type="text/css"></div><!--]--><!--]--><p data-v-f4c85dbd><!--[-->Install the Strapi provider for S3 upload and two other plugins:<!--]--></p><div class="highlight-bash prose-code" meta data-v-ef0b30fc><!----><!--[--><pre class="language-bash shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0">yarn</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> add</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> strapi-provider-upload-aws-s3
</span></span><span class="line" line="2"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0">yarn</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> add</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF"> -D</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> serverless-apigw-binary
</span></span><span class="line" line="3"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0">yarn</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> add</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF"> -D</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> serverless-cloudformation-sub-variables
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-ef0b30fc data-v-2c5d870f><span class="sr-only" data-v-2c5d870f>Copy to clipboard</span><span class="icon-wrapper" data-v-2c5d870f><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-2c5d870f style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-5f091540><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8Zm-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-f4c85dbd><!--[-->We need to add some config in a new file called <code class="" data-v-69006e27><!--[-->config/plugins.js<!--]--></code>. S3 in Lambda works quite automagically, so the only config we need is the bucket name. Note that the BUCKET_NAME environment variable will be &quot;<span>Object object</span>&quot; if you run locally with <code class="" data-v-69006e27><!--[-->sls offline<!--]--></code>, because we get the bucket name in <code class="" data-v-69006e27><!--[-->serverless.yml<!--]--></code> with a Cloudformation <em data-v-4353b993><!--[-->!Ref<!--]--></em>. After you deploy, you get the name of your S3 bucket which you can use to test with S3 locally later.<!--]--></p><!--[--><!--[--><div nuxt-ssr-component-uid="5e12bfd1-ae4e-47bf-8af2-25113452ff6f"><div><div id="gist104881163" class="gist">
    <div class="gist-file" translate="no">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-plugins-js" class="file my-2">
    
    <div itemprop="text" class="Box-body p-0 blob-wrapper data type-javascript  ">

        
<div class="js-check-bidi js-blob-code-container blob-code-content">

  <template class="js-file-alert-template">
  <div data-view-component="true" class="flash flash-warn flash-full d-flex flex-items-center">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
    <span>
      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
      <a class="Link--inTextBlock" href="https://github.co/hiddenchars" target="_blank">Learn more about bidirectional Unicode characters</a>
    </span>


  <div data-view-component="true" class="flash-action">        <a href="#" data-view-component="true" class="btn-sm btn">    Show hidden characters
</a>
</div>
</div></template>
<template class="js-line-alert-template">
  <span aria-label="This line has hidden Unicode characters" data-view-component="true" class="line-alert tooltipped tooltipped-e">
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
</span></template>

  <table data-hpc class="highlight tab-size js-file-line-container js-code-nav-container js-tagsearch-file" data-tab-size="8" data-paste-markdown-skip data-tagsearch-lang="JavaScript" data-tagsearch-path="plugins.js">
        <tr>
          <td id="file-plugins-js-L1" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1"></td>
          <td id="file-plugins-js-LC1" class="blob-code blob-code-inner js-file-line"><span class=pl-c>// config/plugins.js</span></td>
        </tr>
        <tr>
          <td id="file-plugins-js-L2" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2"></td>
          <td id="file-plugins-js-LC2" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="file-plugins-js-L3" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3"></td>
          <td id="file-plugins-js-LC3" class="blob-code blob-code-inner js-file-line"><span class=pl-smi>module</span><span class=pl-kos>.</span><span class=pl-en>exports</span> <span class=pl-c1>=</span> <span class=pl-kos>(</span><span class=pl-kos>{</span> env <span class=pl-kos>}</span><span class=pl-kos>)</span> <span class=pl-c1>=&gt;</span> <span class=pl-kos>(</span><span class=pl-kos>{</span></td>
        </tr>
        <tr>
          <td id="file-plugins-js-L4" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4"></td>
          <td id="file-plugins-js-LC4" class="blob-code blob-code-inner js-file-line">  <span class=pl-c1>upload</span>: <span class=pl-kos>{</span></td>
        </tr>
        <tr>
          <td id="file-plugins-js-L5" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="5"></td>
          <td id="file-plugins-js-LC5" class="blob-code blob-code-inner js-file-line">    <span class=pl-c1>provider</span>: <span class=pl-s>&quot;aws-s3&quot;</span><span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-plugins-js-L6" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="6"></td>
          <td id="file-plugins-js-LC6" class="blob-code blob-code-inner js-file-line">    <span class=pl-c1>providerOptions</span>: <span class=pl-kos>{</span></td>
        </tr>
        <tr>
          <td id="file-plugins-js-L7" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="7"></td>
          <td id="file-plugins-js-LC7" class="blob-code blob-code-inner js-file-line">      <span class=pl-c1>params</span>: <span class=pl-kos>{</span></td>
        </tr>
        <tr>
          <td id="file-plugins-js-L8" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="8"></td>
          <td id="file-plugins-js-LC8" class="blob-code blob-code-inner js-file-line">        <span class=pl-c1>Bucket</span>: <span class=pl-en>env</span><span class=pl-kos>(</span><span class=pl-s>&quot;BUCKET_NAME&quot;</span><span class=pl-kos>)</span><span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-plugins-js-L9" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="9"></td>
          <td id="file-plugins-js-LC9" class="blob-code blob-code-inner js-file-line">      <span class=pl-kos>}</span><span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-plugins-js-L10" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="10"></td>
          <td id="file-plugins-js-LC10" class="blob-code blob-code-inner js-file-line">    <span class=pl-kos>}</span><span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-plugins-js-L11" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="11"></td>
          <td id="file-plugins-js-LC11" class="blob-code blob-code-inner js-file-line">  <span class=pl-kos>}</span><span class=pl-kos>,</span></td>
        </tr>
        <tr>
          <td id="file-plugins-js-L12" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="12"></td>
          <td id="file-plugins-js-LC12" class="blob-code blob-code-inner js-file-line"><span class=pl-kos>}</span><span class=pl-kos>)</span><span class=pl-kos>;</span></td>
        </tr>
  </table>
</div>


    </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/viktorfa/6d8973dd95998b1325f4f8c981e08bf8/raw/3ecc2814a74b1b933ef8f21a1960c0172ddec9e0/plugins.js" style="float:right" class="Link--inTextBlock">view raw</a>
        <a href="https://gist.github.com/viktorfa/6d8973dd95998b1325f4f8c981e08bf8#file-plugins-js" class="Link--inTextBlock">
          plugins.js
        </a>
        hosted with &#10084; by <a class="Link--inTextBlock" href="https://github.com">GitHub</a>
      </div>
    </div>
</div>
</div><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-232d920b3dfe.css" type="text/css"></div><!--]--><!--]--><p data-v-f4c85dbd><!--[-->To create the S3 bucket, deploy with<!--]--></p><div class="highlight-bash prose-code" meta data-v-ef0b30fc><!----><!--[--><pre class="language-bash shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0">./scripts/trim-node-modules.sh
</span></span><span class="line" line="2"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0">sls</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> deploy</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF"> --verbose
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-ef0b30fc data-v-2c5d870f><span class="sr-only" data-v-2c5d870f>Copy to clipboard</span><span class="icon-wrapper" data-v-2c5d870f><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-2c5d870f style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-5f091540><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8Zm-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-f4c85dbd><!--[-->Once deployed, visit <code class="" data-v-69006e27><!--[-->http://localhost:5000<!--]--></code> to visit the admin user interface. Go to Media Library and try to upload a file.<!--]--></p><p data-v-f4c85dbd><!--[--><img style="aspect-ratio:709/237;" src="/posts/serverless-strapi-tutorial/Untitled_14.png" alt="Untitled 14.png" data-v-80d56572><!--]--></p><p data-v-f4c85dbd><!--[--><img style="aspect-ratio:1499/532;" src="/posts/serverless-strapi-tutorial/Untitled_15.png" alt="Untitled 15.png" data-v-80d56572><!--]--></p><p data-v-f4c85dbd><!--[--><strong data-v-c6a59043><!--[-->File upload and API Gateway<!--]--></strong>
Uploading files when using Serverless can be a bit of a hassle. All HTTP requests goes through an Amazon service called API Gateway. This gateway processes files in a certain way.
Uploads are often in a binary format, and we need to tell API Gateway explicitly which content types it should handle as binary files.
In Strapi the content type is <code class="" data-v-69006e27><!--[-->multipart/form-data<!--]--></code>, and we configure this with the <code class="" data-v-69006e27><!--[-->serverless-apigw-binary<!--]--></code> plugin. DON&#39;T add &quot;<em data-v-4353b993><!--[-->/<!--]--></em>&quot; as a content-type, as this will break the CORS configuration of your API.<!--]--></p><h2 id="wrapping-up" data-v-6d609909><a aria-current="page" href="/posts/serverless-strapi-tutorial/#wrapping-up" class="router-link-active router-link-exact-active" data-v-6d609909><!--[-->Wrapping up<!--]--><!----></a></h2><p data-v-f4c85dbd><!--[-->You know have a scalable Strapi instance that is paid on a pay-per-use basis. Unfortunately, we were not able to make the database as serverless as the rest of the application, but for many use, cases, such as when Strapi is a backend for a CMS to a static site, this is of little significance.<!--]--></p><h3 id="multi-tenancy-and-strapi-as-headless-cms" data-v-4af47174><a aria-current="page" href="/posts/serverless-strapi-tutorial/#multi-tenancy-and-strapi-as-headless-cms" class="router-link-active router-link-exact-active" data-v-4af47174><!--[-->Multi tenancy and Strapi as headless CMS<!--]--><!----></a></h3><p data-v-f4c85dbd><!--[-->Strapi does not support multi tenancy. Meaning if you have a portfolio of websites that use Strapi as a CMS, each website needs its own Strapi instance. This is a major weakness of Strapi in my opinion. Wordpress supports multisite config, and many hosting providers have support for unlimited Wordpress instances on a single subscription, which is possible because Wordpress supports multi tenancy.<!--]--></p><p data-v-f4c85dbd><!--[-->Many managed CMSs such as Contentful charge on a per user and per project basis. Meaning you have to pay much more once you want people to cooperate on a project or you have many projects.<!--]--></p><p data-v-f4c85dbd><!--[-->Our Serverless Strapi allows scalable multi tenancy with Strapi in the following way: Create a new Strapi application for each project just like we did in this tutorial. Let all projects use the same database cluster, but a different database name and user. You can now create hundreds of Strapi APIs using the same fixed cost database. The other costs are S3 file storage, Lambda invocations, and some bandwidth which is billed on a pure pay-per-use basis.<!--]--></p><p data-v-f4c85dbd><!--[-->See the Git repo for this tutorial at <a href="https://github.com/viktorfa/strapi-serverless" rel="nofollow" data-v-d83694f9><!--[-->https://github.com/viktorfa/strapi-serverless<!--]--></a>.<!--]--></p><style>html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}</style></div><!--]--></main></div><!--]--><footer class="center" data-v-a9d5dfed data-v-654b05f0><a href="https://www.github.com/nuxt-themes/alpine" rel="noopener noreferrer" class="credits" data-v-654b05f0>Alpine</a><div class="navigation" data-v-654b05f0><nav data-v-654b05f0 data-v-f1645879><ul data-v-f1645879><!--[--><li data-v-f1645879><a href="/" class="" data-v-f1645879><span class="underline-fx" data-v-f1645879></span> Home</a></li><li data-v-f1645879><a href="/contact" class="" data-v-f1645879><span class="underline-fx" data-v-f1645879></span> Contact</a></li><li data-v-f1645879><a href="/posts" class="" data-v-f1645879><span class="underline-fx" data-v-f1645879></span> Archive</a></li><!--]--></ul></nav></div><p class="message" data-v-654b05f0>Follow me on</p><div class="icons" data-v-654b05f0><div class="social" data-v-654b05f0><!--[--><a href="https://twitter.com/vikfand" rel="noopener noreferrer" target="_blank" title="vikfand" aria-label="vikfand" data-v-bb750848><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-bb750848 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-5f091540><path fill="currentColor" d="M22 5.8a8.49 8.49 0 0 1-2.36.64a4.13 4.13 0 0 0 1.81-2.27a8.21 8.21 0 0 1-2.61 1a4.1 4.1 0 0 0-7 3.74a11.64 11.64 0 0 1-8.45-4.29a4.16 4.16 0 0 0-.55 2.07a4.09 4.09 0 0 0 1.82 3.41a4.05 4.05 0 0 1-1.86-.51v.05a4.1 4.1 0 0 0 3.3 4a3.93 3.93 0 0 1-1.1.17a4.9 4.9 0 0 1-.77-.07a4.11 4.11 0 0 0 3.83 2.84A8.22 8.22 0 0 1 3 18.34a7.93 7.93 0 0 1-1-.06a11.57 11.57 0 0 0 6.29 1.85A11.59 11.59 0 0 0 20 8.45v-.53a8.43 8.43 0 0 0 2-2.12Z"/></svg></a><a href="https://instagram.com/viktorfandersen" rel="noopener noreferrer" target="_blank" title="viktorfandersen" aria-label="viktorfandersen" data-v-bb750848><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-bb750848 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-5f091540><path fill="currentColor" d="M17.34 5.46a1.2 1.2 0 1 0 1.2 1.2a1.2 1.2 0 0 0-1.2-1.2Zm4.6 2.42a7.59 7.59 0 0 0-.46-2.43a4.94 4.94 0 0 0-1.16-1.77a4.7 4.7 0 0 0-1.77-1.15a7.3 7.3 0 0 0-2.43-.47C15.06 2 14.72 2 12 2s-3.06 0-4.12.06a7.3 7.3 0 0 0-2.43.47a4.78 4.78 0 0 0-1.77 1.15a4.7 4.7 0 0 0-1.15 1.77a7.3 7.3 0 0 0-.47 2.43C2 8.94 2 9.28 2 12s0 3.06.06 4.12a7.3 7.3 0 0 0 .47 2.43a4.7 4.7 0 0 0 1.15 1.77a4.78 4.78 0 0 0 1.77 1.15a7.3 7.3 0 0 0 2.43.47C8.94 22 9.28 22 12 22s3.06 0 4.12-.06a7.3 7.3 0 0 0 2.43-.47a4.7 4.7 0 0 0 1.77-1.15a4.85 4.85 0 0 0 1.16-1.77a7.59 7.59 0 0 0 .46-2.43c0-1.06.06-1.4.06-4.12s0-3.06-.06-4.12ZM20.14 16a5.61 5.61 0 0 1-.34 1.86a3.06 3.06 0 0 1-.75 1.15a3.19 3.19 0 0 1-1.15.75a5.61 5.61 0 0 1-1.86.34c-1 .05-1.37.06-4 .06s-3 0-4-.06a5.73 5.73 0 0 1-1.94-.3a3.27 3.27 0 0 1-1.1-.75a3 3 0 0 1-.74-1.15a5.54 5.54 0 0 1-.4-1.9c0-1-.06-1.37-.06-4s0-3 .06-4a5.54 5.54 0 0 1 .35-1.9A3 3 0 0 1 5 5a3.14 3.14 0 0 1 1.1-.8A5.73 5.73 0 0 1 8 3.86c1 0 1.37-.06 4-.06s3 0 4 .06a5.61 5.61 0 0 1 1.86.34a3.06 3.06 0 0 1 1.19.8a3.06 3.06 0 0 1 .75 1.1a5.61 5.61 0 0 1 .34 1.9c.05 1 .06 1.37.06 4s-.01 3-.06 4ZM12 6.87A5.13 5.13 0 1 0 17.14 12A5.12 5.12 0 0 0 12 6.87Zm0 8.46A3.33 3.33 0 1 1 15.33 12A3.33 3.33 0 0 1 12 15.33Z"/></svg></a><a href="https://www.linkedin.com/in/viktor-frede-andersen-31650153/" rel="noopener noreferrer" target="_blank" title="LinkedIn" aria-label="LinkedIn" data-v-bb750848><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-bb750848 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-5f091540><path fill="currentColor" d="M20.47 2H3.53a1.45 1.45 0 0 0-1.47 1.43v17.14A1.45 1.45 0 0 0 3.53 22h16.94a1.45 1.45 0 0 0 1.47-1.43V3.43A1.45 1.45 0 0 0 20.47 2ZM8.09 18.74h-3v-9h3ZM6.59 8.48a1.56 1.56 0 1 1 0-3.12a1.57 1.57 0 1 1 0 3.12Zm12.32 10.26h-3v-4.83c0-1.21-.43-2-1.52-2A1.65 1.65 0 0 0 12.85 13a2 2 0 0 0-.1.73v5h-3v-9h3V11a3 3 0 0 1 2.71-1.5c2 0 3.45 1.29 3.45 4.06Z"/></svg></a><!--]--></div><div class="color-mode-switch" data-v-654b05f0><button aria-label="Color Mode" data-v-654b05f0 data-v-fd50f6ca><span data-v-fd50f6ca></span></button></div></div></footer><!--]--></div></div><script type="application/json" id="__NUXT_DATA__" data-ssr="true" data-src="/posts/serverless-strapi-tutorial/_payload.json">[{"state":1,"_errors":2110,"serverRendered":1221,"path":2112,"prerenderedAt":2113},["Reactive",2],{"$sdd-pages":3,"$sdd-surrounds":1937,"$sdd-globals":1960,"$scolor-mode":1962,"$sdd-navigation":1964,"$sicons":2093,"$ssite-config":2105},["ShallowRef",4],["ShallowReactive",5],{"/posts/serverless-strapi-tutorial":6},{"_path":7,"_dir":8,"_draft":9,"_partial":9,"_locale":10,"title":11,"description":10,"date":12,"language":13,"draft":9,"body":14,"_type":1930,"_id":1931,"_source":1932,"_file":1933,"_extension":1934,"sitemap":1935,"layout":244},"/posts/serverless-strapi-tutorial","posts",false,"","Serverless Strapi Tutorial","2020-08-17T01:25:06.000Z","english",{"type":15,"children":16,"toc":1914},"root",[17,26,32,57,62,67,72,79,88,124,130,144,189,208,218,228,254,264,283,293,304,309,315,328,347,393,403,419,429,434,438,454,473,477,482,502,521,533,543,548,572,582,587,592,598,618,630,634,646,724,748,773,777,795,800,836,846,858,863,906,916,928,933,938,949,959,970,992,996,1008,1059,1070,1075,1096,1106,1111,1124,1134,1139,1144,1178,1188,1199,1267,1272,1326,1337,1343,1348,1353,1358,1368,1373,1378,1392,1397,1403,1417,1427,1432,1442,1447,1499,1510,1514,1519,1542,1560,1598,1604,1616,1654,1658,1663,1726,1764,1768,1773,1802,1813,1823,1833,1864,1870,1875,1881,1886,1891,1896,1908],{"type":18,"tag":19,"props":20,"children":22},"element","h2",{"id":21},"motivation",[23],{"type":24,"value":25},"text","Motivation",{"type":18,"tag":27,"props":28,"children":29},"p",{},[30],{"type":24,"value":31},"The JAM Stack and Serverless are two trends in web development that have a lot going on right now. One of the most common thing to do for a web developer is to create a website with a CMS. Static sites in themselves follow the serverless paradigm of infinite scalability, pay-per-use, and no-touch operations. But we lack an all-round CMS with the same properties.",{"type":18,"tag":27,"props":33,"children":34},{},[35,37,46,48,55],{"type":24,"value":36},"Wordpress can be used as a headless CMS for modern front-ends, but the old giant is still not ready for more than a few use cases. There are managed CMS-es such as ",{"type":18,"tag":38,"props":39,"children":43},"a",{"href":40,"rel":41},"https://www.contentful.com/",[42],"nofollow",[44],{"type":24,"value":45},"Contentful",{"type":24,"value":47}," and ",{"type":18,"tag":38,"props":49,"children":52},{"href":50,"rel":51},"https://www.cosmicjs.com/",[42],[53],{"type":24,"value":54},"Cosmic",{"type":24,"value":56},". These are good products, but are expensive for many users. Furthermore, they are not open source which entails some drawbacks such as not being very flexible.",{"type":18,"tag":27,"props":58,"children":59},{},[60],{"type":24,"value":61},"Strapi is a leading open source headless CMS. While it's relatively new, it is popular, which means they really fill a need in the market. I have many complaints about Strapi, but they are, as far as I see it now, the best option for a general open source CMS.",{"type":18,"tag":27,"props":63,"children":64},{},[65],{"type":24,"value":66},"One drawback even with Strapi is that you need to host it yourself. While it's easy to spin up a server with a database, you have to be worried about scaling it. Even for hobby projects which will probably never have to scale, I feel uncomfortable knowing I might have to get my hands dirty with scaling a database and all that.",{"type":18,"tag":27,"props":68,"children":69},{},[70],{"type":24,"value":71},"Strapi is not made to be serverless. It is, however, possible to shoehorn a Strapi application onto AWS Lambda with the Serverless framework. Since AWS also has a MySQL compatible serverless database in Aurora, we might be able to create an infinitely scalable Strapi that requires very little ops, and costs nothing when not used.",{"type":18,"tag":73,"props":74,"children":76},"h3",{"id":75},"what-is-serverless",[77],{"type":24,"value":78},"What is serverless?",{"type":18,"tag":27,"props":80,"children":81},{},[82],{"type":18,"tag":83,"props":84,"children":85},"em",{},[86],{"type":24,"value":87},"It has little to do with servers.",{"type":18,"tag":89,"props":90,"children":91},"ul",{},[92,104,114],{"type":18,"tag":93,"props":94,"children":95},"li",{},[96,102],{"type":18,"tag":97,"props":98,"children":99},"strong",{},[100],{"type":24,"value":101},"Infinitely scalable",{"type":24,"value":103},"\nThe infrastructure can handle spikes and sudden growth is use without problem.",{"type":18,"tag":93,"props":105,"children":106},{},[107,112],{"type":18,"tag":97,"props":108,"children":109},{},[110],{"type":24,"value":111},"No touch operations",{"type":24,"value":113},"\nNot only is it scalable. Scaling does not require any effort. You don't manually add or remove instances. You don't write scripts to automatically do that stuff. It's taken care of in the infrastructure. You don't shut things down at night or in weekends to save money because you don't need to. You don't worry about scaling because you know it does so by itself.",{"type":18,"tag":93,"props":115,"children":116},{},[117,122],{"type":18,"tag":97,"props":118,"children":119},{},[120],{"type":24,"value":121},"Pay-per-use",{"type":24,"value":123},"\nYou only pay when things are being done. Costs are predictable and follow a smooth, linear curve. No execution means zero cost.",{"type":18,"tag":19,"props":125,"children":127},{"id":126},"set-up-strapi",[128],{"type":24,"value":129},"Set Up Strapi",{"type":18,"tag":27,"props":131,"children":132},{},[133,135,142],{"type":24,"value":134},"We start by setting up Strapi locally. We roughly follow the ",{"type":18,"tag":38,"props":136,"children":139},{"href":137,"rel":138},"https://strapi.io/documentation/v3.x/installation/cli.html",[42],[140],{"type":24,"value":141},"official quick start guide",{"type":24,"value":143}," for Strapi 3.1.",{"type":18,"tag":145,"props":146,"children":150},"pre",{"className":147,"code":148,"language":149,"meta":10,"style":10},"language-bash shiki shiki-themes github-light github-dark","yarn create strapi-app sls-strapi --quickstart\n","bash",[151],{"type":18,"tag":152,"props":153,"children":154},"code",{"__ignoreMap":10},[155],{"type":18,"tag":156,"props":157,"children":160},"span",{"class":158,"line":159},"line",1,[161,167,173,178,183],{"type":18,"tag":156,"props":162,"children":164},{"style":163},"--shiki-default:#6F42C1;--shiki-dark:#B392F0",[165],{"type":24,"value":166},"yarn",{"type":18,"tag":156,"props":168,"children":170},{"style":169},"--shiki-default:#032F62;--shiki-dark:#9ECBFF",[171],{"type":24,"value":172}," create",{"type":18,"tag":156,"props":174,"children":175},{"style":169},[176],{"type":24,"value":177}," strapi-app",{"type":18,"tag":156,"props":179,"children":180},{"style":169},[181],{"type":24,"value":182}," sls-strapi",{"type":18,"tag":156,"props":184,"children":186},{"style":185},"--shiki-default:#005CC5;--shiki-dark:#79B8FF",[187],{"type":24,"value":188}," --quickstart\n",{"type":18,"tag":27,"props":190,"children":191},{},[192,194,199,201,206],{"type":24,"value":193},"This will create a basic Strapi app with the file based database SQLite in the ",{"type":18,"tag":152,"props":195,"children":196},{"className":10},[197],{"type":24,"value":198},"sls-strapi",{"type":24,"value":200}," folder. If successful, Strapi will run on ",{"type":18,"tag":152,"props":202,"children":203},{"className":10},[204],{"type":24,"value":205},"http://localhost:1337",{"type":24,"value":207},".",{"type":18,"tag":27,"props":209,"children":210},{},[211],{"type":18,"tag":212,"props":213,"children":217},"img",{"alt":214,"src":214,"style":215},"/posts/serverless-strapi-tutorial/Untitled.png",{"aspectRatio":216},"952/563",[],{"type":18,"tag":27,"props":219,"children":220},{},[221],{"type":18,"tag":212,"props":222,"children":227},{"alt":223,"src":224,"style":225},"Untitled 1.png","/posts/serverless-strapi-tutorial/Untitled_1.png",{"aspectRatio":226},"480/694",[],{"type":18,"tag":27,"props":229,"children":230},{},[231,233,238,240,245,247,252],{"type":24,"value":232},"While we won't use this instance of Strapi with the SQLite database, you should make at least one content type in Strapi either through the content type builder or by adding a content type in the ",{"type":18,"tag":152,"props":234,"children":235},{"className":10},[236],{"type":24,"value":237},"api/",{"type":24,"value":239}," folder. I will create a content type called ",{"type":18,"tag":97,"props":241,"children":242},{},[243],{"type":24,"value":244},"page",{"type":24,"value":246}," with a single field called ",{"type":18,"tag":97,"props":248,"children":249},{},[250],{"type":24,"value":251},"title",{"type":24,"value":253},". Make the content type and wait for the server to restart.",{"type":18,"tag":27,"props":255,"children":256},{},[257],{"type":18,"tag":212,"props":258,"children":263},{"alt":259,"src":260,"style":261},"Untitled 2.png","/posts/serverless-strapi-tutorial/Untitled_2.png",{"aspectRatio":262},"924/327",[],{"type":18,"tag":27,"props":265,"children":266},{},[267,269,274,276,281],{"type":24,"value":268},"Add a single item to the collection, then test that it works by getting ",{"type":18,"tag":152,"props":270,"children":271},{"className":10},[272],{"type":24,"value":273},"http://localhost:1337/pages",{"type":24,"value":275},". You will get a ",{"type":18,"tag":152,"props":277,"children":278},{"className":10},[279],{"type":24,"value":280},"403 FORBIDDEN",{"type":24,"value":282}," message, as we need to allow unauthenticated users read access to the collection.",{"type":18,"tag":27,"props":284,"children":285},{},[286],{"type":18,"tag":212,"props":287,"children":292},{"alt":288,"src":289,"style":290},"Untitled 3.png","/posts/serverless-strapi-tutorial/Untitled_3.png",{"aspectRatio":291},"1197/742",[],{"type":18,"tag":27,"props":294,"children":295},{},[296,298,302],{"type":24,"value":297},"Go to Roles & Permissions, edit the Public group and add permissions to read. ",{"type":18,"tag":152,"props":299,"children":300},{"className":10},[301],{"type":24,"value":273},{"type":24,"value":303}," should now respond with your single page item.",{"type":18,"tag":27,"props":305,"children":306},{},[307],{"type":24,"value":308},"We will come back to configuring Strapi for our serverless needs later.",{"type":18,"tag":19,"props":310,"children":312},{"id":311},"set-up-serverless",[313],{"type":24,"value":314},"Set up Serverless",{"type":18,"tag":27,"props":316,"children":317},{},[318,320,327],{"type":24,"value":319},"We will add some Serverless config in the same folder as our Strapi app. If you're not familiar with Serverless, you should perhaps try to deploy a simple Express app on Amazon Web Services (AWS) first, just to get some idea of how it works. To get started, check out the official ",{"type":18,"tag":38,"props":321,"children":324},{"href":322,"rel":323},"https://www.serverless.com/framework/docs/providers/aws/guide/quick-start/",[42],[325],{"type":24,"value":326},"AWS quick start guide",{"type":24,"value":207},{"type":18,"tag":27,"props":329,"children":330},{},[331,333,338,340,345],{"type":24,"value":332},"We install some packages and create a ",{"type":18,"tag":152,"props":334,"children":335},{"className":10},[336],{"type":24,"value":337},"serverless.yml",{"type":24,"value":339}," config and a ",{"type":18,"tag":152,"props":341,"children":342},{"className":10},[343],{"type":24,"value":344},"app.js",{"type":24,"value":346}," file to get started.",{"type":18,"tag":145,"props":348,"children":350},{"className":147,"code":349,"language":149,"meta":10,"style":10},"yarn add -D serverless-offline\nyarn add serverless-http\n",[351],{"type":18,"tag":152,"props":352,"children":353},{"__ignoreMap":10},[354,376],{"type":18,"tag":156,"props":355,"children":356},{"class":158,"line":159},[357,361,366,371],{"type":18,"tag":156,"props":358,"children":359},{"style":163},[360],{"type":24,"value":166},{"type":18,"tag":156,"props":362,"children":363},{"style":169},[364],{"type":24,"value":365}," add",{"type":18,"tag":156,"props":367,"children":368},{"style":185},[369],{"type":24,"value":370}," -D",{"type":18,"tag":156,"props":372,"children":373},{"style":169},[374],{"type":24,"value":375}," serverless-offline\n",{"type":18,"tag":156,"props":377,"children":379},{"class":158,"line":378},2,[380,384,388],{"type":18,"tag":156,"props":381,"children":382},{"style":163},[383],{"type":24,"value":166},{"type":18,"tag":156,"props":385,"children":386},{"style":169},[387],{"type":24,"value":365},{"type":18,"tag":156,"props":389,"children":390},{"style":169},[391],{"type":24,"value":392}," serverless-http\n",{"type":18,"tag":27,"props":394,"children":395},{},[396,401],{"type":18,"tag":152,"props":397,"children":398},{"className":10},[399],{"type":24,"value":400},"serverless-http",{"type":24,"value":402}," is an amazing plugin that makes it trivial to run any Node server as a Lambda function. Koa, which Strapi uses, is also supported.",{"type":18,"tag":27,"props":404,"children":405},{},[406,411,413,417],{"type":18,"tag":152,"props":407,"children":408},{"className":10},[409],{"type":24,"value":410},"serverless-offline",{"type":24,"value":412}," is a well-made plugin that lets you run Serverless apps locally. It works well with ",{"type":18,"tag":152,"props":414,"children":415},{"className":10},[416],{"type":24,"value":400},{"type":24,"value":418}," and even simulates API Gateway, which is a layer in the AWS cloud all http requests go through.",{"type":18,"tag":27,"props":420,"children":421},{},[422,427],{"type":18,"tag":97,"props":423,"children":424},{},[425],{"type":24,"value":426},"TIP",{"type":24,"value":428},"\nUse a profile in your Serverless config with AWS credentials.",{"type":18,"tag":430,"props":431,"children":433},"GistIsland",{"gist":432},"viktorfa/909da389bfccd7255b147a63487ff7fd",[],{"type":18,"tag":430,"props":435,"children":437},{"gist":436},"viktorfa/8186fa9becd42baf5e83868a93de9297",[],{"type":18,"tag":27,"props":439,"children":440},{},[441,443,447,448,452],{"type":24,"value":442},"You should now have ",{"type":18,"tag":152,"props":444,"children":445},{"className":10},[446],{"type":24,"value":344},{"type":24,"value":47},{"type":18,"tag":152,"props":449,"children":450},{"className":10},[451],{"type":24,"value":337},{"type":24,"value":453}," in your root directory.",{"type":18,"tag":27,"props":455,"children":456},{},[457,459,464,466,471],{"type":24,"value":458},"Before we try it, update the database config in ",{"type":18,"tag":152,"props":460,"children":461},{"className":10},[462],{"type":24,"value":463},"config/database.js",{"type":24,"value":465},", so that the storage path for SQLite in the cloud is in the writeable ",{"type":18,"tag":152,"props":467,"children":468},{"className":10},[469],{"type":24,"value":470},"/tmp",{"type":24,"value":472}," directory.",{"type":18,"tag":430,"props":474,"children":476},{"gist":475},"viktorfa/da283a1381aaa6db8e7e89570ec5b08f",[],{"type":18,"tag":27,"props":478,"children":479},{},[480],{"type":24,"value":481},"It should now be possible to run Strapi as a Serverless app. Test it locally by executing",{"type":18,"tag":145,"props":483,"children":485},{"className":147,"code":484,"language":149,"meta":10,"style":10},"sls offline\n",[486],{"type":18,"tag":152,"props":487,"children":488},{"__ignoreMap":10},[489],{"type":18,"tag":156,"props":490,"children":491},{"class":158,"line":159},[492,497],{"type":18,"tag":156,"props":493,"children":494},{"style":163},[495],{"type":24,"value":496},"sls",{"type":18,"tag":156,"props":498,"children":499},{"style":169},[500],{"type":24,"value":501}," offline\n",{"type":18,"tag":27,"props":503,"children":504},{},[505,507,512,514,519],{"type":24,"value":506},"This will start the serverless-offline server, but Strapi won't start until you visit an endpoint. Go to ",{"type":18,"tag":152,"props":508,"children":509},{"className":10},[510],{"type":24,"value":511},"http://localhost:3000/dev/pages",{"type":24,"value":513},". If you get a ",{"type":18,"tag":152,"props":515,"children":516},{"className":10},[517],{"type":24,"value":518},"200 OK",{"type":24,"value":520}," with the one page you created before, everything works as it should. The first response might be a bit slow, as the Strapi server takes some time to boot, but subsequent requests will be fast.",{"type":18,"tag":27,"props":522,"children":523},{},[524,526,531],{"type":24,"value":525},"Serverless will add a ",{"type":18,"tag":152,"props":527,"children":528},{"className":10},[529],{"type":24,"value":530},"/dev",{"type":24,"value":532}," prefix to your URL path, and we need to configure Strapi to work around this later. This is a feature of API Gateway, and not easy to get around without using a custom domain.",{"type":18,"tag":27,"props":534,"children":535},{},[536],{"type":18,"tag":212,"props":537,"children":542},{"alt":538,"src":539,"style":540},"Untitled 4.png","/posts/serverless-strapi-tutorial/Untitled_4.png",{"aspectRatio":541},"630/610",[],{"type":18,"tag":27,"props":544,"children":545},{},[546],{"type":24,"value":547},"Now that we have it working locally, maybe we should try to deploy it to the cloud just to see that everything works as it should there too. Let Serverless deploy it with:",{"type":18,"tag":145,"props":549,"children":551},{"className":147,"code":550,"language":149,"meta":10,"style":10},"sls deploy --verbose\n",[552],{"type":18,"tag":152,"props":553,"children":554},{"__ignoreMap":10},[555],{"type":18,"tag":156,"props":556,"children":557},{"class":158,"line":159},[558,562,567],{"type":18,"tag":156,"props":559,"children":560},{"style":163},[561],{"type":24,"value":496},{"type":18,"tag":156,"props":563,"children":564},{"style":169},[565],{"type":24,"value":566}," deploy",{"type":18,"tag":156,"props":568,"children":569},{"style":185},[570],{"type":24,"value":571}," --verbose\n",{"type":18,"tag":27,"props":573,"children":574},{},[575],{"type":18,"tag":212,"props":576,"children":581},{"alt":577,"src":578,"style":579},"Untitled 5.png","/posts/serverless-strapi-tutorial/Untitled_5.png",{"aspectRatio":580},"955/612",[],{"type":18,"tag":27,"props":583,"children":584},{},[585],{"type":24,"value":586},"That did not work. The size of our application is way too large for Lambda. This is a common problem when attempting to run applications that are not at all designed for Lambda, in Lambda.",{"type":18,"tag":27,"props":588,"children":589},{},[590],{"type":24,"value":591},"Fortunately, it is quite easy to divide the Strapi monolith into a frontend and backend. Our plan is to host the frontend as a static website (which can practically be hosted anywhere), and the backend as a Serverless app in AWS Lambda.",{"type":18,"tag":73,"props":593,"children":595},{"id":594},"trimming-strapi",[596],{"type":24,"value":597},"Trimming Strapi",{"type":18,"tag":27,"props":599,"children":600},{},[601,603,610,612,616],{"type":24,"value":602},"First, let's follow the ",{"type":18,"tag":38,"props":604,"children":607},{"href":605,"rel":606},"https://strapi.io/documentation/v3.x/admin-panel/deploy.html#deploy-the-administration-panel-on-another-server-aws-s3-azure-etc-than-the-api",[42],[608],{"type":24,"value":609},"official guide",{"type":24,"value":611}," for running the admin part of Strapi separately, with some (maybe dirty) tricks to make it work well with our ",{"type":18,"tag":152,"props":613,"children":614},{"className":10},[615],{"type":24,"value":530},{"type":24,"value":617}," path prefix.",{"type":18,"tag":27,"props":619,"children":620},{},[621,623,628],{"type":24,"value":622},"Edit the config of ",{"type":18,"tag":152,"props":624,"children":625},{"className":10},[626],{"type":24,"value":627},"config/server.js",{"type":24,"value":629}," to disable the admin panel, and take care of the path prefix.",{"type":18,"tag":430,"props":631,"children":633},{"gist":632},"viktorfa/23847bd9f9926872f860455329b0153e",[],{"type":18,"tag":27,"props":635,"children":636},{},[637,639,644],{"type":24,"value":638},"We will also edit the build command in ",{"type":18,"tag":152,"props":640,"children":641},{"className":10},[642],{"type":24,"value":643},"package.json",{"type":24,"value":645}," to run a bash script after the normal build.",{"type":18,"tag":145,"props":647,"children":651},{"className":648,"code":649,"language":650,"meta":10,"style":10},"language-json shiki shiki-themes github-light github-dark","// package.json\n{\n    ...\n    \"build\": \"strapi build && ./scripts/post-build.sh\",\n    ...\n}\n","json",[652],{"type":18,"tag":152,"props":653,"children":654},{"__ignoreMap":10},[655,664,673,683,707,715],{"type":18,"tag":156,"props":656,"children":657},{"class":158,"line":159},[658],{"type":18,"tag":156,"props":659,"children":661},{"style":660},"--shiki-default:#6A737D;--shiki-dark:#6A737D",[662],{"type":24,"value":663},"// package.json\n",{"type":18,"tag":156,"props":665,"children":666},{"class":158,"line":378},[667],{"type":18,"tag":156,"props":668,"children":670},{"style":669},"--shiki-default:#24292E;--shiki-dark:#E1E4E8",[671],{"type":24,"value":672},"{\n",{"type":18,"tag":156,"props":674,"children":676},{"class":158,"line":675},3,[677],{"type":18,"tag":156,"props":678,"children":680},{"style":679},"--shiki-default:#B31D28;--shiki-dark:#FDAEB7;--shiki-default-font-style:italic;--shiki-dark-font-style:italic",[681],{"type":24,"value":682},"    ...\n",{"type":18,"tag":156,"props":684,"children":686},{"class":158,"line":685},4,[687,692,697,702],{"type":18,"tag":156,"props":688,"children":689},{"style":185},[690],{"type":24,"value":691},"    \"build\"",{"type":18,"tag":156,"props":693,"children":694},{"style":669},[695],{"type":24,"value":696},": ",{"type":18,"tag":156,"props":698,"children":699},{"style":169},[700],{"type":24,"value":701},"\"strapi build && ./scripts/post-build.sh\"",{"type":18,"tag":156,"props":703,"children":704},{"style":669},[705],{"type":24,"value":706},",\n",{"type":18,"tag":156,"props":708,"children":710},{"class":158,"line":709},5,[711],{"type":18,"tag":156,"props":712,"children":713},{"style":679},[714],{"type":24,"value":682},{"type":18,"tag":156,"props":716,"children":718},{"class":158,"line":717},6,[719],{"type":18,"tag":156,"props":720,"children":721},{"style":669},[722],{"type":24,"value":723},"}\n",{"type":18,"tag":27,"props":725,"children":726},{},[727,729,739,741,746],{"type":24,"value":728},"Create a script called ",{"type":18,"tag":38,"props":730,"children":733},{"href":731,"rel":732},"http://post-build.sh",[42],[734],{"type":18,"tag":152,"props":735,"children":736},{"className":10},[737],{"type":24,"value":738},"post-build.sh",{"type":24,"value":740}," in a new folder called ",{"type":18,"tag":152,"props":742,"children":743},{"className":10},[744],{"type":24,"value":745},"scripts/",{"type":24,"value":747},". Make it executable with:",{"type":18,"tag":145,"props":749,"children":751},{"className":147,"code":750,"language":149,"meta":10,"style":10},"chmod +x scripts/post-build.sh\n",[752],{"type":18,"tag":152,"props":753,"children":754},{"__ignoreMap":10},[755],{"type":18,"tag":156,"props":756,"children":757},{"class":158,"line":159},[758,763,768],{"type":18,"tag":156,"props":759,"children":760},{"style":163},[761],{"type":24,"value":762},"chmod",{"type":18,"tag":156,"props":764,"children":765},{"style":169},[766],{"type":24,"value":767}," +x",{"type":18,"tag":156,"props":769,"children":770},{"style":169},[771],{"type":24,"value":772}," scripts/post-build.sh\n",{"type":18,"tag":430,"props":774,"children":776},{"gist":775},"viktorfa/4d0d3e1d9f6f317d7037bcead27f28c0",[],{"type":18,"tag":27,"props":778,"children":779},{},[780,782,787,789,793],{"type":24,"value":781},"The script simply moves the bundle files in ",{"type":18,"tag":152,"props":783,"children":784},{"className":10},[785],{"type":24,"value":786},"build/",{"type":24,"value":788}," to a sub folder called ",{"type":18,"tag":152,"props":790,"children":791},{"className":10},[792],{"type":24,"value":530},{"type":24,"value":794}," which fixes the issue with our path prefixes.",{"type":18,"tag":27,"props":796,"children":797},{},[798],{"type":24,"value":799},"Build the admin panel with:",{"type":18,"tag":145,"props":801,"children":803},{"className":147,"code":802,"language":149,"meta":10,"style":10},"IS_OFFLINE=true yarn build\n",[804],{"type":18,"tag":152,"props":805,"children":806},{"__ignoreMap":10},[807],{"type":18,"tag":156,"props":808,"children":809},{"class":158,"line":159},[810,815,821,826,831],{"type":18,"tag":156,"props":811,"children":812},{"style":669},[813],{"type":24,"value":814},"IS_OFFLINE",{"type":18,"tag":156,"props":816,"children":818},{"style":817},"--shiki-default:#D73A49;--shiki-dark:#F97583",[819],{"type":24,"value":820},"=",{"type":18,"tag":156,"props":822,"children":823},{"style":185},[824],{"type":24,"value":825},"true",{"type":18,"tag":156,"props":827,"children":828},{"style":163},[829],{"type":24,"value":830}," yarn",{"type":18,"tag":156,"props":832,"children":833},{"style":169},[834],{"type":24,"value":835}," build\n",{"type":18,"tag":27,"props":837,"children":838},{},[839],{"type":18,"tag":212,"props":840,"children":845},{"alt":841,"src":842,"style":843},"Untitled 6.png","/posts/serverless-strapi-tutorial/Untitled_6.png",{"aspectRatio":844},"468/171",[],{"type":18,"tag":27,"props":847,"children":848},{},[849,851,856],{"type":24,"value":850},"Verify that the current setup works by starting the serverless-offline app with ",{"type":18,"tag":152,"props":852,"children":853},{"className":10},[854],{"type":24,"value":855},"sls offline",{"type":24,"value":857},", and then serve the frontend as a separate static site.",{"type":18,"tag":27,"props":859,"children":860},{},[861],{"type":24,"value":862},"You can serve the frontend with",{"type":18,"tag":145,"props":864,"children":866},{"className":147,"code":865,"language":149,"meta":10,"style":10},"npm i -g serve\nserve build/\n",[867],{"type":18,"tag":152,"props":868,"children":869},{"__ignoreMap":10},[870,893],{"type":18,"tag":156,"props":871,"children":872},{"class":158,"line":159},[873,878,883,888],{"type":18,"tag":156,"props":874,"children":875},{"style":163},[876],{"type":24,"value":877},"npm",{"type":18,"tag":156,"props":879,"children":880},{"style":169},[881],{"type":24,"value":882}," i",{"type":18,"tag":156,"props":884,"children":885},{"style":185},[886],{"type":24,"value":887}," -g",{"type":18,"tag":156,"props":889,"children":890},{"style":169},[891],{"type":24,"value":892}," serve\n",{"type":18,"tag":156,"props":894,"children":895},{"class":158,"line":378},[896,901],{"type":18,"tag":156,"props":897,"children":898},{"style":163},[899],{"type":24,"value":900},"serve",{"type":18,"tag":156,"props":902,"children":903},{"style":169},[904],{"type":24,"value":905}," build/\n",{"type":18,"tag":27,"props":907,"children":908},{},[909],{"type":18,"tag":212,"props":910,"children":915},{"alt":911,"src":912,"style":913},"Untitled 7.png","/posts/serverless-strapi-tutorial/Untitled_7.png",{"aspectRatio":914},"947/335",[],{"type":18,"tag":27,"props":917,"children":918},{},[919,921,926],{"type":24,"value":920},"Go to ",{"type":18,"tag":152,"props":922,"children":923},{"className":10},[924],{"type":24,"value":925},"http://localhost:5000",{"type":24,"value":927}," and check that Strapi still works. Remember to run sls offline in the background.",{"type":18,"tag":27,"props":929,"children":930},{},[931],{"type":24,"value":932},"It may be boring to move slowly and double check everything. One thing I've learnt using Serverless and AWS Lambda is that you will spend hours debugging the most trivial things and cryptic error messages if you don't double check and isolate everything at every step.",{"type":18,"tag":27,"props":934,"children":935},{},[936],{"type":24,"value":937},"If you can still use the Strapi admin, everything is going well.",{"type":18,"tag":27,"props":939,"children":940},{},[941,943,948],{"type":24,"value":942},"The size of our code is still not small enough to be used in Lambda, so we need to trim more. Let's explore ",{"type":18,"tag":152,"props":944,"children":945},{"className":10},[946],{"type":24,"value":947},"node_modules",{"type":24,"value":207},{"type":18,"tag":27,"props":950,"children":951},{},[952],{"type":18,"tag":212,"props":953,"children":958},{"alt":954,"src":955,"style":956},"Untitled 8.png","/posts/serverless-strapi-tutorial/Untitled_8.png",{"aspectRatio":957},"956/645",[],{"type":18,"tag":27,"props":960,"children":961},{},[962,964,968],{"type":24,"value":963},"We see ",{"type":18,"tag":152,"props":965,"children":966},{"className":10},[967],{"type":24,"value":947},{"type":24,"value":969}," is a whopping 561 MB. We also see a lot of fat packages that are definitely only for frontend use, such as those containing \"react\", \"fortawesome\", or \"bootstrap\". We also see that some locale-data, which is just translations, use most space of all.",{"type":18,"tag":27,"props":971,"children":972},{},[973,975,979,981,991],{"type":24,"value":974},"It would be great if Strapi automagically removed all frontend stuff from ",{"type":18,"tag":152,"props":976,"children":977},{"className":10},[978],{"type":24,"value":947},{"type":24,"value":980}," when we run the backend on a separate server, but I don't know of any such functionality. We will therefore manually delete some excessive packages with some simple commands we put in a bash script aptly called ",{"type":18,"tag":38,"props":982,"children":985},{"href":983,"rel":984},"http://trim-node-modules.sh/",[42],[986],{"type":18,"tag":152,"props":987,"children":988},{"className":10},[989],{"type":24,"value":990},"trim-node-modules.sh",{"type":24,"value":207},{"type":18,"tag":430,"props":993,"children":995},{"gist":994},"viktorfa/972a4ea019fdd1f0861059a9299df544",[],{"type":18,"tag":27,"props":997,"children":998},{},[999,1001,1006],{"type":24,"value":1000},"Install a neat tool called ",{"type":18,"tag":83,"props":1002,"children":1003},{},[1004],{"type":24,"value":1005},"node-prune",{"type":24,"value":1007}," first, which automatically removes files that are certainly unnecessary, such as Readmes etc. Get it done with:",{"type":18,"tag":145,"props":1009,"children":1011},{"className":147,"code":1010,"language":149,"meta":10,"style":10},"npm i -g node-prune\nchmod +x scripts/trim-node-modules.sh\n./scripts/trim-node-modules.sh\n",[1012],{"type":18,"tag":152,"props":1013,"children":1014},{"__ignoreMap":10},[1015,1035,1051],{"type":18,"tag":156,"props":1016,"children":1017},{"class":158,"line":159},[1018,1022,1026,1030],{"type":18,"tag":156,"props":1019,"children":1020},{"style":163},[1021],{"type":24,"value":877},{"type":18,"tag":156,"props":1023,"children":1024},{"style":169},[1025],{"type":24,"value":882},{"type":18,"tag":156,"props":1027,"children":1028},{"style":185},[1029],{"type":24,"value":887},{"type":18,"tag":156,"props":1031,"children":1032},{"style":169},[1033],{"type":24,"value":1034}," node-prune\n",{"type":18,"tag":156,"props":1036,"children":1037},{"class":158,"line":378},[1038,1042,1046],{"type":18,"tag":156,"props":1039,"children":1040},{"style":163},[1041],{"type":24,"value":762},{"type":18,"tag":156,"props":1043,"children":1044},{"style":169},[1045],{"type":24,"value":767},{"type":18,"tag":156,"props":1047,"children":1048},{"style":169},[1049],{"type":24,"value":1050}," scripts/trim-node-modules.sh\n",{"type":18,"tag":156,"props":1052,"children":1053},{"class":158,"line":675},[1054],{"type":18,"tag":156,"props":1055,"children":1056},{"style":163},[1057],{"type":24,"value":1058},"./scripts/trim-node-modules.sh\n",{"type":18,"tag":27,"props":1060,"children":1061},{},[1062,1064,1068],{"type":24,"value":1063},"That should reduce the size of ",{"type":18,"tag":152,"props":1065,"children":1066},{"className":10},[1067],{"type":24,"value":947},{"type":24,"value":1069}," to around 287MB without losing anything we need for the backend.",{"type":18,"tag":27,"props":1071,"children":1072},{},[1073],{"type":24,"value":1074},"Finish this step by successfully deploying with:",{"type":18,"tag":145,"props":1076,"children":1077},{"className":147,"code":550,"language":149,"meta":10,"style":10},[1078],{"type":18,"tag":152,"props":1079,"children":1080},{"__ignoreMap":10},[1081],{"type":18,"tag":156,"props":1082,"children":1083},{"class":158,"line":159},[1084,1088,1092],{"type":18,"tag":156,"props":1085,"children":1086},{"style":163},[1087],{"type":24,"value":496},{"type":18,"tag":156,"props":1089,"children":1090},{"style":169},[1091],{"type":24,"value":566},{"type":18,"tag":156,"props":1093,"children":1094},{"style":185},[1095],{"type":24,"value":571},{"type":18,"tag":27,"props":1097,"children":1098},{},[1099],{"type":18,"tag":212,"props":1100,"children":1105},{"alt":1101,"src":1102,"style":1103},"Untitled 9.png","/posts/serverless-strapi-tutorial/Untitled_9.png",{"aspectRatio":1104},"621/500",[],{"type":18,"tag":27,"props":1107,"children":1108},{},[1109],{"type":24,"value":1110},"Stack update finished... ",{"type":18,"tag":27,"props":1112,"children":1113},{},[1114,1116,1122],{"type":24,"value":1115},"That's what we want to see. The backend is now available online, and you can check it by visiting the generated endpoint (",{"type":18,"tag":38,"props":1117,"children":1120},{"href":1118,"rel":1119},"https://7s7w7gyekl.execute-api.us-east-1.amazonaws.com/dev/",[42],[1121],{"type":24,"value":1118},{"type":24,"value":1123}," for me).",{"type":18,"tag":27,"props":1125,"children":1126},{},[1127],{"type":18,"tag":212,"props":1128,"children":1133},{"alt":1129,"src":1130,"style":1131},"Untitled 10.png","/posts/serverless-strapi-tutorial/Untitled_10.png",{"aspectRatio":1132},"1097/500",[],{"type":18,"tag":27,"props":1135,"children":1136},{},[1137],{"type":24,"value":1138},"Our database is not at all suitable for Lambda, as it's an SQLite db where the data is stored in the local filesystem which can reset between Lambda invocations. However, it should work for demonstration purposes.",{"type":18,"tag":27,"props":1140,"children":1141},{},[1142],{"type":24,"value":1143},"Check your logs with:",{"type":18,"tag":145,"props":1145,"children":1147},{"className":147,"code":1146,"language":149,"meta":10,"style":10},"sls logs --function api --tail\n",[1148],{"type":18,"tag":152,"props":1149,"children":1150},{"__ignoreMap":10},[1151],{"type":18,"tag":156,"props":1152,"children":1153},{"class":158,"line":159},[1154,1158,1163,1168,1173],{"type":18,"tag":156,"props":1155,"children":1156},{"style":163},[1157],{"type":24,"value":496},{"type":18,"tag":156,"props":1159,"children":1160},{"style":169},[1161],{"type":24,"value":1162}," logs",{"type":18,"tag":156,"props":1164,"children":1165},{"style":185},[1166],{"type":24,"value":1167}," --function",{"type":18,"tag":156,"props":1169,"children":1170},{"style":169},[1171],{"type":24,"value":1172}," api",{"type":18,"tag":156,"props":1174,"children":1175},{"style":185},[1176],{"type":24,"value":1177}," --tail\n",{"type":18,"tag":27,"props":1179,"children":1180},{},[1181],{"type":18,"tag":212,"props":1182,"children":1187},{"alt":1183,"src":1184,"style":1185},"Untitled 11.png","/posts/serverless-strapi-tutorial/Untitled_11.png",{"aspectRatio":1186},"951/854",[],{"type":18,"tag":27,"props":1189,"children":1190},{},[1191,1193,1197],{"type":24,"value":1192},"Update ",{"type":18,"tag":152,"props":1194,"children":1195},{"className":10},[1196],{"type":24,"value":627},{"type":24,"value":1198}," with the newly generated endpoint.",{"type":18,"tag":145,"props":1200,"children":1204},{"className":1201,"code":1202,"language":1203,"meta":10,"style":10},"language-jsx shiki shiki-themes github-light github-dark","// config/server.js\n\n// ...\nlet url = \"https://7s7w7gyekl.execute-api.us-east-1.amazonaws.com\";\n// ...\n","jsx",[1205],{"type":18,"tag":152,"props":1206,"children":1207},{"__ignoreMap":10},[1208,1216,1225,1233,1260],{"type":18,"tag":156,"props":1209,"children":1210},{"class":158,"line":159},[1211],{"type":18,"tag":156,"props":1212,"children":1213},{"style":660},[1214],{"type":24,"value":1215},"// config/server.js\n",{"type":18,"tag":156,"props":1217,"children":1218},{"class":158,"line":378},[1219],{"type":18,"tag":156,"props":1220,"children":1222},{"emptyLinePlaceholder":1221},true,[1223],{"type":24,"value":1224},"\n",{"type":18,"tag":156,"props":1226,"children":1227},{"class":158,"line":675},[1228],{"type":18,"tag":156,"props":1229,"children":1230},{"style":660},[1231],{"type":24,"value":1232},"// ...\n",{"type":18,"tag":156,"props":1234,"children":1235},{"class":158,"line":685},[1236,1241,1246,1250,1255],{"type":18,"tag":156,"props":1237,"children":1238},{"style":817},[1239],{"type":24,"value":1240},"let",{"type":18,"tag":156,"props":1242,"children":1243},{"style":669},[1244],{"type":24,"value":1245}," url ",{"type":18,"tag":156,"props":1247,"children":1248},{"style":817},[1249],{"type":24,"value":820},{"type":18,"tag":156,"props":1251,"children":1252},{"style":169},[1253],{"type":24,"value":1254}," \"https://7s7w7gyekl.execute-api.us-east-1.amazonaws.com\"",{"type":18,"tag":156,"props":1256,"children":1257},{"style":669},[1258],{"type":24,"value":1259},";\n",{"type":18,"tag":156,"props":1261,"children":1262},{"class":158,"line":709},[1263],{"type":18,"tag":156,"props":1264,"children":1265},{"style":660},[1266],{"type":24,"value":1232},{"type":18,"tag":27,"props":1268,"children":1269},{},[1270],{"type":24,"value":1271},"Let's build the frontend again with the new endpoint in the config. Don't forget to delete the old build folder and reinstall the frontend packages we deleted previously.",{"type":18,"tag":145,"props":1273,"children":1275},{"className":147,"code":1274,"language":149,"meta":10,"style":10},"rm -rf build/\nyarn\nyarn build\nserve build/\n",[1276],{"type":18,"tag":152,"props":1277,"children":1278},{"__ignoreMap":10},[1279,1296,1304,1315],{"type":18,"tag":156,"props":1280,"children":1281},{"class":158,"line":159},[1282,1287,1292],{"type":18,"tag":156,"props":1283,"children":1284},{"style":163},[1285],{"type":24,"value":1286},"rm",{"type":18,"tag":156,"props":1288,"children":1289},{"style":185},[1290],{"type":24,"value":1291}," -rf",{"type":18,"tag":156,"props":1293,"children":1294},{"style":169},[1295],{"type":24,"value":905},{"type":18,"tag":156,"props":1297,"children":1298},{"class":158,"line":378},[1299],{"type":18,"tag":156,"props":1300,"children":1301},{"style":163},[1302],{"type":24,"value":1303},"yarn\n",{"type":18,"tag":156,"props":1305,"children":1306},{"class":158,"line":675},[1307,1311],{"type":18,"tag":156,"props":1308,"children":1309},{"style":163},[1310],{"type":24,"value":166},{"type":18,"tag":156,"props":1312,"children":1313},{"style":169},[1314],{"type":24,"value":835},{"type":18,"tag":156,"props":1316,"children":1317},{"class":158,"line":685},[1318,1322],{"type":18,"tag":156,"props":1319,"children":1320},{"style":163},[1321],{"type":24,"value":900},{"type":18,"tag":156,"props":1323,"children":1324},{"style":169},[1325],{"type":24,"value":905},{"type":18,"tag":27,"props":1327,"children":1328},{},[1329,1331,1335],{"type":24,"value":1330},"Visit ",{"type":18,"tag":152,"props":1332,"children":1333},{"className":10},[1334],{"type":24,"value":925},{"type":24,"value":1336}," and make sure Strapi is working as before.",{"type":18,"tag":19,"props":1338,"children":1340},{"id":1339},"make-a-serverless-database-and-file-storage",[1341],{"type":24,"value":1342},"Make a serverless database and file storage",{"type":18,"tag":27,"props":1344,"children":1345},{},[1346],{"type":24,"value":1347},"So far we have divided Strapi into two components: 1) a static website frontend and 2) a backend running on Lambda accessible through API Gateway. We will add two additional components. The backend also needs 3) a database and 4) a static file storage for images and other files we upload.",{"type":18,"tag":27,"props":1349,"children":1350},{},[1351],{"type":24,"value":1352},"All the components should have the serverless properties. Scalable, pay-per-use, and no touch ops. For static file storage, we will use Amazon S3 file storage, which is not only highly appropriate for the task, but Strapi also comes with a plugin for S3.",{"type":18,"tag":27,"props":1354,"children":1355},{},[1356],{"type":24,"value":1357},"The database is more tricky. It's possible to create a DynamoDB connector to Strapi, but that would limit the index flexibility of Strapi, and remove full text search. Let's consider the options.",{"type":18,"tag":27,"props":1359,"children":1360},{},[1361],{"type":18,"tag":38,"props":1362,"children":1365},{"href":1363,"rel":1364},"https://www.notion.so/6fefceebc6414fec8b6939e7030d409d",[42],[1366],{"type":24,"value":1367},"Databases for Strapi Serverless",{"type":18,"tag":27,"props":1369,"children":1370},{},[1371],{"type":24,"value":1372},"DynamoDB does not work with Strapi without a connector we would have to create ourselves.",{"type":18,"tag":27,"props":1374,"children":1375},{},[1376],{"type":24,"value":1377},"Aurora is a managed relational database offered by Amazon. It is compatible with PostgreSQL or MySQL. It has a \"serverless\" configuration setting which enables sleep when inactive and auto scaling. The AWS managed databases like Aurora are only available within a Virtual Private Cloud (VPC). Having our Lambda function in the same VPC means it loses internet access without further configuration and costs, so we won't use that option in this tutorial.",{"type":18,"tag":27,"props":1379,"children":1380},{},[1381,1383,1390],{"type":24,"value":1382},"We can use an external database such as Mongo hosted with ",{"type":18,"tag":38,"props":1384,"children":1387},{"href":1385,"rel":1386},"https://www.mongodb.com/cloud/atlas",[42],[1388],{"type":24,"value":1389},"Mongo Atlas",{"type":24,"value":1391},". It is not serverless, but it is managed and possible to scale by just upgrading a subscription. You can also host your own SQL or Mongo instance either in the Amazon cloud or somewhere else.",{"type":18,"tag":27,"props":1393,"children":1394},{},[1395],{"type":24,"value":1396},"We don't have a perfect database option for all uses cases. If you use Strapi as a CMS or static sites, the database performance is not a priority at all, so we choose something that is easy to set up and has a free offering. This tutorial will show how to use Mongo Atlas.",{"type":18,"tag":73,"props":1398,"children":1400},{"id":1399},"set-up-mongo",[1401],{"type":24,"value":1402},"Set up Mongo",{"type":18,"tag":27,"props":1404,"children":1405},{},[1406,1408,1415],{"type":24,"value":1407},"Just ",{"type":18,"tag":38,"props":1409,"children":1412},{"href":1410,"rel":1411},"https://www.mongodb.com/cloud/atlas/register",[42],[1413],{"type":24,"value":1414},"create an account",{"type":24,"value":1416}," and set up a free Mongo cluster in Atlas for the purpose of this tutorial. You must create a database user with a username and password, then get the connection URI and insert it as an environment variable to our Lambda function.",{"type":18,"tag":27,"props":1418,"children":1419},{},[1420],{"type":18,"tag":212,"props":1421,"children":1426},{"alt":1422,"src":1423,"style":1424},"Untitled 12.png","/posts/serverless-strapi-tutorial/Untitled_12.png",{"aspectRatio":1425},"923/262",[],{"type":18,"tag":27,"props":1428,"children":1429},{},[1430],{"type":24,"value":1431},"Get the connection URI string in Cluster > Connect > Connect your application.",{"type":18,"tag":27,"props":1433,"children":1434},{},[1435],{"type":18,"tag":212,"props":1436,"children":1441},{"alt":1437,"src":1438,"style":1439},"Untitled 13.png","/posts/serverless-strapi-tutorial/Untitled_13.png",{"aspectRatio":1440},"887/666",[],{"type":18,"tag":27,"props":1443,"children":1444},{},[1445],{"type":24,"value":1446},"Add the connection URI as an environment variable.",{"type":18,"tag":145,"props":1448,"children":1450},{"className":147,"code":1449,"language":149,"meta":10,"style":10},"# serverless.yml\nprovider:\n    # ...\n    environment:\n        MONGODB_URI \"mongodb+srv://strapiowner:PASSWORD@cluster0.weldo.mongodb.net/strapi?retryWrites=true&w=majority\"\n",[1451],{"type":18,"tag":152,"props":1452,"children":1453},{"__ignoreMap":10},[1454,1462,1470,1478,1486],{"type":18,"tag":156,"props":1455,"children":1456},{"class":158,"line":159},[1457],{"type":18,"tag":156,"props":1458,"children":1459},{"style":660},[1460],{"type":24,"value":1461},"# serverless.yml\n",{"type":18,"tag":156,"props":1463,"children":1464},{"class":158,"line":378},[1465],{"type":18,"tag":156,"props":1466,"children":1467},{"style":163},[1468],{"type":24,"value":1469},"provider:\n",{"type":18,"tag":156,"props":1471,"children":1472},{"class":158,"line":675},[1473],{"type":18,"tag":156,"props":1474,"children":1475},{"style":660},[1476],{"type":24,"value":1477},"    # ...\n",{"type":18,"tag":156,"props":1479,"children":1480},{"class":158,"line":685},[1481],{"type":18,"tag":156,"props":1482,"children":1483},{"style":163},[1484],{"type":24,"value":1485},"    environment:\n",{"type":18,"tag":156,"props":1487,"children":1488},{"class":158,"line":709},[1489,1494],{"type":18,"tag":156,"props":1490,"children":1491},{"style":163},[1492],{"type":24,"value":1493},"        MONGODB_URI",{"type":18,"tag":156,"props":1495,"children":1496},{"style":169},[1497],{"type":24,"value":1498}," \"mongodb+srv://strapiowner:PASSWORD@cluster0.weldo.mongodb.net/strapi?retryWrites=true&w=majority\"\n",{"type":18,"tag":27,"props":1500,"children":1501},{},[1502,1504,1508],{"type":24,"value":1503},"We then edit ",{"type":18,"tag":152,"props":1505,"children":1506},{"className":10},[1507],{"type":24,"value":463},{"type":24,"value":1509}," to tell Strapi to use the Mongo database.",{"type":18,"tag":430,"props":1511,"children":1513},{"gist":1512},"viktorfa/3975ee2e67f38e885d02b4e2c4c1097e",[],{"type":18,"tag":27,"props":1515,"children":1516},{},[1517],{"type":24,"value":1518},"Lastly, install the Strapi connector for Mongo:",{"type":18,"tag":145,"props":1520,"children":1522},{"className":147,"code":1521,"language":149,"meta":10,"style":10},"yarn add strapi-connector-mongoose\n",[1523],{"type":18,"tag":152,"props":1524,"children":1525},{"__ignoreMap":10},[1526],{"type":18,"tag":156,"props":1527,"children":1528},{"class":158,"line":159},[1529,1533,1537],{"type":18,"tag":156,"props":1530,"children":1531},{"style":163},[1532],{"type":24,"value":166},{"type":18,"tag":156,"props":1534,"children":1535},{"style":169},[1536],{"type":24,"value":365},{"type":18,"tag":156,"props":1538,"children":1539},{"style":169},[1540],{"type":24,"value":1541}," strapi-connector-mongoose\n",{"type":18,"tag":27,"props":1543,"children":1544},{},[1545,1547,1551,1553,1558],{"type":24,"value":1546},"You can now start Strapi with  ",{"type":18,"tag":152,"props":1548,"children":1549},{"className":10},[1550],{"type":24,"value":855},{"type":24,"value":1552}," and check that it works locally by visiting ",{"type":18,"tag":152,"props":1554,"children":1555},{"className":10},[1556],{"type":24,"value":1557},"http://localhost:3000/dev",{"type":24,"value":1559},". While it should work i the cloud as well, it's good to double check by deploying with:",{"type":18,"tag":145,"props":1561,"children":1563},{"className":147,"code":1562,"language":149,"meta":10,"style":10},"yarn && ./scripts/trim-node-modules.sh\nsls deploy --verbose\n",[1564],{"type":18,"tag":152,"props":1565,"children":1566},{"__ignoreMap":10},[1567,1583],{"type":18,"tag":156,"props":1568,"children":1569},{"class":158,"line":159},[1570,1574,1579],{"type":18,"tag":156,"props":1571,"children":1572},{"style":163},[1573],{"type":24,"value":166},{"type":18,"tag":156,"props":1575,"children":1576},{"style":669},[1577],{"type":24,"value":1578}," && ",{"type":18,"tag":156,"props":1580,"children":1581},{"style":163},[1582],{"type":24,"value":1058},{"type":18,"tag":156,"props":1584,"children":1585},{"class":158,"line":378},[1586,1590,1594],{"type":18,"tag":156,"props":1587,"children":1588},{"style":163},[1589],{"type":24,"value":496},{"type":18,"tag":156,"props":1591,"children":1592},{"style":169},[1593],{"type":24,"value":566},{"type":18,"tag":156,"props":1595,"children":1596},{"style":185},[1597],{"type":24,"value":571},{"type":18,"tag":73,"props":1599,"children":1601},{"id":1600},"cloudformation-of-s3",[1602],{"type":24,"value":1603},"Cloudformation of S3",{"type":18,"tag":27,"props":1605,"children":1606},{},[1607,1609,1614],{"type":24,"value":1608},"We create a simple S3 bucket in our Cloudformation templates. An advantage of the Serverless framework is the ",{"type":18,"tag":83,"props":1610,"children":1611},{},[1612],{"type":24,"value":1613},"infrastructure as code",{"type":24,"value":1615}," comes included to a large degree, so managing resources like S3 buckets is controlled and checked in your Git repo.",{"type":18,"tag":27,"props":1617,"children":1618},{},[1619,1621,1626,1628,1633,1634,1639,1641,1646,1648,1652],{"type":24,"value":1620},"We edit the ",{"type":18,"tag":152,"props":1622,"children":1623},{"className":10},[1624],{"type":24,"value":1625},"provider",{"type":24,"value":1627},", ",{"type":18,"tag":152,"props":1629,"children":1630},{"className":10},[1631],{"type":24,"value":1632},"custom",{"type":24,"value":1627},{"type":18,"tag":152,"props":1635,"children":1636},{"className":10},[1637],{"type":24,"value":1638},"plugins",{"type":24,"value":1640},", and ",{"type":18,"tag":152,"props":1642,"children":1643},{"className":10},[1644],{"type":24,"value":1645},"resources",{"type":24,"value":1647}," sections of our ",{"type":18,"tag":152,"props":1649,"children":1650},{"className":10},[1651],{"type":24,"value":337},{"type":24,"value":1653}," config.",{"type":18,"tag":430,"props":1655,"children":1657},{"gist":1656},"viktorfa/76e6ee19dd53e3f1a03db360eabb5263",[],{"type":18,"tag":27,"props":1659,"children":1660},{},[1661],{"type":24,"value":1662},"Install the Strapi provider for S3 upload and two other plugins:",{"type":18,"tag":145,"props":1664,"children":1666},{"className":147,"code":1665,"language":149,"meta":10,"style":10},"yarn add strapi-provider-upload-aws-s3\nyarn add -D serverless-apigw-binary\nyarn add -D serverless-cloudformation-sub-variables\n",[1667],{"type":18,"tag":152,"props":1668,"children":1669},{"__ignoreMap":10},[1670,1686,1706],{"type":18,"tag":156,"props":1671,"children":1672},{"class":158,"line":159},[1673,1677,1681],{"type":18,"tag":156,"props":1674,"children":1675},{"style":163},[1676],{"type":24,"value":166},{"type":18,"tag":156,"props":1678,"children":1679},{"style":169},[1680],{"type":24,"value":365},{"type":18,"tag":156,"props":1682,"children":1683},{"style":169},[1684],{"type":24,"value":1685}," strapi-provider-upload-aws-s3\n",{"type":18,"tag":156,"props":1687,"children":1688},{"class":158,"line":378},[1689,1693,1697,1701],{"type":18,"tag":156,"props":1690,"children":1691},{"style":163},[1692],{"type":24,"value":166},{"type":18,"tag":156,"props":1694,"children":1695},{"style":169},[1696],{"type":24,"value":365},{"type":18,"tag":156,"props":1698,"children":1699},{"style":185},[1700],{"type":24,"value":370},{"type":18,"tag":156,"props":1702,"children":1703},{"style":169},[1704],{"type":24,"value":1705}," serverless-apigw-binary\n",{"type":18,"tag":156,"props":1707,"children":1708},{"class":158,"line":675},[1709,1713,1717,1721],{"type":18,"tag":156,"props":1710,"children":1711},{"style":163},[1712],{"type":24,"value":166},{"type":18,"tag":156,"props":1714,"children":1715},{"style":169},[1716],{"type":24,"value":365},{"type":18,"tag":156,"props":1718,"children":1719},{"style":185},[1720],{"type":24,"value":370},{"type":18,"tag":156,"props":1722,"children":1723},{"style":169},[1724],{"type":24,"value":1725}," serverless-cloudformation-sub-variables\n",{"type":18,"tag":27,"props":1727,"children":1728},{},[1729,1731,1736,1738,1743,1745,1749,1751,1755,1757,1762],{"type":24,"value":1730},"We need to add some config in a new file called ",{"type":18,"tag":152,"props":1732,"children":1733},{"className":10},[1734],{"type":24,"value":1735},"config/plugins.js",{"type":24,"value":1737},". S3 in Lambda works quite automagically, so the only config we need is the bucket name. Note that the BUCKET_NAME environment variable will be \"",{"type":18,"tag":156,"props":1739,"children":1740},{},[1741],{"type":24,"value":1742},"Object object",{"type":24,"value":1744},"\" if you run locally with ",{"type":18,"tag":152,"props":1746,"children":1747},{"className":10},[1748],{"type":24,"value":855},{"type":24,"value":1750},", because we get the bucket name in ",{"type":18,"tag":152,"props":1752,"children":1753},{"className":10},[1754],{"type":24,"value":337},{"type":24,"value":1756}," with a Cloudformation ",{"type":18,"tag":83,"props":1758,"children":1759},{},[1760],{"type":24,"value":1761},"!Ref",{"type":24,"value":1763},". After you deploy, you get the name of your S3 bucket which you can use to test with S3 locally later.",{"type":18,"tag":430,"props":1765,"children":1767},{"gist":1766},"viktorfa/6d8973dd95998b1325f4f8c981e08bf8",[],{"type":18,"tag":27,"props":1769,"children":1770},{},[1771],{"type":24,"value":1772},"To create the S3 bucket, deploy with",{"type":18,"tag":145,"props":1774,"children":1776},{"className":147,"code":1775,"language":149,"meta":10,"style":10},"./scripts/trim-node-modules.sh\nsls deploy --verbose\n",[1777],{"type":18,"tag":152,"props":1778,"children":1779},{"__ignoreMap":10},[1780,1787],{"type":18,"tag":156,"props":1781,"children":1782},{"class":158,"line":159},[1783],{"type":18,"tag":156,"props":1784,"children":1785},{"style":163},[1786],{"type":24,"value":1058},{"type":18,"tag":156,"props":1788,"children":1789},{"class":158,"line":378},[1790,1794,1798],{"type":18,"tag":156,"props":1791,"children":1792},{"style":163},[1793],{"type":24,"value":496},{"type":18,"tag":156,"props":1795,"children":1796},{"style":169},[1797],{"type":24,"value":566},{"type":18,"tag":156,"props":1799,"children":1800},{"style":185},[1801],{"type":24,"value":571},{"type":18,"tag":27,"props":1803,"children":1804},{},[1805,1807,1811],{"type":24,"value":1806},"Once deployed, visit ",{"type":18,"tag":152,"props":1808,"children":1809},{"className":10},[1810],{"type":24,"value":925},{"type":24,"value":1812}," to visit the admin user interface. Go to Media Library and try to upload a file.",{"type":18,"tag":27,"props":1814,"children":1815},{},[1816],{"type":18,"tag":212,"props":1817,"children":1822},{"alt":1818,"src":1819,"style":1820},"Untitled 14.png","/posts/serverless-strapi-tutorial/Untitled_14.png",{"aspectRatio":1821},"709/237",[],{"type":18,"tag":27,"props":1824,"children":1825},{},[1826],{"type":18,"tag":212,"props":1827,"children":1832},{"alt":1828,"src":1829,"style":1830},"Untitled 15.png","/posts/serverless-strapi-tutorial/Untitled_15.png",{"aspectRatio":1831},"1499/532",[],{"type":18,"tag":27,"props":1834,"children":1835},{},[1836,1841,1843,1848,1850,1855,1857,1862],{"type":18,"tag":97,"props":1837,"children":1838},{},[1839],{"type":24,"value":1840},"File upload and API Gateway",{"type":24,"value":1842},"\nUploading files when using Serverless can be a bit of a hassle. All HTTP requests goes through an Amazon service called API Gateway. This gateway processes files in a certain way.\nUploads are often in a binary format, and we need to tell API Gateway explicitly which content types it should handle as binary files.\nIn Strapi the content type is ",{"type":18,"tag":152,"props":1844,"children":1845},{"className":10},[1846],{"type":24,"value":1847},"multipart/form-data",{"type":24,"value":1849},", and we configure this with the ",{"type":18,"tag":152,"props":1851,"children":1852},{"className":10},[1853],{"type":24,"value":1854},"serverless-apigw-binary",{"type":24,"value":1856}," plugin. DON'T add \"",{"type":18,"tag":83,"props":1858,"children":1859},{},[1860],{"type":24,"value":1861},"/",{"type":24,"value":1863},"\" as a content-type, as this will break the CORS configuration of your API.",{"type":18,"tag":19,"props":1865,"children":1867},{"id":1866},"wrapping-up",[1868],{"type":24,"value":1869},"Wrapping up",{"type":18,"tag":27,"props":1871,"children":1872},{},[1873],{"type":24,"value":1874},"You know have a scalable Strapi instance that is paid on a pay-per-use basis. Unfortunately, we were not able to make the database as serverless as the rest of the application, but for many use, cases, such as when Strapi is a backend for a CMS to a static site, this is of little significance.",{"type":18,"tag":73,"props":1876,"children":1878},{"id":1877},"multi-tenancy-and-strapi-as-headless-cms",[1879],{"type":24,"value":1880},"Multi tenancy and Strapi as headless CMS",{"type":18,"tag":27,"props":1882,"children":1883},{},[1884],{"type":24,"value":1885},"Strapi does not support multi tenancy. Meaning if you have a portfolio of websites that use Strapi as a CMS, each website needs its own Strapi instance. This is a major weakness of Strapi in my opinion. Wordpress supports multisite config, and many hosting providers have support for unlimited Wordpress instances on a single subscription, which is possible because Wordpress supports multi tenancy.",{"type":18,"tag":27,"props":1887,"children":1888},{},[1889],{"type":24,"value":1890},"Many managed CMSs such as Contentful charge on a per user and per project basis. Meaning you have to pay much more once you want people to cooperate on a project or you have many projects.",{"type":18,"tag":27,"props":1892,"children":1893},{},[1894],{"type":24,"value":1895},"Our Serverless Strapi allows scalable multi tenancy with Strapi in the following way: Create a new Strapi application for each project just like we did in this tutorial. Let all projects use the same database cluster, but a different database name and user. You can now create hundreds of Strapi APIs using the same fixed cost database. The other costs are S3 file storage, Lambda invocations, and some bandwidth which is billed on a pure pay-per-use basis.",{"type":18,"tag":27,"props":1897,"children":1898},{},[1899,1901,1907],{"type":24,"value":1900},"See the Git repo for this tutorial at ",{"type":18,"tag":38,"props":1902,"children":1905},{"href":1903,"rel":1904},"https://github.com/viktorfa/strapi-serverless",[42],[1906],{"type":24,"value":1903},{"type":24,"value":207},{"type":18,"tag":1909,"props":1910,"children":1911},"style",{},[1912],{"type":24,"value":1913},"html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}",{"title":10,"searchDepth":378,"depth":378,"links":1915},[1916,1919,1920,1923,1927],{"id":21,"depth":378,"text":25,"children":1917},[1918],{"id":75,"depth":675,"text":78},{"id":126,"depth":378,"text":129},{"id":311,"depth":378,"text":314,"children":1921},[1922],{"id":594,"depth":675,"text":597},{"id":1339,"depth":378,"text":1342,"children":1924},[1925,1926],{"id":1399,"depth":675,"text":1402},{"id":1600,"depth":675,"text":1603},{"id":1866,"depth":378,"text":1869,"children":1928},[1929],{"id":1877,"depth":675,"text":1880},"markdown","content:posts:serverless-strapi-tutorial:index.md","content","posts/serverless-strapi-tutorial/index.md","md",{"loc":7,"images":1936},[],["ShallowRef",1938],["ShallowReactive",1939],{"/posts/serverless-strapi-tutorial":1940},[1941,1950],{"_path":1942,"_dir":8,"_draft":9,"_partial":9,"_locale":10,"title":1943,"description":1944,"date":1945,"language":13,"draft":9,"_type":1930,"_id":1946,"_source":1932,"_file":1947,"_extension":1934,"sitemap":1948},"/posts/serverless-strapi-4-guide","AWS Lambda Serverless Strapi 4 Guide","The code for this guide is in this Github repo.","2022-06-14T01:25:06.000Z","content:posts:serverless-strapi-4-guide:index.md","posts/serverless-strapi-4-guide/index.md",{"loc":1942,"images":1949},[],{"_path":1951,"_dir":8,"_draft":9,"_partial":9,"_locale":10,"title":1952,"description":1953,"date":1954,"language":1955,"draft":9,"_type":1930,"_id":1956,"_source":1932,"_file":1957,"_extension":1934,"sitemap":1958},"/posts/smarte-hjem","Begynne i det sm med smarte hjem","Det har vrt snakk om smarte hjem en stund n. Nr alle hus har WiFi, og komponenter er s billige at til og med sm enheter kan ha bde Blutooth og WiFi, s skal det teoretisk sett vre mulig  styre alt elektronisk i hjemmet slik at hjemmet blir smart som bare det. Det teoretiske har faktisk vrt p plass i tir allerede  omtrent fra da WiFi kom. Men utfordringen er  ha et robust grensesnitt for dingser/enheter  snakke sammen. Egentlig snakker sjelden dingser sammen, men de m ha mulighet til  snakke sammen.","2019-08-03T05:52:06.000Z","norwegian","content:posts:smarte-hjem.md","posts/smarte-hjem.md",{"loc":1951,"images":1959},[],["ShallowRef",1961],{},{"preference":1963,"value":1963,"unknown":1221,"forced":9},"system",[1965,1967,1971],{"title":1966,"_path":1861,"layout":244},"Home",{"title":1968,"_path":1969,"layout":1970},"Contact","/contact","default",{"title":1972,"_path":1973,"children":1974,"layout":244},"Archive","/posts",[1975,1979,1982,1985,1990,1995,2000,2003,2009,2012,2015,2020,2025,2030,2035,2036,2039,2044,2049,2054,2059,2062,2065,2066,2071,2074,2079,2082,2085,2090],{"title":1976,"_path":1977,"layout":1978},"EU, e-bikes and premature regulation","/posts/2018-07-25-eu-e-bikes-and-premature-regulation","post",{"title":1980,"_path":1981},"AI to the masses with Google APIs","/posts/ai-to-the-masses-with-google-apis",{"title":1983,"_path":1984},"How to build a small and manageable website cheaply and with flexibility","/posts/build-small-website",{"title":1986,"_path":1987,"children":1988,"layout":1978},"Start a Conversation With Yourself on Messenger","/posts/conversation-with-yourself-on-messenger",[1989],{"title":1986,"_path":1987,"layout":1978},{"title":1991,"_path":1992,"children":1993},"E-handel i Norden fr Amazon","/posts/e-handel-i-norden-for-amazon",[1994],{"title":1991,"_path":1992},{"title":1996,"_path":1997,"children":1998},"GDPR og dine kvitteringer","/posts/gdpr-kvitteringer",[1999],{"title":1996,"_path":1997},{"title":2001,"_path":2002},"Getting Started With CD","/posts/getting-started-with-cd",{"title":2004,"_path":2005,"children":2006,"layout":2008},"Google Product Search vs Vertex AI multimodal embeddings","/posts/google-ai-product-search-vs-vertex-multimodal-embedding",[2007],{"title":2004,"_path":2005,"layout":2008},"article",{"title":2010,"_path":2011},"Google as your language coach","/posts/google-as-your-language-coach",{"title":2013,"_path":2014},"Holding Grin","/posts/holding-grin",{"title":2016,"_path":2017,"children":2018},"How to use your own email in Google Workspace without paying for a license","/posts/how-to-use-your-own-email-in-google-workspace-without-paying-for-a-license",[2019],{"title":2016,"_path":2017},{"title":2021,"_path":2022,"children":2023},"Complete guide to withdrawing Grin from Bitforex with HTTPS","/posts/how-to-withdraw-grin-from-bitforex",[2024],{"title":2021,"_path":2022},{"title":2026,"_path":2027,"children":2028,"layout":1978},"How to fix \"syntax error, unexpected '|'\" error in Symfony Polyfill in Wordpress plugins","/posts/how-to-fix-php-error-in-wordpress-plugin",[2029],{"title":2026,"_path":2027,"layout":1978},{"title":2031,"_path":2032,"children":2033,"layout":2008},"Hvordan finne p navn til din nye ting","/posts/hvordan-finne-navn",[2034],{"title":2031,"_path":2032,"layout":2008},{"title":1972,"_path":1973,"layout":244},{"title":2037,"_path":2038},"Kan jeg bestille varer til under 350 kroner?","/posts/kan-jeg-bestille-varer-til-under-350-kroner",{"title":2040,"_path":2041,"children":2042},"Norges Amazon er satt p vent, men kan Kolonial gripe muligheten?","/posts/kolonial-norges-amazon",[2043],{"title":2040,"_path":2041},{"title":2045,"_path":2046,"children":2047},"Make Medium readable and less frustrating","/posts/make-medium-readable-and-not-annoying",[2048],{"title":2045,"_path":2046},{"title":2050,"_path":2051,"children":2052},"Kvantitativ lettelse og aksjepriser","/posts/qe-og-aksjepriser",[2053],{"title":2050,"_path":2051},{"title":2055,"_path":2056,"children":2057},"Serverless Scraping with Scrapy, AWS Lambda and Fargate  a guide","/posts/scrapy-fargate-sls-guide",[2058],{"title":2055,"_path":2056},{"title":1943,"_path":1942,"children":2060},[2061],{"title":1943,"_path":1942},{"title":11,"_path":7,"children":2063},[2064],{"title":11,"_path":7},{"title":1952,"_path":1951},{"title":2067,"_path":2068,"children":2069,"layout":1978},"Social media preview by url get","/posts/social-media-preview-by-url-get",[2070],{"title":2067,"_path":2068,"layout":1978},{"title":2072,"_path":2073},"Spotify Social Jukeboxes","/posts/spotify-social-jukeboxes",{"title":2075,"_path":2076,"children":2077},"Stock buybacks og aksjepriser","/posts/stock-buybacks-og-aksjepriser",[2078],{"title":2075,"_path":2076},{"title":2080,"_path":2081},"Supermarket Price Lookup","/posts/supermarket-price-lookup",{"title":2083,"_path":2084},"Using Your Own Data for Value","/posts/using-your-own-data-for-value",{"title":2086,"_path":2087,"children":2088},"Verden og responsen til koronaviruset","/posts/verden-og-responsen-til-koronaviruset",[2089],{"title":2086,"_path":2087},{"title":2091,"_path":2092},"Why isn't Bitcoin banned?","/posts/why-isn-t-bitcoin-banned",{"uil:twitter":2094,"uil:instagram":2098,"uil:linkedin":2100,"ph:copy":2102},{"left":2095,"top":2095,"width":2096,"height":2096,"rotate":2095,"vFlip":9,"hFlip":9,"body":2097},0,24,"\u003Cpath fill=\"currentColor\" d=\"M22 5.8a8.49 8.49 0 0 1-2.36.64a4.13 4.13 0 0 0 1.81-2.27a8.21 8.21 0 0 1-2.61 1a4.1 4.1 0 0 0-7 3.74a11.64 11.64 0 0 1-8.45-4.29a4.16 4.16 0 0 0-.55 2.07a4.09 4.09 0 0 0 1.82 3.41a4.05 4.05 0 0 1-1.86-.51v.05a4.1 4.1 0 0 0 3.3 4a3.93 3.93 0 0 1-1.1.17a4.9 4.9 0 0 1-.77-.07a4.11 4.11 0 0 0 3.83 2.84A8.22 8.22 0 0 1 3 18.34a7.93 7.93 0 0 1-1-.06a11.57 11.57 0 0 0 6.29 1.85A11.59 11.59 0 0 0 20 8.45v-.53a8.43 8.43 0 0 0 2-2.12Z\"/>",{"left":2095,"top":2095,"width":2096,"height":2096,"rotate":2095,"vFlip":9,"hFlip":9,"body":2099},"\u003Cpath fill=\"currentColor\" d=\"M17.34 5.46a1.2 1.2 0 1 0 1.2 1.2a1.2 1.2 0 0 0-1.2-1.2Zm4.6 2.42a7.59 7.59 0 0 0-.46-2.43a4.94 4.94 0 0 0-1.16-1.77a4.7 4.7 0 0 0-1.77-1.15a7.3 7.3 0 0 0-2.43-.47C15.06 2 14.72 2 12 2s-3.06 0-4.12.06a7.3 7.3 0 0 0-2.43.47a4.78 4.78 0 0 0-1.77 1.15a4.7 4.7 0 0 0-1.15 1.77a7.3 7.3 0 0 0-.47 2.43C2 8.94 2 9.28 2 12s0 3.06.06 4.12a7.3 7.3 0 0 0 .47 2.43a4.7 4.7 0 0 0 1.15 1.77a4.78 4.78 0 0 0 1.77 1.15a7.3 7.3 0 0 0 2.43.47C8.94 22 9.28 22 12 22s3.06 0 4.12-.06a7.3 7.3 0 0 0 2.43-.47a4.7 4.7 0 0 0 1.77-1.15a4.85 4.85 0 0 0 1.16-1.77a7.59 7.59 0 0 0 .46-2.43c0-1.06.06-1.4.06-4.12s0-3.06-.06-4.12ZM20.14 16a5.61 5.61 0 0 1-.34 1.86a3.06 3.06 0 0 1-.75 1.15a3.19 3.19 0 0 1-1.15.75a5.61 5.61 0 0 1-1.86.34c-1 .05-1.37.06-4 .06s-3 0-4-.06a5.73 5.73 0 0 1-1.94-.3a3.27 3.27 0 0 1-1.1-.75a3 3 0 0 1-.74-1.15a5.54 5.54 0 0 1-.4-1.9c0-1-.06-1.37-.06-4s0-3 .06-4a5.54 5.54 0 0 1 .35-1.9A3 3 0 0 1 5 5a3.14 3.14 0 0 1 1.1-.8A5.73 5.73 0 0 1 8 3.86c1 0 1.37-.06 4-.06s3 0 4 .06a5.61 5.61 0 0 1 1.86.34a3.06 3.06 0 0 1 1.19.8a3.06 3.06 0 0 1 .75 1.1a5.61 5.61 0 0 1 .34 1.9c.05 1 .06 1.37.06 4s-.01 3-.06 4ZM12 6.87A5.13 5.13 0 1 0 17.14 12A5.12 5.12 0 0 0 12 6.87Zm0 8.46A3.33 3.33 0 1 1 15.33 12A3.33 3.33 0 0 1 12 15.33Z\"/>",{"left":2095,"top":2095,"width":2096,"height":2096,"rotate":2095,"vFlip":9,"hFlip":9,"body":2101},"\u003Cpath fill=\"currentColor\" d=\"M20.47 2H3.53a1.45 1.45 0 0 0-1.47 1.43v17.14A1.45 1.45 0 0 0 3.53 22h16.94a1.45 1.45 0 0 0 1.47-1.43V3.43A1.45 1.45 0 0 0 20.47 2ZM8.09 18.74h-3v-9h3ZM6.59 8.48a1.56 1.56 0 1 1 0-3.12a1.57 1.57 0 1 1 0 3.12Zm12.32 10.26h-3v-4.83c0-1.21-.43-2-1.52-2A1.65 1.65 0 0 0 12.85 13a2 2 0 0 0-.1.73v5h-3v-9h3V11a3 3 0 0 1 2.71-1.5c2 0 3.45 1.29 3.45 4.06Z\"/>",{"left":2095,"top":2095,"width":2103,"height":2103,"rotate":2095,"vFlip":9,"hFlip":9,"body":2104},256,"\u003Cpath fill=\"currentColor\" d=\"M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8Zm-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z\"/>",{"defaultLocale":2106,"env":2107,"indexable":1221,"name":2108,"trailingSlash":9,"url":2109},"en","production","alpine-starter","https://blog.vikfand.com",["Reactive",2111],{},"/posts/serverless-strapi-tutorial/",1699925190715]</script>
<script>window.__NUXT__={};window.__NUXT__.config={public:{FORMSPREE_URL:"",plausible:{hashMode:false,trackLocalhost:false,domain:"",apiHost:"https://plausible.io",autoPageviews:true,autoOutboundTracking:false},studio:{apiURL:"https://api.nuxt.studio"},mdc:{components:{prose:true,map:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote","code-inline":"prose-code-inline",code:"ProseCodeInline",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"}},headings:{anchorLinks:{h1:false,h2:true,h3:true,h4:true,h5:false,h6:false}}},content:{locales:[],defaultLocale:"",integrity:1699925158783,experimental:{stripQueryParameters:false,advanceQuery:false,clientDB:false},respectPathCase:false,api:{baseURL:"/api/_content"},navigation:{fields:["navTitle","layout"]},tags:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote","code-inline":"prose-code-inline",code:"ProseCodeInline",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"},highlight:{theme:{default:"github-light",dark:"github-dark"},preload:["json","js","ts","html","css","vue","diff","shell","markdown","yaml","bash","ini","c","cpp"]},wsUrl:"",documentDriven:{page:true,navigation:true,surround:true,globals:{},layoutFallbacks:["theme"],injectPage:true},host:"",trailingSlash:false,search:"",contentHead:true,anchorLinks:{depth:4,exclude:[1]}}},app:{baseURL:"/",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script></body>
</html>